<html>
<head>
<title>Trial 61.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #7a7e85;}
.s1 { color: #bcbec4;}
.s2 { color: #cf8e6d;}
.s3 { color: #bcbec4;}
.s4 { color: #2aacb8;}
.s5 { color: #6aab73;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
Trial 61.py</font>
</center></td></tr></table>
<pre><span class="s0"># Import libraries</span>
<span class="s2">from </span><span class="s1">flask </span><span class="s2">import </span><span class="s3">(</span><span class="s1">request</span><span class="s3">, </span><span class="s1">redirect</span><span class="s3">, </span><span class="s1">flash</span><span class="s3">, </span><span class="s1">session</span><span class="s3">, </span><span class="s1">jsonify</span><span class="s3">, </span><span class="s1">get_flashed_messages</span><span class="s3">, </span><span class="s1">Response</span><span class="s3">, </span><span class="s1">Flask</span><span class="s3">, </span><span class="s1">render_template</span><span class="s3">,</span>
                   <span class="s1">url_for</span><span class="s3">)</span>
<span class="s2">import </span><span class="s1">io</span>
<span class="s2">from </span><span class="s1">random </span><span class="s2">import </span><span class="s1">choices</span>
<span class="s2">from </span><span class="s1">string </span><span class="s2">import </span><span class="s1">ascii_letters</span><span class="s3">, </span><span class="s1">digits</span>
<span class="s2">from </span><span class="s1">flask_pymongo </span><span class="s2">import </span><span class="s1">PyMongo</span>
<span class="s2">from </span><span class="s1">flask_mail </span><span class="s2">import </span><span class="s1">Mail</span><span class="s3">, </span><span class="s1">Message</span>
<span class="s2">import </span><span class="s1">string</span>
<span class="s2">import </span><span class="s1">bcrypt</span>
<span class="s2">from </span><span class="s1">werkzeug</span><span class="s3">.</span><span class="s1">security </span><span class="s2">import </span><span class="s1">check_password_hash</span>
<span class="s2">from </span><span class="s1">bson </span><span class="s2">import </span><span class="s1">ObjectId</span><span class="s3">, </span><span class="s1">json_util</span>
<span class="s2">import </span><span class="s1">json</span>
<span class="s2">from </span><span class="s1">email</span><span class="s3">.</span><span class="s1">mime</span><span class="s3">.</span><span class="s1">multipart </span><span class="s2">import </span><span class="s1">MIMEMultipart</span>
<span class="s2">from </span><span class="s1">email</span><span class="s3">.</span><span class="s1">mime</span><span class="s3">.</span><span class="s1">text </span><span class="s2">import </span><span class="s1">MIMEText</span>
<span class="s2">import </span><span class="s1">csv</span>
<span class="s2">from </span><span class="s1">datetime </span><span class="s2">import </span><span class="s1">datetime</span>
<span class="s2">import </span><span class="s1">smtplib</span>
<span class="s2">import </span><span class="s1">os</span>
<span class="s2">import </span><span class="s1">secrets</span>
<span class="s2">from </span><span class="s1">werkzeug</span><span class="s3">.</span><span class="s1">security </span><span class="s2">import </span><span class="s1">generate_password_hash</span>
<span class="s2">from </span><span class="s1">flask </span><span class="s2">import </span><span class="s1">Flask</span><span class="s3">, </span><span class="s1">render_template</span><span class="s3">, </span><span class="s1">url_for</span>
<span class="s2">from </span><span class="s1">pymongo </span><span class="s2">import </span><span class="s1">MongoClient</span>
<span class="s2">import </span><span class="s1">pandas </span><span class="s2">as </span><span class="s1">pd</span>
<span class="s2">from </span><span class="s1">sklearn</span><span class="s3">.</span><span class="s1">ensemble </span><span class="s2">import </span><span class="s1">IsolationForest</span>
<span class="s2">from </span><span class="s1">sklearn</span><span class="s3">.</span><span class="s1">preprocessing </span><span class="s2">import </span><span class="s1">StandardScaler</span><span class="s3">, </span><span class="s1">OneHotEncoder</span>
<span class="s2">from </span><span class="s1">sklearn</span><span class="s3">.</span><span class="s1">compose </span><span class="s2">import </span><span class="s1">ColumnTransformer</span>
<span class="s2">import </span><span class="s1">numpy </span><span class="s2">as </span><span class="s1">np</span>
<span class="s2">import </span><span class="s1">datetime</span>

<span class="s0"># Initialize Flask application and set a secret key for session management</span>
<span class="s1">app </span><span class="s3">= </span><span class="s1">Flask</span><span class="s3">(</span><span class="s1">__name__</span><span class="s3">)</span>
<span class="s1">app</span><span class="s3">.</span><span class="s1">secret_key </span><span class="s3">= </span><span class="s1">os</span><span class="s3">.</span><span class="s1">urandom</span><span class="s3">(</span><span class="s4">24</span><span class="s3">)</span>


<span class="s0"># Define the route for the home page</span>
<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/'</span><span class="s3">)</span>
<span class="s2">def </span><span class="s1">home</span><span class="s3">():</span>
    <span class="s0"># Generate the URLs for the images and social media</span>
    <span class="s1">logo_url </span><span class="s3">= </span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'static'</span><span class="s3">, </span><span class="s1">filename</span><span class="s3">=</span><span class="s5">'ScanmyLog.png'</span><span class="s3">)</span>
    <span class="s1">dashboard_url </span><span class="s3">= </span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'static'</span><span class="s3">, </span><span class="s1">filename</span><span class="s3">=</span><span class="s5">'ScanmyLog Dashboard.png'</span><span class="s3">)</span>
    <span class="s1">filter_url </span><span class="s3">= </span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'static'</span><span class="s3">, </span><span class="s1">filename</span><span class="s3">=</span><span class="s5">'ScanmyLog filter.png'</span><span class="s3">)</span>
    <span class="s1">alert_url </span><span class="s3">= </span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'static'</span><span class="s3">, </span><span class="s1">filename</span><span class="s3">=</span><span class="s5">'ScanmyLog alert.png'</span><span class="s3">)</span>
    <span class="s1">case_url </span><span class="s3">= </span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'static'</span><span class="s3">, </span><span class="s1">filename</span><span class="s3">=</span><span class="s5">'ScanmyLog case.png'</span><span class="s3">)</span>
    <span class="s1">analysis_url </span><span class="s3">= </span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'static'</span><span class="s3">, </span><span class="s1">filename</span><span class="s3">=</span><span class="s5">'ScanmyLog analysis.png'</span><span class="s3">)</span>
    <span class="s1">table_url </span><span class="s3">= </span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'static'</span><span class="s3">, </span><span class="s1">filename</span><span class="s3">=</span><span class="s5">'ScanmyLog table.png'</span><span class="s3">)</span>
    <span class="s1">help_url </span><span class="s3">= </span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'static'</span><span class="s3">, </span><span class="s1">filename</span><span class="s3">=</span><span class="s5">'ScanmyLog help.png'</span><span class="s3">)</span>

    <span class="s1">facebook_url </span><span class="s3">= </span><span class="s5">&quot;https://www.facebook.com/profile.php?id=61555995077559&quot;</span>
    <span class="s1">twitter_url </span><span class="s3">= </span><span class="s5">&quot;https://twitter.com/ScanmyLog&quot;</span>
    <span class="s1">youtube_url </span><span class="s3">= </span><span class="s5">&quot;https://www.youtube.com/@ScanmyLog&quot;</span>
    <span class="s1">linkedin_url </span><span class="s3">= </span><span class="s5">&quot;https://www.linkedin.com/in/scanmy-log-3067a32b4/&quot;</span>
    <span class="s1">instagram_url </span><span class="s3">= </span><span class="s5">&quot;https://www.instagram.com/explore/tags/scanmylogo/&quot;</span>

    <span class="s2">return </span><span class="s1">render_template</span><span class="s3">(</span><span class="s5">&quot;Home.html&quot;</span><span class="s3">, </span><span class="s1">logo_url</span><span class="s3">=</span><span class="s1">logo_url</span><span class="s3">, </span><span class="s1">dashboard_url</span><span class="s3">=</span><span class="s1">dashboard_url</span><span class="s3">,</span>
                           <span class="s1">filter_url</span><span class="s3">=</span><span class="s1">filter_url</span><span class="s3">, </span><span class="s1">alert_url</span><span class="s3">=</span><span class="s1">alert_url</span><span class="s3">, </span><span class="s1">case_url</span><span class="s3">=</span><span class="s1">case_url</span><span class="s3">, </span><span class="s1">analysis_url</span><span class="s3">=</span><span class="s1">analysis_url</span><span class="s3">,</span>
                           <span class="s1">table_url</span><span class="s3">=</span><span class="s1">table_url</span><span class="s3">, </span><span class="s1">help_url</span><span class="s3">=</span><span class="s1">help_url</span><span class="s3">,</span>
                           <span class="s1">facebook_url</span><span class="s3">=</span><span class="s1">facebook_url</span><span class="s3">, </span><span class="s1">twitter_url</span><span class="s3">=</span><span class="s1">twitter_url</span><span class="s3">, </span><span class="s1">youtube_url</span><span class="s3">=</span><span class="s1">youtube_url</span><span class="s3">,</span>
                           <span class="s1">linkedin_url</span><span class="s3">=</span><span class="s1">linkedin_url</span><span class="s3">, </span><span class="s1">instagram_url</span><span class="s3">=</span><span class="s1">instagram_url</span><span class="s3">)</span>


<span class="s0"># Define the route for the feature page</span>
<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/feature'</span><span class="s3">)</span>
<span class="s2">def </span><span class="s1">feature</span><span class="s3">():</span>
    <span class="s0"># Generate the URLs for the images and social media</span>
    <span class="s1">logo_url </span><span class="s3">= </span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'static'</span><span class="s3">, </span><span class="s1">filename</span><span class="s3">=</span><span class="s5">'ScanmyLog.png'</span><span class="s3">)</span>

    <span class="s1">facebook_url </span><span class="s3">= </span><span class="s5">&quot;https://www.facebook.com/profile.php?id=61555995077559&quot;</span>
    <span class="s1">twitter_url </span><span class="s3">= </span><span class="s5">&quot;https://twitter.com/ScanmyLog&quot;</span>
    <span class="s1">youtube_url </span><span class="s3">= </span><span class="s5">&quot;https://www.youtube.com/@ScanmyLog&quot;</span>
    <span class="s1">linkedin_url </span><span class="s3">= </span><span class="s5">&quot;https://www.linkedin.com/in/scanmy-log-3067a32b4/&quot;</span>
    <span class="s1">instagram_url </span><span class="s3">= </span><span class="s5">&quot;https://www.instagram.com/explore/tags/scanmylogo/&quot;</span>

    <span class="s2">return </span><span class="s1">render_template</span><span class="s3">(</span><span class="s5">&quot;Feature.html&quot;</span><span class="s3">, </span><span class="s1">logo_url</span><span class="s3">=</span><span class="s1">logo_url</span><span class="s3">,</span>
                           <span class="s1">facebook_url</span><span class="s3">=</span><span class="s1">facebook_url</span><span class="s3">, </span><span class="s1">twitter_url</span><span class="s3">=</span><span class="s1">twitter_url</span><span class="s3">, </span><span class="s1">youtube_url</span><span class="s3">=</span><span class="s1">youtube_url</span><span class="s3">,</span>
                           <span class="s1">linkedin_url</span><span class="s3">=</span><span class="s1">linkedin_url</span><span class="s3">, </span><span class="s1">instagram_url</span><span class="s3">=</span><span class="s1">instagram_url</span><span class="s3">)</span>


<span class="s0"># Define the route for the terms and conditions page</span>
<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/terms_conditions'</span><span class="s3">)</span>
<span class="s2">def </span><span class="s1">terms_conditions</span><span class="s3">():</span>
    <span class="s0"># Generate the URLs for the images and social media</span>
    <span class="s1">logo_url </span><span class="s3">= </span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'static'</span><span class="s3">, </span><span class="s1">filename</span><span class="s3">=</span><span class="s5">'ScanmyLog.png'</span><span class="s3">)</span>
    <span class="s1">facebook_url </span><span class="s3">= </span><span class="s5">&quot;https://www.facebook.com/profile.php?id=61555995077559&quot;</span>
    <span class="s1">twitter_url </span><span class="s3">= </span><span class="s5">&quot;https://twitter.com/ScanmyLog&quot;</span>
    <span class="s1">youtube_url </span><span class="s3">= </span><span class="s5">&quot;https://www.youtube.com/@ScanmyLog&quot;</span>
    <span class="s1">linkedin_url </span><span class="s3">= </span><span class="s5">&quot;https://www.linkedin.com/in/scanmy-log-3067a32b4/&quot;</span>
    <span class="s1">instagram_url </span><span class="s3">= </span><span class="s5">&quot;https://www.instagram.com/explore/tags/scanmylogo/&quot;</span>

    <span class="s2">return </span><span class="s1">render_template</span><span class="s3">(</span><span class="s5">&quot;Terms.html&quot;</span><span class="s3">, </span><span class="s1">logo_url</span><span class="s3">=</span><span class="s1">logo_url</span><span class="s3">,</span>
                           <span class="s1">facebook_url</span><span class="s3">=</span><span class="s1">facebook_url</span><span class="s3">, </span><span class="s1">twitter_url</span><span class="s3">=</span><span class="s1">twitter_url</span><span class="s3">, </span><span class="s1">youtube_url</span><span class="s3">=</span><span class="s1">youtube_url</span><span class="s3">,</span>
                           <span class="s1">linkedin_url</span><span class="s3">=</span><span class="s1">linkedin_url</span><span class="s3">, </span><span class="s1">instagram_url</span><span class="s3">=</span><span class="s1">instagram_url</span><span class="s3">)</span>


<span class="s0"># Define a route for help</span>
<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/help'</span><span class="s3">)</span>
<span class="s2">def </span><span class="s1">help</span><span class="s3">():</span>
    <span class="s0"># Generate the URLs for the images and social media</span>
    <span class="s1">logo_url </span><span class="s3">= </span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'static'</span><span class="s3">, </span><span class="s1">filename</span><span class="s3">=</span><span class="s5">'ScanmyLog.png'</span><span class="s3">)</span>

    <span class="s1">facebook_url </span><span class="s3">= </span><span class="s5">&quot;https://www.facebook.com/profile.php?id=61555995077559&quot;</span>
    <span class="s1">twitter_url </span><span class="s3">= </span><span class="s5">&quot;https://twitter.com/ScanmyLog&quot;</span>
    <span class="s1">youtube_url </span><span class="s3">= </span><span class="s5">&quot;https://www.youtube.com/@ScanmyLog&quot;</span>
    <span class="s1">linkedin_url </span><span class="s3">= </span><span class="s5">&quot;https://www.linkedin.com/in/scanmy-log-3067a32b4/&quot;</span>
    <span class="s1">instagram_url </span><span class="s3">= </span><span class="s5">&quot;https://www.instagram.com/explore/tags/scanmylogo/&quot;</span>

    <span class="s2">return </span><span class="s1">render_template</span><span class="s3">(</span><span class="s5">&quot;Help.html&quot;</span><span class="s3">, </span><span class="s1">logo_url</span><span class="s3">=</span><span class="s1">logo_url</span><span class="s3">,</span>
                           <span class="s1">facebook_url</span><span class="s3">=</span><span class="s1">facebook_url</span><span class="s3">, </span><span class="s1">twitter_url</span><span class="s3">=</span><span class="s1">twitter_url</span><span class="s3">, </span><span class="s1">youtube_url</span><span class="s3">=</span><span class="s1">youtube_url</span><span class="s3">,</span>
                           <span class="s1">linkedin_url</span><span class="s3">=</span><span class="s1">linkedin_url</span><span class="s3">, </span><span class="s1">instagram_url</span><span class="s3">=</span><span class="s1">instagram_url</span><span class="s3">)</span>


<span class="s0"># Define a route for the privacy policy</span>
<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/privacy_policy'</span><span class="s3">)</span>
<span class="s2">def </span><span class="s1">privacy_policy</span><span class="s3">():</span>
    <span class="s0"># Generate the URLs for the images and social media</span>
    <span class="s1">logo_url </span><span class="s3">= </span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'static'</span><span class="s3">, </span><span class="s1">filename</span><span class="s3">=</span><span class="s5">'ScanmyLog.png'</span><span class="s3">)</span>

    <span class="s1">facebook_url </span><span class="s3">= </span><span class="s5">&quot;https://www.facebook.com/profile.php?id=61555995077559&quot;</span>
    <span class="s1">twitter_url </span><span class="s3">= </span><span class="s5">&quot;https://twitter.com/ScanmyLog&quot;</span>
    <span class="s1">youtube_url </span><span class="s3">= </span><span class="s5">&quot;https://www.youtube.com/@ScanmyLog&quot;</span>
    <span class="s1">linkedin_url </span><span class="s3">= </span><span class="s5">&quot;https://www.linkedin.com/in/scanmy-log-3067a32b4/&quot;</span>
    <span class="s1">instagram_url </span><span class="s3">= </span><span class="s5">&quot;https://www.instagram.com/explore/tags/scanmylogo/&quot;</span>

    <span class="s2">return </span><span class="s1">render_template</span><span class="s3">(</span><span class="s5">&quot;Privacy.html&quot;</span><span class="s3">, </span><span class="s1">logo_url</span><span class="s3">=</span><span class="s1">logo_url</span><span class="s3">,</span>
                           <span class="s1">facebook_url</span><span class="s3">=</span><span class="s1">facebook_url</span><span class="s3">, </span><span class="s1">twitter_url</span><span class="s3">=</span><span class="s1">twitter_url</span><span class="s3">, </span><span class="s1">youtube_url</span><span class="s3">=</span><span class="s1">youtube_url</span><span class="s3">,</span>
                           <span class="s1">linkedin_url</span><span class="s3">=</span><span class="s1">linkedin_url</span><span class="s3">, </span><span class="s1">instagram_url</span><span class="s3">=</span><span class="s1">instagram_url</span><span class="s3">)</span>


<span class="s0"># Define a email</span>
<span class="s1">secret_key </span><span class="s3">= </span><span class="s1">secrets</span><span class="s3">.</span><span class="s1">token_hex</span><span class="s3">(</span><span class="s4">16</span><span class="s3">)</span>

<span class="s0"># Flask-email configuration</span>
<span class="s1">app</span><span class="s3">.</span><span class="s1">config</span><span class="s3">[</span><span class="s5">'mail_SERVER'</span><span class="s3">] = </span><span class="s5">'smtp.gmail.com'</span>
<span class="s1">app</span><span class="s3">.</span><span class="s1">config</span><span class="s3">[</span><span class="s5">'mail_PORT'</span><span class="s3">] = </span><span class="s4">587</span>
<span class="s1">app</span><span class="s3">.</span><span class="s1">config</span><span class="s3">[</span><span class="s5">'mail_USE_TLS'</span><span class="s3">] = </span><span class="s2">True</span>
<span class="s1">app</span><span class="s3">.</span><span class="s1">config</span><span class="s3">[</span><span class="s5">'mail_USE_SSL'</span><span class="s3">] = </span><span class="s2">False</span>
<span class="s1">app</span><span class="s3">.</span><span class="s1">config</span><span class="s3">[</span><span class="s5">'mail_USERNAME'</span><span class="s3">] = </span><span class="s5">'your_mail'</span>
<span class="s1">app</span><span class="s3">.</span><span class="s1">config</span><span class="s3">[</span><span class="s5">'mail_PASSWORD'</span><span class="s3">] = </span><span class="s5">'your_password'</span>
<span class="s1">app</span><span class="s3">.</span><span class="s1">config</span><span class="s3">[</span><span class="s5">'mail_DEFAULT_SENDER'</span><span class="s3">] = </span><span class="s5">'your_mail'</span>
<span class="s1">email </span><span class="s3">= </span><span class="s1">Mail</span><span class="s3">(</span><span class="s1">app</span><span class="s3">)</span>


<span class="s0"># Define a route for feedback</span>
<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/feedback'</span><span class="s3">, </span><span class="s1">methods</span><span class="s3">=[</span><span class="s5">'GET'</span><span class="s3">, </span><span class="s5">'POST'</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">feedback</span><span class="s3">():</span>
    <span class="s0"># Generate the URLs for the images and social media</span>
    <span class="s1">logo_url </span><span class="s3">= </span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'static'</span><span class="s3">, </span><span class="s1">filename</span><span class="s3">=</span><span class="s5">'ScanmyLog.png'</span><span class="s3">)</span>
    <span class="s1">facebook_url </span><span class="s3">= </span><span class="s5">&quot;https://www.facebook.com/profile.php?id=61555995077559&quot;</span>
    <span class="s1">twitter_url </span><span class="s3">= </span><span class="s5">&quot;https://twitter.com/ScanmyLog&quot;</span>
    <span class="s1">youtube_url </span><span class="s3">= </span><span class="s5">&quot;https://www.youtube.com/@ScanmyLog&quot;</span>
    <span class="s1">linkedin_url </span><span class="s3">= </span><span class="s5">&quot;https://www.linkedin.com/in/scanmy-log-3067a32b4/&quot;</span>
    <span class="s1">instagram_url </span><span class="s3">= </span><span class="s5">&quot;https://www.instagram.com/explore/tags/scanmylogo/&quot;</span>

    <span class="s2">if </span><span class="s1">request</span><span class="s3">.</span><span class="s1">method </span><span class="s3">== </span><span class="s5">'POST'</span><span class="s3">:</span>
        <span class="s1">name </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">form</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'name'</span><span class="s3">)</span>
        <span class="s1">email </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">form</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'email'</span><span class="s3">)</span>
        <span class="s1">feedback </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">form</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'feedback'</span><span class="s3">)</span>

        <span class="s0"># Create a message</span>
        <span class="s1">msg </span><span class="s3">= </span><span class="s1">Message</span><span class="s3">(</span><span class="s5">&quot;Message from your Contact Form&quot;</span><span class="s3">,</span>
                        <span class="s1">recipients</span><span class="s3">=[</span><span class="s1">app</span><span class="s3">.</span><span class="s1">config</span><span class="s3">[</span><span class="s5">'email_DEFAULT_SENDER'</span><span class="s3">]])</span>
        <span class="s1">msg</span><span class="s3">.</span><span class="s1">body </span><span class="s3">= </span><span class="s5">f&quot;Name: </span><span class="s2">{</span><span class="s1">name</span><span class="s2">}\n</span><span class="s5">email: </span><span class="s2">{</span><span class="s1">email</span><span class="s2">}\n</span><span class="s5">Feedback: </span><span class="s2">{</span><span class="s1">feedback</span><span class="s2">}</span><span class="s5">&quot;</span>

        <span class="s1">email</span><span class="s3">.</span><span class="s1">send</span><span class="s3">(</span><span class="s1">msg</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">msg</span><span class="s3">:</span>

            <span class="s1">flash</span><span class="s3">(</span><span class="s5">'Your feedback is sent.'</span><span class="s3">, </span><span class="s5">'success'</span><span class="s3">)</span>
        <span class="s2">else</span><span class="s3">:</span>

            <span class="s1">flash</span><span class="s3">(</span><span class="s5">'Your feedback is not sent. Please try again.'</span><span class="s3">, </span><span class="s5">'error'</span><span class="s3">)</span>
        <span class="s2">return </span><span class="s1">redirect</span><span class="s3">(</span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'feedback'</span><span class="s3">))</span>

    <span class="s1">messages </span><span class="s3">= </span><span class="s1">get_flashed_messages</span><span class="s3">(</span><span class="s1">with_categories</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

    <span class="s2">return </span><span class="s1">render_template</span><span class="s3">(</span><span class="s5">&quot;Feedback.html&quot;</span><span class="s3">, </span><span class="s1">messages</span><span class="s3">=</span><span class="s1">messages</span><span class="s3">, </span><span class="s1">logo_url</span><span class="s3">=</span><span class="s1">logo_url</span><span class="s3">,</span>
                           <span class="s1">facebook_url</span><span class="s3">=</span><span class="s1">facebook_url</span><span class="s3">, </span><span class="s1">twitter_url</span><span class="s3">=</span><span class="s1">twitter_url</span><span class="s3">, </span><span class="s1">youtube_url</span><span class="s3">=</span><span class="s1">youtube_url</span><span class="s3">,</span>
                           <span class="s1">linkedin_url</span><span class="s3">=</span><span class="s1">linkedin_url</span><span class="s3">, </span><span class="s1">instagram_url</span><span class="s3">=</span><span class="s1">instagram_url</span><span class="s3">)</span>


<span class="s0"># Define user credentials database</span>
<span class="s1">client </span><span class="s3">= </span><span class="s1">MongoClient</span><span class="s3">(</span><span class="s5">'mongodb://localhost:27017/'</span><span class="s3">)</span>
<span class="s1">db </span><span class="s3">= </span><span class="s1">client</span><span class="s3">.</span><span class="s1">user_credentials</span>
<span class="s1">users_collection </span><span class="s3">= </span><span class="s1">db</span><span class="s3">.</span><span class="s1">users</span>


<span class="s0"># Define a route for login</span>
<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/login'</span><span class="s3">, </span><span class="s1">methods</span><span class="s3">=[</span><span class="s5">'GET'</span><span class="s3">, </span><span class="s5">'POST'</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">login</span><span class="s3">():</span>
    <span class="s0"># Social media and images URLs</span>
    <span class="s1">logo_url </span><span class="s3">= </span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'static'</span><span class="s3">, </span><span class="s1">filename</span><span class="s3">=</span><span class="s5">'ScanmyLog.png'</span><span class="s3">)</span>
    <span class="s1">facebook_url </span><span class="s3">= </span><span class="s5">&quot;https://www.facebook.com/profile.php?id=61555995077559&quot;</span>
    <span class="s1">twitter_url </span><span class="s3">= </span><span class="s5">&quot;https://twitter.com/ScanmyLog&quot;</span>
    <span class="s1">youtube_url </span><span class="s3">= </span><span class="s5">&quot;https://www.youtube.com/@ScanmyLog&quot;</span>
    <span class="s1">linkedin_url </span><span class="s3">= </span><span class="s5">&quot;https://www.linkedin.com/in/scanmy-log-3067a32b4/&quot;</span>
    <span class="s1">instagram_url </span><span class="s3">= </span><span class="s5">&quot;https://www.instagram.com/explore/tags/scanmylogo/&quot;</span>

    <span class="s2">if </span><span class="s1">request</span><span class="s3">.</span><span class="s1">method </span><span class="s3">== </span><span class="s5">'POST'</span><span class="s3">:</span>
        <span class="s1">username </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">form</span><span class="s3">[</span><span class="s5">'username'</span><span class="s3">]</span>
        <span class="s1">password </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">form</span><span class="s3">[</span><span class="s5">'password'</span><span class="s3">]</span>

        <span class="s1">user </span><span class="s3">= </span><span class="s1">users_collection</span><span class="s3">.</span><span class="s1">find_one</span><span class="s3">({</span><span class="s5">'username'</span><span class="s3">: </span><span class="s1">username</span><span class="s3">})</span>

        <span class="s2">if </span><span class="s1">user </span><span class="s2">and </span><span class="s1">check_password_hash</span><span class="s3">(</span><span class="s1">user</span><span class="s3">[</span><span class="s5">'password'</span><span class="s3">], </span><span class="s1">password</span><span class="s3">):</span>
            <span class="s1">session</span><span class="s3">[</span><span class="s5">'username'</span><span class="s3">] = </span><span class="s1">username  </span><span class="s0"># Store username in session</span>
            <span class="s1">session</span><span class="s3">[</span><span class="s5">'user_id'</span><span class="s3">] = </span><span class="s1">str</span><span class="s3">(</span><span class="s1">user</span><span class="s3">[</span><span class="s5">'_id'</span><span class="s3">])  </span><span class="s0"># Store user ID in session</span>
            <span class="s2">return </span><span class="s1">redirect</span><span class="s3">(</span><span class="s5">'/dashboard'</span><span class="s3">)</span>
        <span class="s2">else</span><span class="s3">:</span>
            <span class="s1">flash</span><span class="s3">(</span><span class="s5">'Your username or password is incorrect. Please try again.'</span><span class="s3">, </span><span class="s5">'error'</span><span class="s3">)</span>

    <span class="s1">messages </span><span class="s3">= </span><span class="s1">get_flashed_messages</span><span class="s3">(</span><span class="s1">with_categories</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
    <span class="s2">return </span><span class="s1">render_template</span><span class="s3">(</span><span class="s5">&quot;Login.html&quot;</span><span class="s3">, </span><span class="s1">messages</span><span class="s3">=</span><span class="s1">messages</span><span class="s3">, </span><span class="s1">logo_url</span><span class="s3">=</span><span class="s1">logo_url</span><span class="s3">,</span>
                           <span class="s1">facebook_url</span><span class="s3">=</span><span class="s1">facebook_url</span><span class="s3">, </span><span class="s1">twitter_url</span><span class="s3">=</span><span class="s1">twitter_url</span><span class="s3">, </span><span class="s1">youtube_url</span><span class="s3">=</span><span class="s1">youtube_url</span><span class="s3">,</span>
                           <span class="s1">linkedin_url</span><span class="s3">=</span><span class="s1">linkedin_url</span><span class="s3">, </span><span class="s1">instagram_url</span><span class="s3">=</span><span class="s1">instagram_url</span><span class="s3">)</span>


<span class="s2">def </span><span class="s1">send_registration_email</span><span class="s3">(</span><span class="s1">name</span><span class="s3">, </span><span class="s1">email</span><span class="s3">, </span><span class="s1">username</span><span class="s3">, </span><span class="s1">password</span><span class="s3">):</span>
    <span class="s1">sender_email </span><span class="s3">= </span><span class="s5">&quot;norepleyscannerly@gmail.com&quot;</span>
    <span class="s1">sender_password </span><span class="s3">= </span><span class="s5">&quot;jtsi oyvo uapb huyu&quot;</span>

    <span class="s1">message </span><span class="s3">= </span><span class="s1">MIMEMultipart</span><span class="s3">()</span>
    <span class="s1">message</span><span class="s3">[</span><span class="s5">'From'</span><span class="s3">] = </span><span class="s1">sender_email</span>
    <span class="s1">message</span><span class="s3">[</span><span class="s5">'To'</span><span class="s3">] = </span><span class="s1">email</span>
    <span class="s1">message</span><span class="s3">[</span><span class="s5">'Subject'</span><span class="s3">] = </span><span class="s5">&quot;Your New Account Password&quot;</span>

    <span class="s1">email_body </span><span class="s3">= (</span><span class="s5">f&quot;Hi </span><span class="s2">{</span><span class="s1">name</span><span class="s2">}</span><span class="s5">,</span><span class="s2">\n\n</span><span class="s5">Your account has been created successfully.</span><span class="s2">\n</span><span class="s5">Username: </span><span class="s2">{</span><span class="s1">username</span><span class="s2">}\n</span><span class="s5">Password: &quot;</span>
                  <span class="s5">f&quot;</span><span class="s2">{</span><span class="s1">password</span><span class="s2">}\n\n</span><span class="s5">Please change your password after logging in.&quot;</span><span class="s3">)</span>
    <span class="s1">message</span><span class="s3">.</span><span class="s1">attach</span><span class="s3">(</span><span class="s1">MIMEText</span><span class="s3">(</span><span class="s1">email_body</span><span class="s3">, </span><span class="s5">'plain'</span><span class="s3">))</span>

    <span class="s1">server </span><span class="s3">= </span><span class="s1">smtplib</span><span class="s3">.</span><span class="s1">SMTP</span><span class="s3">(</span><span class="s5">'smtp.gmail.com'</span><span class="s3">, </span><span class="s4">587</span><span class="s3">)</span>
    <span class="s1">server</span><span class="s3">.</span><span class="s1">starttls</span><span class="s3">()</span>
    <span class="s1">server</span><span class="s3">.</span><span class="s1">login</span><span class="s3">(</span><span class="s1">sender_email</span><span class="s3">, </span><span class="s1">sender_password</span><span class="s3">)</span>
    <span class="s1">server</span><span class="s3">.</span><span class="s1">sendmail</span><span class="s3">(</span><span class="s1">sender_email</span><span class="s3">, </span><span class="s1">email</span><span class="s3">, </span><span class="s1">message</span><span class="s3">.</span><span class="s1">as_string</span><span class="s3">())</span>
    <span class="s1">server</span><span class="s3">.</span><span class="s1">quit</span><span class="s3">()</span>


<span class="s2">def </span><span class="s1">generate_random_password</span><span class="s3">(</span><span class="s1">length</span><span class="s3">=</span><span class="s4">10</span><span class="s3">):</span>
    <span class="s1">characters </span><span class="s3">= </span><span class="s1">ascii_letters </span><span class="s3">+ </span><span class="s1">digits</span>
    <span class="s2">return </span><span class="s5">''</span><span class="s3">.</span><span class="s1">join</span><span class="s3">(</span><span class="s1">choices</span><span class="s3">(</span><span class="s1">characters</span><span class="s3">, </span><span class="s1">k</span><span class="s3">=</span><span class="s1">length</span><span class="s3">))</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/register'</span><span class="s3">, </span><span class="s1">methods</span><span class="s3">=[</span><span class="s5">'GET'</span><span class="s3">, </span><span class="s5">'POST'</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">register</span><span class="s3">():</span>
    <span class="s0"># Social media and images URLs</span>
    <span class="s1">logo_url </span><span class="s3">= </span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'static'</span><span class="s3">, </span><span class="s1">filename</span><span class="s3">=</span><span class="s5">'ScanmyLog.png'</span><span class="s3">)</span>
    <span class="s1">facebook_url </span><span class="s3">= </span><span class="s5">&quot;https://www.facebook.com/profile.php?id=61555995077559&quot;</span>
    <span class="s1">twitter_url </span><span class="s3">= </span><span class="s5">&quot;https://twitter.com/ScanmyLog&quot;</span>
    <span class="s1">youtube_url </span><span class="s3">= </span><span class="s5">&quot;https://www.youtube.com/@ScanmyLog&quot;</span>
    <span class="s1">linkedin_url </span><span class="s3">= </span><span class="s5">&quot;https://www.linkedin.com/in/scanmy-log-3067a32b4/&quot;</span>
    <span class="s1">instagram_url </span><span class="s3">= </span><span class="s5">&quot;https://www.instagram.com/explore/tags/scanmylogo/&quot;</span>

    <span class="s2">if </span><span class="s1">request</span><span class="s3">.</span><span class="s1">method </span><span class="s3">== </span><span class="s5">'POST'</span><span class="s3">:</span>
        <span class="s1">name </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">form</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'name'</span><span class="s3">)</span>
        <span class="s1">email </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">form</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'email'</span><span class="s3">)</span>
        <span class="s1">username </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">form</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'username'</span><span class="s3">)</span>

        <span class="s1">existing_user </span><span class="s3">= </span><span class="s1">users_collection</span><span class="s3">.</span><span class="s1">find_one</span><span class="s3">({</span><span class="s5">'username'</span><span class="s3">: </span><span class="s1">username</span><span class="s3">})</span>
        <span class="s2">if </span><span class="s1">existing_user </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">flash</span><span class="s3">(</span><span class="s5">&quot;Username already exists.&quot;</span><span class="s3">, </span><span class="s5">&quot;error&quot;</span><span class="s3">)</span>
            <span class="s2">return </span><span class="s1">redirect</span><span class="s3">(</span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'register'</span><span class="s3">))</span>

        <span class="s1">password </span><span class="s3">= </span><span class="s1">generate_random_password</span><span class="s3">()</span>
        <span class="s1">hashed_password </span><span class="s3">= </span><span class="s1">generate_password_hash</span><span class="s3">(</span><span class="s1">password</span><span class="s3">, </span><span class="s1">method</span><span class="s3">=</span><span class="s5">'pbkdf2:sha256'</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">users_collection</span><span class="s3">.</span><span class="s1">insert_one</span><span class="s3">({</span>
            <span class="s5">&quot;name&quot;</span><span class="s3">: </span><span class="s1">name</span><span class="s3">,</span>
            <span class="s5">&quot;email&quot;</span><span class="s3">: </span><span class="s1">email</span><span class="s3">,</span>
            <span class="s5">&quot;username&quot;</span><span class="s3">: </span><span class="s1">username</span><span class="s3">,</span>
            <span class="s5">&quot;password&quot;</span><span class="s3">: </span><span class="s1">hashed_password</span>
        <span class="s3">})</span>

        <span class="s2">if </span><span class="s1">result</span><span class="s3">.</span><span class="s1">inserted_id</span><span class="s3">:</span>
            <span class="s2">try</span><span class="s3">:</span>
                <span class="s1">send_registration_email</span><span class="s3">(</span><span class="s1">name</span><span class="s3">, </span><span class="s1">email</span><span class="s3">, </span><span class="s1">username</span><span class="s3">, </span><span class="s1">password</span><span class="s3">)</span>
                <span class="s1">flash</span><span class="s3">(</span><span class="s5">&quot;Registration successful. Please check your email for the password.&quot;</span><span class="s3">, </span><span class="s5">&quot;success&quot;</span><span class="s3">)</span>
            <span class="s2">except </span><span class="s1">Exception </span><span class="s2">as </span><span class="s1">e</span><span class="s3">:</span>
                <span class="s1">flash</span><span class="s3">(</span><span class="s5">f&quot;Registration successful, but failed to send email. Error: </span><span class="s2">{</span><span class="s1">str</span><span class="s3">(</span><span class="s1">e</span><span class="s3">)</span><span class="s2">}</span><span class="s5">&quot;</span><span class="s3">, </span><span class="s5">&quot;warning&quot;</span><span class="s3">)</span>
        <span class="s2">else</span><span class="s3">:</span>
            <span class="s1">flash</span><span class="s3">(</span><span class="s5">&quot;An error occurred. Please try again.&quot;</span><span class="s3">, </span><span class="s5">&quot;error&quot;</span><span class="s3">)</span>
        <span class="s2">return </span><span class="s1">redirect</span><span class="s3">(</span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'login'</span><span class="s3">))</span>

    <span class="s1">messages </span><span class="s3">= </span><span class="s1">get_flashed_messages</span><span class="s3">(</span><span class="s1">with_categories</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

    <span class="s2">return </span><span class="s1">render_template</span><span class="s3">(</span><span class="s5">&quot;Register.html&quot;</span><span class="s3">, </span><span class="s1">messages</span><span class="s3">=</span><span class="s1">messages</span><span class="s3">, </span><span class="s1">logo_url</span><span class="s3">=</span><span class="s1">logo_url</span><span class="s3">,</span>
                            <span class="s1">facebook_url</span><span class="s3">=</span><span class="s1">facebook_url</span><span class="s3">, </span><span class="s1">twitter_url</span><span class="s3">=</span><span class="s1">twitter_url</span><span class="s3">, </span><span class="s1">youtube_url</span><span class="s3">=</span><span class="s1">youtube_url</span><span class="s3">,</span>
                            <span class="s1">linkedin_url</span><span class="s3">=</span><span class="s1">linkedin_url</span><span class="s3">, </span><span class="s1">instagram_url</span><span class="s3">=</span><span class="s1">instagram_url</span><span class="s3">)</span>


<span class="s1">app</span><span class="s3">.</span><span class="s1">config</span><span class="s3">[</span><span class="s5">&quot;MONGO_URI&quot;</span><span class="s3">] = </span><span class="s5">&quot;mongodb://localhost:27017/user_credentials&quot;</span>
<span class="s1">mongo </span><span class="s3">= </span><span class="s1">PyMongo</span><span class="s3">(</span><span class="s1">app</span><span class="s3">)</span>
<span class="s1">db </span><span class="s3">= </span><span class="s1">mongo</span><span class="s3">.</span><span class="s1">db</span>
<span class="s1">users_collection </span><span class="s3">= </span><span class="s1">db</span><span class="s3">.</span><span class="s1">users</span>

<span class="s0"># email Configuration</span>
<span class="s1">app</span><span class="s3">.</span><span class="s1">config</span><span class="s3">[</span><span class="s5">'mail_SERVER'</span><span class="s3">] = </span><span class="s5">'smtp.gmail.com'</span>
<span class="s1">app</span><span class="s3">.</span><span class="s1">config</span><span class="s3">[</span><span class="s5">'mail_PORT'</span><span class="s3">] = </span><span class="s4">587</span>
<span class="s1">app</span><span class="s3">.</span><span class="s1">config</span><span class="s3">[</span><span class="s5">'mail_USERNAME'</span><span class="s3">] = </span><span class="s5">'your_mail'</span>
<span class="s1">app</span><span class="s3">.</span><span class="s1">config</span><span class="s3">[</span><span class="s5">'mail_PASSWORD'</span><span class="s3">] = </span><span class="s5">'your_password'</span>
<span class="s1">app</span><span class="s3">.</span><span class="s1">config</span><span class="s3">[</span><span class="s5">'mail_USE_TLS'</span><span class="s3">] = </span><span class="s2">True</span>
<span class="s1">app</span><span class="s3">.</span><span class="s1">config</span><span class="s3">[</span><span class="s5">'mail_USE_SSL'</span><span class="s3">] = </span><span class="s2">False</span>


<span class="s2">def </span><span class="s1">generate_new_password</span><span class="s3">(</span><span class="s1">length</span><span class="s3">=</span><span class="s4">10</span><span class="s3">):</span>
    <span class="s1">alphabet </span><span class="s3">= </span><span class="s1">string</span><span class="s3">.</span><span class="s1">ascii_letters </span><span class="s3">+ </span><span class="s1">string</span><span class="s3">.</span><span class="s1">digits </span><span class="s3">+ </span><span class="s1">string</span><span class="s3">.</span><span class="s1">punctuation</span>
    <span class="s1">password </span><span class="s3">= </span><span class="s5">''</span><span class="s3">.</span><span class="s1">join</span><span class="s3">(</span><span class="s1">secrets</span><span class="s3">.</span><span class="s1">choice</span><span class="s3">(</span><span class="s1">alphabet</span><span class="s3">) </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range</span><span class="s3">(</span><span class="s1">length</span><span class="s3">))</span>
    <span class="s2">return </span><span class="s1">password</span>


<span class="s2">def </span><span class="s1">hash_password</span><span class="s3">(</span><span class="s1">password</span><span class="s3">):</span>
    <span class="s1">hashed </span><span class="s3">= </span><span class="s1">bcrypt</span><span class="s3">.</span><span class="s1">hashpw</span><span class="s3">(</span><span class="s1">password</span><span class="s3">.</span><span class="s1">encode</span><span class="s3">(</span><span class="s5">'utf-8'</span><span class="s3">), </span><span class="s1">bcrypt</span><span class="s3">.</span><span class="s1">gensalt</span><span class="s3">())</span>
    <span class="s2">return </span><span class="s1">hashed</span><span class="s3">.</span><span class="s1">decode</span><span class="s3">(</span><span class="s5">'utf-8'</span><span class="s3">)</span>


<span class="s2">def </span><span class="s1">send_email_with_new_password_smtplib</span><span class="s3">(</span><span class="s1">email</span><span class="s3">, </span><span class="s1">new_password</span><span class="s3">):</span>
    <span class="s1">sender_email </span><span class="s3">= </span><span class="s5">&quot;norepleyscannerly@gmail.com&quot;</span>
    <span class="s1">receiver_email </span><span class="s3">= </span><span class="s1">email</span>
    <span class="s1">password </span><span class="s3">= </span><span class="s5">&quot;hgks ojrw nwvg bvma&quot;</span>

    <span class="s1">message </span><span class="s3">= </span><span class="s1">MIMEMultipart</span><span class="s3">(</span><span class="s5">&quot;alternative&quot;</span><span class="s3">)</span>
    <span class="s1">message</span><span class="s3">[</span><span class="s5">&quot;Subject&quot;</span><span class="s3">] = </span><span class="s5">&quot;Password Reset&quot;</span>
    <span class="s1">message</span><span class="s3">[</span><span class="s5">&quot;From&quot;</span><span class="s3">] = </span><span class="s1">sender_email</span>
    <span class="s1">message</span><span class="s3">[</span><span class="s5">&quot;To&quot;</span><span class="s3">] = </span><span class="s1">receiver_email</span>

    <span class="s1">text </span><span class="s3">= </span><span class="s5">f&quot;Your new password is: </span><span class="s2">{</span><span class="s1">new_password</span><span class="s2">}</span><span class="s5">&quot;</span>
    <span class="s1">part1 </span><span class="s3">= </span><span class="s1">MIMEText</span><span class="s3">(</span><span class="s1">text</span><span class="s3">, </span><span class="s5">&quot;plain&quot;</span><span class="s3">)</span>
    <span class="s1">message</span><span class="s3">.</span><span class="s1">attach</span><span class="s3">(</span><span class="s1">part1</span><span class="s3">)</span>

    <span class="s1">server </span><span class="s3">= </span><span class="s1">smtplib</span><span class="s3">.</span><span class="s1">SMTP</span><span class="s3">(</span><span class="s5">'smtp.gmail.com'</span><span class="s3">, </span><span class="s4">587</span><span class="s3">)</span>
    <span class="s1">server</span><span class="s3">.</span><span class="s1">starttls</span><span class="s3">()</span>
    <span class="s1">server</span><span class="s3">.</span><span class="s1">login</span><span class="s3">(</span><span class="s1">sender_email</span><span class="s3">, </span><span class="s1">password</span><span class="s3">)</span>
    <span class="s1">server</span><span class="s3">.</span><span class="s1">sendmail</span><span class="s3">(</span><span class="s1">sender_email</span><span class="s3">, </span><span class="s1">receiver_email</span><span class="s3">, </span><span class="s1">message</span><span class="s3">.</span><span class="s1">as_string</span><span class="s3">())</span>
    <span class="s1">server</span><span class="s3">.</span><span class="s1">quit</span><span class="s3">()</span>


<span class="s0"># Define a route for registration</span>
<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/forget_password'</span><span class="s3">, </span><span class="s1">methods</span><span class="s3">=[</span><span class="s5">'GET'</span><span class="s3">, </span><span class="s5">'POST'</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">forget_password</span><span class="s3">():</span>
    <span class="s0"># Images and media URLs</span>
    <span class="s1">logo_url </span><span class="s3">= </span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'static'</span><span class="s3">, </span><span class="s1">filename</span><span class="s3">=</span><span class="s5">'ScamyLog.png'</span><span class="s3">)</span>
    <span class="s1">facebook_url </span><span class="s3">= </span><span class="s5">&quot;https://www.facebook.com/profile.php?id=61555995077559&quot;</span>
    <span class="s1">twitter_url </span><span class="s3">= </span><span class="s5">&quot;https://twitter.com/ScanmyLog&quot;</span>
    <span class="s1">youtube_url </span><span class="s3">= </span><span class="s5">&quot;https://www.youtube.com/@ScanmyLog&quot;</span>
    <span class="s1">linkedin_url </span><span class="s3">= </span><span class="s5">&quot;https://www.linkedin.com/in/scanmy-log-3067a32b4/&quot;</span>
    <span class="s1">instagram_url </span><span class="s3">= </span><span class="s5">&quot;https://www.instagram.com/explore/tags/scanmylogo/&quot;</span>

    <span class="s2">if </span><span class="s1">request</span><span class="s3">.</span><span class="s1">method </span><span class="s3">== </span><span class="s5">'POST'</span><span class="s3">:</span>
        <span class="s1">email </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">form</span><span class="s3">[</span><span class="s5">'email'</span><span class="s3">]</span>
        <span class="s1">print</span><span class="s3">(</span><span class="s5">f&quot;Resetting password for email: </span><span class="s2">{</span><span class="s1">email</span><span class="s2">}</span><span class="s5">&quot;</span><span class="s3">)</span>
        <span class="s1">user </span><span class="s3">= </span><span class="s1">mongo</span><span class="s3">.</span><span class="s1">db</span><span class="s3">.</span><span class="s1">users</span><span class="s3">.</span><span class="s1">find_one</span><span class="s3">({</span><span class="s5">'email'</span><span class="s3">: </span><span class="s1">email</span><span class="s3">})</span>

        <span class="s2">if </span><span class="s1">user</span><span class="s3">:</span>
            <span class="s1">new_password </span><span class="s3">= </span><span class="s1">generate_new_password</span><span class="s3">()</span>
            <span class="s1">print</span><span class="s3">(</span><span class="s5">f&quot;New password generated: </span><span class="s2">{</span><span class="s1">new_password</span><span class="s2">}</span><span class="s5">&quot;</span><span class="s3">)</span>
            <span class="s1">hashed_password </span><span class="s3">= </span><span class="s1">generate_password_hash</span><span class="s3">(</span><span class="s1">new_password</span><span class="s3">)</span>

            <span class="s1">mongo</span><span class="s3">.</span><span class="s1">db</span><span class="s3">.</span><span class="s1">users</span><span class="s3">.</span><span class="s1">update_one</span><span class="s3">({</span><span class="s5">'email'</span><span class="s3">: </span><span class="s1">email</span><span class="s3">}, {</span><span class="s5">'$set'</span><span class="s3">: {</span><span class="s5">'password'</span><span class="s3">: </span><span class="s1">hashed_password</span><span class="s3">}})</span>
            <span class="s1">send_email_with_new_password_smtplib</span><span class="s3">(</span><span class="s1">email</span><span class="s3">, </span><span class="s1">new_password</span><span class="s3">)</span>

            <span class="s1">flash</span><span class="s3">(</span><span class="s5">'Your password has been reset successfully. Please check your email for the new password.'</span><span class="s3">, </span><span class="s5">'success'</span><span class="s3">)</span>
            <span class="s2">return </span><span class="s1">redirect</span><span class="s3">(</span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'login'</span><span class="s3">))</span>
        <span class="s2">else</span><span class="s3">:</span>
            <span class="s1">flash</span><span class="s3">(</span><span class="s5">'No account found with that email address.'</span><span class="s3">, </span><span class="s5">'error'</span><span class="s3">)</span>
            <span class="s1">print</span><span class="s3">(</span><span class="s5">&quot;No account found for the email provided.&quot;</span><span class="s3">)</span>

    <span class="s1">messages </span><span class="s3">= </span><span class="s1">get_flashed_messages</span><span class="s3">(</span><span class="s1">with_categories</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

    <span class="s2">return </span><span class="s1">render_template</span><span class="s3">(</span><span class="s5">&quot;Reset.html&quot;</span><span class="s3">, </span><span class="s1">messages</span><span class="s3">=</span><span class="s1">messages</span><span class="s3">, </span><span class="s1">logo_url</span><span class="s3">=</span><span class="s1">logo_url</span><span class="s3">,</span>
                                  <span class="s1">facebook_url</span><span class="s3">=</span><span class="s1">facebook_url</span><span class="s3">, </span><span class="s1">twitter_url</span><span class="s3">=</span><span class="s1">twitter_url</span><span class="s3">, </span><span class="s1">youtube_url</span><span class="s3">=</span><span class="s1">youtube_url</span><span class="s3">,</span>
                                  <span class="s1">linkedin_url</span><span class="s3">=</span><span class="s1">linkedin_url</span><span class="s3">, </span><span class="s1">instagram_url</span><span class="s3">=</span><span class="s1">instagram_url</span><span class="s3">)</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/receive_logs'</span><span class="s3">, </span><span class="s1">methods</span><span class="s3">=[</span><span class="s5">'POST'</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">receive_logs</span><span class="s3">():</span>
    <span class="s1">data </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">json</span>
    <span class="s2">if </span><span class="s1">data</span><span class="s3">:</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">logs_collection</span><span class="s3">.</span><span class="s1">insert_many</span><span class="s3">(</span><span class="s1">data </span><span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">data</span><span class="s3">, </span><span class="s1">list</span><span class="s3">) </span><span class="s2">else </span><span class="s3">[</span><span class="s1">data</span><span class="s3">])</span>
        <span class="s1">ids_str </span><span class="s3">= [</span><span class="s1">str</span><span class="s3">(</span><span class="s1">id_</span><span class="s3">) </span><span class="s2">for </span><span class="s1">id_ </span><span class="s2">in </span><span class="s1">result</span><span class="s3">.</span><span class="s1">inserted_ids</span><span class="s3">]</span>
        <span class="s2">return </span><span class="s5">f&quot;Logs received and inserted with IDs: </span><span class="s2">{</span><span class="s1">ids_str</span><span class="s2">}</span><span class="s5">&quot;</span><span class="s3">, </span><span class="s4">200</span>
    <span class="s2">else</span><span class="s3">:</span>
        <span class="s2">return </span><span class="s5">&quot;No data received&quot;</span><span class="s3">, </span><span class="s4">400</span>


<span class="s1">client </span><span class="s3">= </span><span class="s1">MongoClient</span><span class="s3">(</span><span class="s5">'mongodb://localhost:27017/'</span><span class="s3">)</span>
<span class="s1">db </span><span class="s3">= </span><span class="s1">client</span><span class="s3">[</span><span class="s5">'Client'</span><span class="s3">]</span>
<span class="s1">logs_collection </span><span class="s3">= </span><span class="s1">db</span><span class="s3">[</span><span class="s5">'logs'</span><span class="s3">]</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/logs'</span><span class="s3">)</span>
<span class="s2">def </span><span class="s1">logs_json</span><span class="s3">():</span>
    <span class="s1">page </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">args</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'page'</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s1">type</span><span class="s3">=</span><span class="s1">int</span><span class="s3">)</span>
    <span class="s1">per_page </span><span class="s3">= </span><span class="s4">20</span>
    <span class="s1">offset </span><span class="s3">= (</span><span class="s1">page </span><span class="s3">- </span><span class="s4">1</span><span class="s3">) * </span><span class="s1">per_page</span>
    <span class="s1">logs_cursor </span><span class="s3">= </span><span class="s1">logs_collection</span><span class="s3">.</span><span class="s1">find</span><span class="s3">().</span><span class="s1">sort</span><span class="s3">(</span><span class="s5">'TimeCreated'</span><span class="s3">, -</span><span class="s4">1</span><span class="s3">).</span><span class="s1">skip</span><span class="s3">(</span><span class="s1">offset</span><span class="s3">).</span><span class="s1">limit</span><span class="s3">(</span><span class="s1">per_page</span><span class="s3">)</span>
    <span class="s1">logs </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span><span class="s1">logs_cursor</span><span class="s3">)</span>
    <span class="s1">logs_json </span><span class="s3">= </span><span class="s1">json</span><span class="s3">.</span><span class="s1">loads</span><span class="s3">(</span><span class="s1">json_util</span><span class="s3">.</span><span class="s1">dumps</span><span class="s3">(</span><span class="s1">logs</span><span class="s3">))</span>
    <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">(</span><span class="s1">logs</span><span class="s3">=</span><span class="s1">logs_json</span><span class="s3">)</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/dashboard'</span><span class="s3">, </span><span class="s1">methods</span><span class="s3">=[</span><span class="s5">'GET'</span><span class="s3">, </span><span class="s5">'POST'</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">dashboard</span><span class="s3">():</span>
    <span class="s1">logo_url </span><span class="s3">= </span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'static'</span><span class="s3">, </span><span class="s1">filename</span><span class="s3">=</span><span class="s5">'ScanmyLog.png'</span><span class="s3">)</span>
    <span class="s1">pipeline </span><span class="s3">= [</span>
        <span class="s3">{</span>
            <span class="s5">&quot;$addFields&quot;</span><span class="s3">: {</span>
                <span class="s5">&quot;TimeCreatedDate&quot;</span><span class="s3">: {</span>
                    <span class="s5">&quot;$toDate&quot;</span><span class="s3">: </span><span class="s5">&quot;$TimeCreated&quot;</span>
                <span class="s3">}</span>
            <span class="s3">}</span>
        <span class="s3">},</span>
        <span class="s3">{</span>
            <span class="s5">&quot;$group&quot;</span><span class="s3">: {</span>
                <span class="s5">&quot;_id&quot;</span><span class="s3">: {</span>
                    <span class="s5">&quot;MachineName&quot;</span><span class="s3">: </span><span class="s5">&quot;$MachineName&quot;</span><span class="s3">,</span>
                    <span class="s5">&quot;TimeCreated&quot;</span><span class="s3">: {</span>
                        <span class="s5">&quot;$dateToString&quot;</span><span class="s3">: {</span>
                            <span class="s5">&quot;format&quot;</span><span class="s3">: </span><span class="s5">&quot;%Y-%m-%d %H&quot;</span><span class="s3">,</span>
                            <span class="s5">&quot;date&quot;</span><span class="s3">: </span><span class="s5">&quot;$TimeCreatedDate&quot;</span><span class="s3">,</span>
                            <span class="s5">&quot;timezone&quot;</span><span class="s3">: </span><span class="s5">&quot;+08:00&quot;</span>
                        <span class="s3">}</span>
                    <span class="s3">}</span>
                <span class="s3">},</span>
                <span class="s5">&quot;IDOccurrences&quot;</span><span class="s3">: {</span><span class="s5">&quot;$sum&quot;</span><span class="s3">: </span><span class="s4">1</span><span class="s3">}</span>
            <span class="s3">}</span>
        <span class="s3">},</span>
        <span class="s3">{</span><span class="s5">&quot;$sort&quot;</span><span class="s3">: {</span><span class="s5">&quot;_id.TimeCreated&quot;</span><span class="s3">: </span><span class="s4">1</span><span class="s3">}}</span>
    <span class="s3">]</span>

    <span class="s1">aggregated_data </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span><span class="s1">logs_collection</span><span class="s3">.</span><span class="s1">aggregate</span><span class="s3">(</span><span class="s1">pipeline</span><span class="s3">))</span>

    <span class="s0"># Initialize the chart data structure</span>
    <span class="s1">chart_data </span><span class="s3">= {</span>
        <span class="s5">&quot;labels&quot;</span><span class="s3">: [],</span>
        <span class="s5">&quot;datasets&quot;</span><span class="s3">: {}</span>
    <span class="s3">}</span>

    <span class="s0"># Aggregate data for Event ID chart</span>
    <span class="s1">event_id_data </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span><span class="s1">logs_collection</span><span class="s3">.</span><span class="s1">aggregate</span><span class="s3">([</span>
        <span class="s3">{</span><span class="s5">&quot;$group&quot;</span><span class="s3">: {</span><span class="s5">&quot;_id&quot;</span><span class="s3">: </span><span class="s5">&quot;$EventID&quot;</span><span class="s3">, </span><span class="s5">&quot;count&quot;</span><span class="s3">: {</span><span class="s5">&quot;$sum&quot;</span><span class="s3">: </span><span class="s4">1</span><span class="s3">}}},</span>
        <span class="s3">{</span><span class="s5">&quot;$sort&quot;</span><span class="s3">: {</span><span class="s5">&quot;count&quot;</span><span class="s3">: -</span><span class="s4">1</span><span class="s3">}},</span>
    <span class="s3">]))</span>

    <span class="s0"># Aggregate data for Machine Name chart</span>
    <span class="s1">machine_name_data </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span><span class="s1">logs_collection</span><span class="s3">.</span><span class="s1">aggregate</span><span class="s3">([</span>
        <span class="s3">{</span><span class="s5">&quot;$group&quot;</span><span class="s3">: {</span><span class="s5">&quot;_id&quot;</span><span class="s3">: </span><span class="s5">&quot;$MachineName&quot;</span><span class="s3">, </span><span class="s5">&quot;count&quot;</span><span class="s3">: {</span><span class="s5">&quot;$sum&quot;</span><span class="s3">: </span><span class="s4">1</span><span class="s3">}}},</span>
        <span class="s3">{</span><span class="s5">&quot;$sort&quot;</span><span class="s3">: {</span><span class="s5">&quot;count&quot;</span><span class="s3">: -</span><span class="s4">1</span><span class="s3">}},</span>
    <span class="s3">]))</span>

    <span class="s0"># Fetch the time created and ID occurrences from MongoDB</span>
    <span class="s1">logs_cursor </span><span class="s3">= </span><span class="s1">logs_collection</span><span class="s3">.</span><span class="s1">find</span><span class="s3">({}, {</span><span class="s5">'TimeCreated'</span><span class="s3">: </span><span class="s4">1</span><span class="s3">, </span><span class="s5">'IDOccurrences'</span><span class="s3">: </span><span class="s4">1</span><span class="s3">}).</span><span class="s1">sort</span><span class="s3">(</span><span class="s5">'TimeCreated'</span><span class="s3">, </span><span class="s4">1</span><span class="s3">)</span>
    <span class="s1">logs </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span><span class="s1">logs_cursor</span><span class="s3">)</span>

    <span class="s0"># Log the structure of the first document to the console</span>
    <span class="s2">if </span><span class="s1">logs</span><span class="s3">:</span>
        <span class="s1">print</span><span class="s3">(</span><span class="s5">&quot;Structure of the first document:&quot;</span><span class="s3">, </span><span class="s1">logs</span><span class="s3">[</span><span class="s4">0</span><span class="s3">])</span>
    <span class="s2">else</span><span class="s3">:</span>
        <span class="s1">print</span><span class="s3">(</span><span class="s5">&quot;No documents found in the collection.&quot;</span><span class="s3">)</span>

    <span class="s0"># Prepare data for the chart</span>
    <span class="s1">times </span><span class="s3">= [</span><span class="s1">log</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'TimeCreated'</span><span class="s3">) </span><span class="s2">for </span><span class="s1">log </span><span class="s2">in </span><span class="s1">logs</span><span class="s3">]</span>
    <span class="s1">id_occurrences </span><span class="s3">= [</span><span class="s1">log</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'IDOccurrences'</span><span class="s3">, </span><span class="s4">0</span><span class="s3">) </span><span class="s2">for </span><span class="s1">log </span><span class="s2">in </span><span class="s1">logs</span><span class="s3">]</span>

    <span class="s0"># Process the aggregated data for the chart</span>
    <span class="s2">for </span><span class="s1">data </span><span class="s2">in </span><span class="s1">aggregated_data</span><span class="s3">:</span>
        <span class="s1">machine_name </span><span class="s3">= </span><span class="s1">data</span><span class="s3">[</span><span class="s5">'_id'</span><span class="s3">][</span><span class="s5">'MachineName'</span><span class="s3">]</span>
        <span class="s1">time_label </span><span class="s3">= </span><span class="s1">data</span><span class="s3">[</span><span class="s5">'_id'</span><span class="s3">][</span><span class="s5">'TimeCreated'</span><span class="s3">]</span>
        <span class="s1">occurrences </span><span class="s3">= </span><span class="s1">data</span><span class="s3">[</span><span class="s5">'IDOccurrences'</span><span class="s3">]</span>

        <span class="s0"># Add the time label if it's not already in the labels</span>
        <span class="s2">if </span><span class="s1">time_label </span><span class="s2">not in </span><span class="s1">chart_data</span><span class="s3">[</span><span class="s5">&quot;labels&quot;</span><span class="s3">]:</span>
            <span class="s1">chart_data</span><span class="s3">[</span><span class="s5">&quot;labels&quot;</span><span class="s3">].</span><span class="s1">append</span><span class="s3">(</span><span class="s1">time_label</span><span class="s3">)</span>

        <span class="s0"># Add the occurrences to the respective machine's dataset</span>
        <span class="s2">if </span><span class="s1">machine_name </span><span class="s2">not in </span><span class="s1">chart_data</span><span class="s3">[</span><span class="s5">&quot;datasets&quot;</span><span class="s3">]:</span>
            <span class="s1">chart_data</span><span class="s3">[</span><span class="s5">&quot;datasets&quot;</span><span class="s3">][</span><span class="s1">machine_name</span><span class="s3">] = []</span>

        <span class="s1">chart_data</span><span class="s3">[</span><span class="s5">&quot;datasets&quot;</span><span class="s3">][</span><span class="s1">machine_name</span><span class="s3">].</span><span class="s1">append</span><span class="s3">(</span><span class="s1">occurrences</span><span class="s3">)</span>

    <span class="s0"># Ensure labels are sorted</span>
    <span class="s1">chart_data</span><span class="s3">[</span><span class="s5">&quot;labels&quot;</span><span class="s3">].</span><span class="s1">sort</span><span class="s3">()</span>

    <span class="s0"># Convert the datasets to the format expected by Chart.js</span>
    <span class="s1">datasets </span><span class="s3">= []</span>
    <span class="s2">for </span><span class="s1">machine_name</span><span class="s3">, </span><span class="s1">data </span><span class="s2">in </span><span class="s1">chart_data</span><span class="s3">[</span><span class="s5">&quot;datasets&quot;</span><span class="s3">].</span><span class="s1">items</span><span class="s3">():</span>
        <span class="s1">datasets</span><span class="s3">.</span><span class="s1">append</span><span class="s3">({</span>
            <span class="s5">&quot;label&quot;</span><span class="s3">: </span><span class="s1">machine_name</span><span class="s3">,</span>
            <span class="s5">&quot;data&quot;</span><span class="s3">: </span><span class="s1">data</span><span class="s3">,</span>
        <span class="s3">})</span>

    <span class="s1">chart_data</span><span class="s3">[</span><span class="s5">&quot;datasets&quot;</span><span class="s3">] = []</span>

    <span class="s0"># Process the aggregated data for the chart</span>
    <span class="s2">for </span><span class="s1">data </span><span class="s2">in </span><span class="s1">aggregated_data</span><span class="s3">:</span>
        <span class="s1">machine_name </span><span class="s3">= </span><span class="s1">data</span><span class="s3">[</span><span class="s5">'_id'</span><span class="s3">][</span><span class="s5">'MachineName'</span><span class="s3">]</span>
        <span class="s1">time_label </span><span class="s3">= </span><span class="s1">data</span><span class="s3">[</span><span class="s5">'_id'</span><span class="s3">][</span><span class="s5">'TimeCreated'</span><span class="s3">]</span>
        <span class="s1">occurrences </span><span class="s3">= </span><span class="s1">data</span><span class="s3">[</span><span class="s5">'IDOccurrences'</span><span class="s3">]</span>

        <span class="s0"># Find or create the dataset for the machine name</span>
        <span class="s1">dataset </span><span class="s3">= </span><span class="s1">next</span><span class="s3">((</span><span class="s1">d </span><span class="s2">for </span><span class="s1">d </span><span class="s2">in </span><span class="s1">chart_data</span><span class="s3">[</span><span class="s5">&quot;datasets&quot;</span><span class="s3">] </span><span class="s2">if </span><span class="s1">d</span><span class="s3">[</span><span class="s5">&quot;label&quot;</span><span class="s3">] == </span><span class="s1">machine_name</span><span class="s3">), </span><span class="s2">None</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">dataset </span><span class="s2">is None</span><span class="s3">:</span>
            <span class="s0"># If the dataset does not exist, create it and add it to the datasets list</span>
            <span class="s1">dataset </span><span class="s3">= {</span>
                <span class="s5">&quot;label&quot;</span><span class="s3">: </span><span class="s1">machine_name</span><span class="s3">,</span>
                <span class="s5">&quot;data&quot;</span><span class="s3">: [</span><span class="s4">0</span><span class="s3">] * </span><span class="s1">len</span><span class="s3">(</span><span class="s1">chart_data</span><span class="s3">[</span><span class="s5">&quot;labels&quot;</span><span class="s3">]),</span>
            <span class="s3">}</span>
            <span class="s1">chart_data</span><span class="s3">[</span><span class="s5">&quot;datasets&quot;</span><span class="s3">].</span><span class="s1">append</span><span class="s3">(</span><span class="s1">dataset</span><span class="s3">)</span>

        <span class="s0"># Add the occurrences to the correct position based on the label index</span>
        <span class="s1">label_index </span><span class="s3">= </span><span class="s1">chart_data</span><span class="s3">[</span><span class="s5">&quot;labels&quot;</span><span class="s3">].</span><span class="s1">index</span><span class="s3">(</span><span class="s1">time_label</span><span class="s3">)</span>
        <span class="s1">dataset</span><span class="s3">[</span><span class="s5">&quot;data&quot;</span><span class="s3">][</span><span class="s1">label_index</span><span class="s3">] = </span><span class="s1">occurrences</span>

    <span class="s1">machine_name_counts </span><span class="s3">= [</span><span class="s1">item</span><span class="s3">[</span><span class="s5">'count'</span><span class="s3">] </span><span class="s2">for </span><span class="s1">item </span><span class="s2">in </span><span class="s1">machine_name_data</span><span class="s3">]</span>
    <span class="s1">event_id_counts </span><span class="s3">= [</span><span class="s1">item</span><span class="s3">[</span><span class="s5">'count'</span><span class="s3">] </span><span class="s2">for </span><span class="s1">item </span><span class="s2">in </span><span class="s1">event_id_data</span><span class="s3">]</span>

    <span class="s1">combined_data </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span><span class="s1">logs_collection</span><span class="s3">.</span><span class="s1">aggregate</span><span class="s3">([</span>
        <span class="s3">{</span>
            <span class="s5">&quot;$group&quot;</span><span class="s3">: {</span>
                <span class="s5">&quot;_id&quot;</span><span class="s3">: {</span>
                    <span class="s5">&quot;MachineName&quot;</span><span class="s3">: </span><span class="s5">&quot;$MachineName&quot;</span><span class="s3">,</span>
                    <span class="s5">&quot;EventID&quot;</span><span class="s3">: </span><span class="s5">&quot;$EventID&quot;</span>
                <span class="s3">},</span>
                <span class="s5">&quot;count&quot;</span><span class="s3">: {</span><span class="s5">&quot;$sum&quot;</span><span class="s3">: </span><span class="s4">1</span><span class="s3">}</span>
            <span class="s3">}</span>
        <span class="s3">},</span>
        <span class="s3">{</span><span class="s5">&quot;$sort&quot;</span><span class="s3">: {</span><span class="s5">&quot;_id.MachineName&quot;</span><span class="s3">: </span><span class="s4">1</span><span class="s3">, </span><span class="s5">&quot;count&quot;</span><span class="s3">: -</span><span class="s4">1</span><span class="s3">}}</span>
    <span class="s3">]))</span>

    <span class="s0"># Prepare data for visualization</span>
    <span class="s1">machine_event_data </span><span class="s3">= {}</span>
    <span class="s2">for </span><span class="s1">item </span><span class="s2">in </span><span class="s1">combined_data</span><span class="s3">:</span>
        <span class="s1">machine_name </span><span class="s3">= </span><span class="s1">item</span><span class="s3">[</span><span class="s5">&quot;_id&quot;</span><span class="s3">][</span><span class="s5">&quot;MachineName&quot;</span><span class="s3">]</span>
        <span class="s1">event_id </span><span class="s3">= </span><span class="s1">item</span><span class="s3">[</span><span class="s5">&quot;_id&quot;</span><span class="s3">][</span><span class="s5">&quot;EventID&quot;</span><span class="s3">]</span>
        <span class="s1">count </span><span class="s3">= </span><span class="s1">item</span><span class="s3">[</span><span class="s5">&quot;count&quot;</span><span class="s3">]</span>
        <span class="s2">if </span><span class="s1">machine_name </span><span class="s2">not in </span><span class="s1">machine_event_data</span><span class="s3">:</span>
            <span class="s1">machine_event_data</span><span class="s3">[</span><span class="s1">machine_name</span><span class="s3">] = []</span>
        <span class="s1">machine_event_data</span><span class="s3">[</span><span class="s1">machine_name</span><span class="s3">].</span><span class="s1">append</span><span class="s3">({</span><span class="s5">&quot;event_id&quot;</span><span class="s3">: </span><span class="s1">event_id</span><span class="s3">, </span><span class="s5">&quot;count&quot;</span><span class="s3">: </span><span class="s1">count</span><span class="s3">})</span>

    <span class="s1">severity_data </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span><span class="s1">logs_collection</span><span class="s3">.</span><span class="s1">aggregate</span><span class="s3">([</span>
        <span class="s3">{</span>
            <span class="s5">&quot;$group&quot;</span><span class="s3">: {</span>
                <span class="s5">&quot;_id&quot;</span><span class="s3">: </span><span class="s5">&quot;$Severity&quot;</span><span class="s3">,</span>
                <span class="s5">&quot;TotalEventsCount&quot;</span><span class="s3">: {</span><span class="s5">&quot;$sum&quot;</span><span class="s3">: </span><span class="s4">1</span><span class="s3">}</span>
            <span class="s3">}</span>
        <span class="s3">},</span>
        <span class="s3">{</span><span class="s5">&quot;$sort&quot;</span><span class="s3">: {</span><span class="s5">&quot;TotalEventsCount&quot;</span><span class="s3">: -</span><span class="s4">1</span><span class="s3">}}</span>
    <span class="s3">]))</span>

    <span class="s0"># Prepare severity data for visualization</span>
    <span class="s1">severity_labels </span><span class="s3">= [</span><span class="s1">item</span><span class="s3">[</span><span class="s5">'_id'</span><span class="s3">] </span><span class="s2">for </span><span class="s1">item </span><span class="s2">in </span><span class="s1">severity_data</span><span class="s3">]</span>
    <span class="s1">severity_counts </span><span class="s3">= [</span><span class="s1">item</span><span class="s3">[</span><span class="s5">'TotalEventsCount'</span><span class="s3">] </span><span class="s2">for </span><span class="s1">item </span><span class="s2">in </span><span class="s1">severity_data</span><span class="s3">]</span>

    <span class="s2">return </span><span class="s1">render_template</span><span class="s3">(</span><span class="s5">'Dashboard.html'</span><span class="s3">, </span><span class="s1">logo_url</span><span class="s3">=</span><span class="s1">logo_url</span><span class="s3">, </span><span class="s1">event_id_data</span><span class="s3">=</span><span class="s1">event_id_data</span><span class="s3">,</span>
                            <span class="s1">machine_name_data</span><span class="s3">=</span><span class="s1">machine_name_data</span><span class="s3">, </span><span class="s1">times</span><span class="s3">=</span><span class="s1">times</span><span class="s3">, </span><span class="s1">id_occurrences</span><span class="s3">=</span><span class="s1">id_occurrences</span><span class="s3">,</span>
                            <span class="s1">machine_name_counts</span><span class="s3">=</span><span class="s1">machine_name_counts</span><span class="s3">, </span><span class="s1">event_id_counts</span><span class="s3">=</span><span class="s1">event_id_counts</span><span class="s3">,</span>
                            <span class="s1">machine_event_data</span><span class="s3">=</span><span class="s1">machine_event_data</span><span class="s3">, </span><span class="s1">severity_labels</span><span class="s3">=</span><span class="s1">severity_labels</span><span class="s3">,</span>
                            <span class="s1">severity_counts</span><span class="s3">=</span><span class="s1">severity_counts</span><span class="s3">,</span>
                            <span class="s1">chart_data</span><span class="s3">=</span><span class="s1">json</span><span class="s3">.</span><span class="s1">dumps</span><span class="s3">({</span><span class="s5">&quot;labels&quot;</span><span class="s3">: </span><span class="s1">chart_data</span><span class="s3">[</span><span class="s5">&quot;labels&quot;</span><span class="s3">], </span><span class="s5">&quot;datasets&quot;</span><span class="s3">: </span><span class="s1">datasets</span><span class="s3">}))</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/chart-data-events'</span><span class="s3">)</span>
<span class="s2">def </span><span class="s1">chart_data_events</span><span class="s3">():</span>
    <span class="s1">pipeline </span><span class="s3">= [</span>
        <span class="s3">{</span>
            <span class="s5">'$group'</span><span class="s3">: {</span>
                <span class="s5">'_id'</span><span class="s3">: {</span>
                    <span class="s5">'EventID'</span><span class="s3">: </span><span class="s5">'$EventID'</span><span class="s3">,</span>
                    <span class="s5">'MachineName'</span><span class="s3">: </span><span class="s5">'$MachineName'</span>
                <span class="s3">},</span>
                <span class="s5">'Count'</span><span class="s3">: {</span><span class="s5">'$sum'</span><span class="s3">: </span><span class="s4">1</span><span class="s3">}</span>
            <span class="s3">}</span>
        <span class="s3">},</span>
        <span class="s3">{</span>
            <span class="s5">'$project'</span><span class="s3">: {</span>
                <span class="s5">'EventID'</span><span class="s3">: </span><span class="s5">'$_id.EventID'</span><span class="s3">,</span>
                <span class="s5">'MachineName'</span><span class="s3">: </span><span class="s5">'$_id.MachineName'</span><span class="s3">,</span>
                <span class="s5">'Count'</span><span class="s3">: </span><span class="s4">1</span><span class="s3">,</span>
                <span class="s5">'_id'</span><span class="s3">: </span><span class="s4">0</span>
            <span class="s3">}</span>
        <span class="s3">}</span>
    <span class="s3">]</span>

    <span class="s1">aggregated_data </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span><span class="s1">logs_collection</span><span class="s3">.</span><span class="s1">aggregate</span><span class="s3">(</span><span class="s1">pipeline</span><span class="s3">))</span>
    <span class="s1">labels </span><span class="s3">= [</span><span class="s5">f&quot;</span><span class="s2">{</span><span class="s1">data</span><span class="s3">[</span><span class="s5">'EventID'</span><span class="s3">]</span><span class="s2">} </span><span class="s5">- </span><span class="s2">{</span><span class="s1">data</span><span class="s3">[</span><span class="s5">'MachineName'</span><span class="s3">]</span><span class="s2">}</span><span class="s5">&quot; </span><span class="s2">for </span><span class="s1">data </span><span class="s2">in </span><span class="s1">aggregated_data</span><span class="s3">]</span>
    <span class="s1">events_count </span><span class="s3">= [</span><span class="s1">data</span><span class="s3">[</span><span class="s5">'Count'</span><span class="s3">] </span><span class="s2">for </span><span class="s1">data </span><span class="s2">in </span><span class="s1">aggregated_data</span><span class="s3">]</span>

    <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">(</span><span class="s1">labels</span><span class="s3">=</span><span class="s1">labels</span><span class="s3">, </span><span class="s1">eventsCount</span><span class="s3">=</span><span class="s1">events_count</span><span class="s3">)</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/chart-data-logs'</span><span class="s3">)</span>
<span class="s2">def </span><span class="s1">chart_data_logs</span><span class="s3">():</span>
    <span class="s1">documents </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span><span class="s1">logs_collection</span><span class="s3">.</span><span class="s1">find</span><span class="s3">({}, {</span><span class="s5">'_id'</span><span class="s3">: </span><span class="s4">0</span><span class="s3">, </span><span class="s5">'LogName'</span><span class="s3">: </span><span class="s4">1</span><span class="s3">, </span><span class="s5">'EventID'</span><span class="s3">: </span><span class="s4">1</span><span class="s3">}))</span>
    <span class="s1">log_name_counts </span><span class="s3">= {}</span>
    <span class="s2">for </span><span class="s1">doc </span><span class="s2">in </span><span class="s1">documents</span><span class="s3">:</span>
        <span class="s1">log_name </span><span class="s3">= </span><span class="s1">doc</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'LogName'</span><span class="s3">, </span><span class="s5">'Unknown'</span><span class="s3">)</span>
        <span class="s1">log_name_counts</span><span class="s3">[</span><span class="s1">log_name</span><span class="s3">] = </span><span class="s1">log_name_counts</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s1">log_name</span><span class="s3">, </span><span class="s4">0</span><span class="s3">) + </span><span class="s4">1</span>

    <span class="s1">log_names </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span><span class="s1">log_name_counts</span><span class="s3">.</span><span class="s1">keys</span><span class="s3">())</span>
    <span class="s1">counts </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span><span class="s1">log_name_counts</span><span class="s3">.</span><span class="s1">values</span><span class="s3">())</span>

    <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">(</span><span class="s1">logNames</span><span class="s3">=</span><span class="s1">log_names</span><span class="s3">, </span><span class="s1">counts</span><span class="s3">=</span><span class="s1">counts</span><span class="s3">)</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/chart-data-event-ids'</span><span class="s3">)</span>
<span class="s2">def </span><span class="s1">chart_data_event_ids</span><span class="s3">():</span>
    <span class="s1">pipeline </span><span class="s3">= [</span>
        <span class="s3">{</span>
            <span class="s5">'$group'</span><span class="s3">: {</span>
                <span class="s5">'_id'</span><span class="s3">: </span><span class="s5">'$EventID'</span><span class="s3">,</span>
                <span class="s5">'Count'</span><span class="s3">: {</span><span class="s5">'$sum'</span><span class="s3">: </span><span class="s4">1</span><span class="s3">}</span>
            <span class="s3">}</span>
        <span class="s3">},</span>
        <span class="s3">{</span>
            <span class="s5">'$project'</span><span class="s3">: {</span>
                <span class="s5">'EventID'</span><span class="s3">: </span><span class="s5">'$_id'</span><span class="s3">,</span>
                <span class="s5">'Count'</span><span class="s3">: </span><span class="s4">1</span><span class="s3">,</span>
                <span class="s5">'_id'</span><span class="s3">: </span><span class="s4">0</span>
            <span class="s3">}</span>
        <span class="s3">},</span>
        <span class="s3">{</span>
            <span class="s5">'$sort'</span><span class="s3">: {</span><span class="s5">'EventID'</span><span class="s3">: </span><span class="s4">1</span><span class="s3">}</span>
        <span class="s3">}</span>
    <span class="s3">]</span>

    <span class="s1">aggregated_data </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span><span class="s1">logs_collection</span><span class="s3">.</span><span class="s1">aggregate</span><span class="s3">(</span><span class="s1">pipeline</span><span class="s3">))</span>
    <span class="s1">event_ids </span><span class="s3">= [</span><span class="s1">data</span><span class="s3">[</span><span class="s5">'EventID'</span><span class="s3">] </span><span class="s2">for </span><span class="s1">data </span><span class="s2">in </span><span class="s1">aggregated_data</span><span class="s3">]</span>
    <span class="s1">occurrences </span><span class="s3">= [</span><span class="s1">data</span><span class="s3">[</span><span class="s5">'Count'</span><span class="s3">] </span><span class="s2">for </span><span class="s1">data </span><span class="s2">in </span><span class="s1">aggregated_data</span><span class="s3">]</span>

    <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">(</span><span class="s1">eventIDs</span><span class="s3">=</span><span class="s1">event_ids</span><span class="s3">, </span><span class="s1">occurrences</span><span class="s3">=</span><span class="s1">occurrences</span><span class="s3">)</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/machine-summary'</span><span class="s3">)</span>
<span class="s2">def </span><span class="s1">machine_summary</span><span class="s3">():</span>
    <span class="s1">pipeline </span><span class="s3">= [</span>
        <span class="s3">{</span><span class="s5">'$group'</span><span class="s3">: {</span><span class="s5">'_id'</span><span class="s3">: </span><span class="s5">'$MachineName'</span><span class="s3">, </span><span class="s5">'TotalEvents'</span><span class="s3">: {</span><span class="s5">'$sum'</span><span class="s3">: </span><span class="s4">1</span><span class="s3">}}},</span>
        <span class="s3">{</span><span class="s5">'$sort'</span><span class="s3">: {</span><span class="s5">'TotalEvents'</span><span class="s3">: -</span><span class="s4">1</span><span class="s3">}}</span>
    <span class="s3">]</span>
    <span class="s1">results </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span><span class="s1">logs_collection</span><span class="s3">.</span><span class="s1">aggregate</span><span class="s3">(</span><span class="s1">pipeline</span><span class="s3">))</span>
    <span class="s1">machine_names </span><span class="s3">= [</span><span class="s1">result</span><span class="s3">[</span><span class="s5">'_id'</span><span class="s3">] </span><span class="s2">for </span><span class="s1">result </span><span class="s2">in </span><span class="s1">results</span><span class="s3">]</span>
    <span class="s1">totals </span><span class="s3">= [</span><span class="s1">result</span><span class="s3">[</span><span class="s5">'TotalEvents'</span><span class="s3">] </span><span class="s2">for </span><span class="s1">result </span><span class="s2">in </span><span class="s1">results</span><span class="s3">]</span>
    <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">(</span><span class="s1">machineNames</span><span class="s3">=</span><span class="s1">machine_names</span><span class="s3">, </span><span class="s1">totalEvents</span><span class="s3">=</span><span class="s1">totals</span><span class="s3">)</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/event-summary'</span><span class="s3">)</span>
<span class="s2">def </span><span class="s1">event_summary</span><span class="s3">():</span>
    <span class="s1">pipeline </span><span class="s3">= [</span>
        <span class="s3">{</span><span class="s5">'$group'</span><span class="s3">: {</span><span class="s5">'_id'</span><span class="s3">: </span><span class="s5">'$EventID'</span><span class="s3">, </span><span class="s5">'TotalEvents'</span><span class="s3">: {</span><span class="s5">'$sum'</span><span class="s3">: </span><span class="s4">1</span><span class="s3">}}},</span>
        <span class="s3">{</span><span class="s5">'$sort'</span><span class="s3">: {</span><span class="s5">'TotalEvents'</span><span class="s3">: -</span><span class="s4">1</span><span class="s3">}}</span>
    <span class="s3">]</span>
    <span class="s1">results </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span><span class="s1">logs_collection</span><span class="s3">.</span><span class="s1">aggregate</span><span class="s3">(</span><span class="s1">pipeline</span><span class="s3">))</span>
    <span class="s1">event_ids </span><span class="s3">= [</span><span class="s1">result</span><span class="s3">[</span><span class="s5">'_id'</span><span class="s3">] </span><span class="s2">for </span><span class="s1">result </span><span class="s2">in </span><span class="s1">results</span><span class="s3">]</span>
    <span class="s1">total_events </span><span class="s3">= [</span><span class="s1">result</span><span class="s3">[</span><span class="s5">'TotalEvents'</span><span class="s3">] </span><span class="s2">for </span><span class="s1">result </span><span class="s2">in </span><span class="s1">results</span><span class="s3">]</span>
    <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">(</span><span class="s1">eventIDs</span><span class="s3">=</span><span class="s1">event_ids</span><span class="s3">, </span><span class="s1">totalEvents</span><span class="s3">=</span><span class="s1">total_events</span><span class="s3">)</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/log-data'</span><span class="s3">)</span>
<span class="s2">def </span><span class="s1">log_data</span><span class="s3">():</span>
    <span class="s1">pipeline </span><span class="s3">= [</span>
        <span class="s3">{</span><span class="s5">'$group'</span><span class="s3">: {</span><span class="s5">'_id'</span><span class="s3">: </span><span class="s5">'$LogName'</span><span class="s3">, </span><span class="s5">'Count'</span><span class="s3">: {</span><span class="s5">'$sum'</span><span class="s3">: </span><span class="s4">1</span><span class="s3">}}},</span>
        <span class="s3">{</span><span class="s5">'$sort'</span><span class="s3">: {</span><span class="s5">'Count'</span><span class="s3">: -</span><span class="s4">1</span><span class="s3">}}</span>
    <span class="s3">]</span>
    <span class="s1">results </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span><span class="s1">logs_collection</span><span class="s3">.</span><span class="s1">aggregate</span><span class="s3">(</span><span class="s1">pipeline</span><span class="s3">))</span>
    <span class="s1">log_names </span><span class="s3">= [</span><span class="s1">result</span><span class="s3">[</span><span class="s5">'_id'</span><span class="s3">] </span><span class="s2">for </span><span class="s1">result </span><span class="s2">in </span><span class="s1">results</span><span class="s3">]</span>
    <span class="s1">counts </span><span class="s3">= [</span><span class="s1">result</span><span class="s3">[</span><span class="s5">'Count'</span><span class="s3">] </span><span class="s2">for </span><span class="s1">result </span><span class="s2">in </span><span class="s1">results</span><span class="s3">]</span>
    <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">(</span><span class="s1">logNames</span><span class="s3">=</span><span class="s1">log_names</span><span class="s3">, </span><span class="s1">counts</span><span class="s3">=</span><span class="s1">counts</span><span class="s3">)</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/machine-data'</span><span class="s3">)</span>
<span class="s2">def </span><span class="s1">machine_data</span><span class="s3">():</span>
    <span class="s1">pipeline </span><span class="s3">= [</span>
        <span class="s3">{</span><span class="s5">'$group'</span><span class="s3">: {</span><span class="s5">'_id'</span><span class="s3">: </span><span class="s5">'$MachineName'</span><span class="s3">, </span><span class="s5">'Count'</span><span class="s3">: {</span><span class="s5">'$sum'</span><span class="s3">: </span><span class="s4">1</span><span class="s3">}}},</span>
        <span class="s3">{</span><span class="s5">'$sort'</span><span class="s3">: {</span><span class="s5">'Count'</span><span class="s3">: -</span><span class="s4">1</span><span class="s3">}}</span>
    <span class="s3">]</span>
    <span class="s1">results </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span><span class="s1">logs_collection</span><span class="s3">.</span><span class="s1">aggregate</span><span class="s3">(</span><span class="s1">pipeline</span><span class="s3">))</span>
    <span class="s1">machine_names </span><span class="s3">= [</span><span class="s1">result</span><span class="s3">[</span><span class="s5">'_id'</span><span class="s3">] </span><span class="s2">for </span><span class="s1">result </span><span class="s2">in </span><span class="s1">results</span><span class="s3">]</span>
    <span class="s1">occurrences </span><span class="s3">= [</span><span class="s1">result</span><span class="s3">[</span><span class="s5">'Count'</span><span class="s3">] </span><span class="s2">for </span><span class="s1">result </span><span class="s2">in </span><span class="s1">results</span><span class="s3">]</span>
    <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">(</span><span class="s1">machineNames</span><span class="s3">=</span><span class="s1">machine_names</span><span class="s3">, </span><span class="s1">occurrences</span><span class="s3">=</span><span class="s1">occurrences</span><span class="s3">)</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/machine-time-summary'</span><span class="s3">)</span>
<span class="s2">def </span><span class="s1">machine_time_summary</span><span class="s3">():</span>
    <span class="s1">pipeline </span><span class="s3">= [</span>
        <span class="s3">{</span><span class="s5">'$group'</span><span class="s3">: {</span>
            <span class="s5">'_id'</span><span class="s3">: </span><span class="s5">'$MachineName'</span><span class="s3">,</span>
            <span class="s5">'FirstEventTime'</span><span class="s3">: {</span><span class="s5">'$min'</span><span class="s3">: </span><span class="s5">'$TimeCreated'</span><span class="s3">},</span>
            <span class="s5">'TotalEvents'</span><span class="s3">: {</span><span class="s5">'$sum'</span><span class="s3">: </span><span class="s4">1</span><span class="s3">}</span>
        <span class="s3">}},</span>
        <span class="s3">{</span><span class="s5">'$sort'</span><span class="s3">: {</span><span class="s5">'FirstEventTime'</span><span class="s3">: </span><span class="s4">1</span><span class="s3">}}  </span><span class="s0"># Sort by the earliest time first</span>
    <span class="s3">]</span>
    <span class="s1">results </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span><span class="s1">logs_collection</span><span class="s3">.</span><span class="s1">aggregate</span><span class="s3">(</span><span class="s1">pipeline</span><span class="s3">))</span>
    <span class="s1">machine_names </span><span class="s3">= [</span><span class="s1">result</span><span class="s3">[</span><span class="s5">'_id'</span><span class="s3">] </span><span class="s2">for </span><span class="s1">result </span><span class="s2">in </span><span class="s1">results</span><span class="s3">]</span>
    <span class="s1">first_event_times </span><span class="s3">= [</span><span class="s1">result</span><span class="s3">[</span><span class="s5">'FirstEventTime'</span><span class="s3">] </span><span class="s2">for </span><span class="s1">result </span><span class="s2">in </span><span class="s1">results</span><span class="s3">]</span>
    <span class="s1">total_events </span><span class="s3">= [</span><span class="s1">result</span><span class="s3">[</span><span class="s5">'TotalEvents'</span><span class="s3">] </span><span class="s2">for </span><span class="s1">result </span><span class="s2">in </span><span class="s1">results</span><span class="s3">]</span>
    <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">(</span><span class="s1">machineNames</span><span class="s3">=</span><span class="s1">machine_names</span><span class="s3">, </span><span class="s1">firstEventTimes</span><span class="s3">=</span><span class="s1">first_event_times</span><span class="s3">, </span><span class="s1">totalEvents</span><span class="s3">=</span><span class="s1">total_events</span><span class="s3">)</span>


<span class="s0"># Dictionary containing event IDs and their descriptions</span>
<span class="s1">event_descriptions </span><span class="s3">= {</span>
    <span class="s5">&quot;1102 Audit Log Cleared&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 1102 - Audit Log Cleared&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when the Windows security audit log is cleared. It's a critical part of the Windows  
    Security auditing system, as it helps maintain the integrity of security logs and track potential security  
    breaches. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 1102 is generated when the security audit log is manually cleared or reset. This action could be  
    performed by a user with administrative privileges or as a result of a security incident. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Yes, clearing the audit log can be highly dangerous as it removes valuable information about system and user  
    activity. It can potentially conceal unauthorized access, security breaches, and other malicious activities. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Clearing the audit log is always dangerous, especially if done without proper authorization or for malicious  
    purposes. However, it becomes particularly concerning when done in response to a security incident or to cover  
    unauthorized actions. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may clear the audit log to conceal their activities and cover their tracks. This can make it  
    difficult for system administrators and security teams to detect and respond to security breaches or unauthorized  
    access. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;Prevent unauthorized access to systems and administrative privileges, monitor audit log activity for unusual or  
    suspicious behavior, implement strict access controls, and use security software to detect and prevent unauthorized  
    log clearing. &lt;/p&gt; 
       &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4624 Successful account log on&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4624 - Successful Account Logon&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when an account successfully logs onto Windows. It's a part of the Windows  
    Security auditing system, essential for tracking user activity and identifying potential security breaches. &lt;/p&gt; 
     
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4624 is generated when a user's credentials are correctly authenticated, regardless of the  
    authentication method. This includes both physical logins at the machine and remote logins via the network. &lt;/p&gt; 
     
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Not inherently. Successful logons are typical in everyday use. However, patterns such as logons at  
    unusual times or from unusual locations may indicate a security risk. &lt;/p&gt; 
     
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Unexpected logon times, logon attempts from unfamiliar locations, or an unusually high volume of logon  
    failures followed by a success are potential indicators of compromise. &lt;/p&gt; 
     
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker might use stolen credentials to gain unauthorized access. Observing successful logon events  
    can help identify such breaches, especially when accompanied by other suspicious activity. &lt;/p&gt; 
     
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;Enforce strong authentication policies, enable multi-factor authentication, regularly review security  
    logs, and use security software capable of detecting and preventing unauthorized access. &lt;/p&gt;        
        &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4625 Failed account log on&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
        &lt;h1&gt;Event ID 4625 - Failed Account Logon&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when an account fails to log onto Windows due to incorrect credentials or other  
    authentication failures. It's a crucial part of the Windows Security auditing system, essential for detecting  
    potential security threats. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4625 is generated when a user attempts to log in with invalid credentials. This could be due to mistyped 
     passwords, expired accounts, or other authentication issues. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;While a single failed logon attempt is not inherently dangerous, a pattern of repeated failed attempts could  
    indicate a potential security threat. Brute-force attacks and password guessing are common tactics used by  
    attackers. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Repeated failed logon attempts from the same source or IP address, especially if they occur within a short  
    period, may indicate a malicious actor attempting to gain unauthorized access to the system. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;Attackers may use automated scripts or tools to systematically guess passwords or perform brute-force attacks  
    against user accounts. Detecting and monitoring failed logon attempts can help identify and mitigate such attacks. 
    &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;Implement account lockout policies to prevent multiple failed logon attempts, use strong and complex passwords,  
    enforce multi-factor authentication, regularly review security logs, and employ intrusion detection systems to  
    detect and block suspicious login attempts. &lt;/p&gt; 
        &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4634 An account logged off&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
            &lt;h1&gt;Event ID 4634 - An Account Logged Off&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when an account logs off from Windows. It's an integral part of the Windows Security  
    auditing system, providing insights into user activity and system usage. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4634 is generated when a user account logs off from a Windows session. This can occur when the user  
    manually logs out, the session times out, or the user's session is forcibly terminated. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;In most cases, account logoffs are routine and not inherently dangerous. However, unexpected or unauthorized  
    logoffs may indicate a security issue, such as unauthorized access or a system malfunction. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Unexpected or unauthorized account logoffs, especially if they occur frequently or without explanation, may  
    indicate a security breach. Additionally, simultaneous logoffs from multiple user accounts could be a sign of a  
    system-wide issue or attack. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may attempt to force a user account logoff as part of an intrusion or system compromise. Detecting  
    and investigating unexpected or unauthorized logoffs can help identify and respond to such attacks. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with unexpected or unauthorized account logoffs, implement strong access control  
    policies, regularly review security logs for unusual logoff events, monitor system activity for signs of  
    unauthorized access, and use security software to detect and prevent malicious activity. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4648 A logon attempt was made with explicit credentials&quot;</span><span class="s3">:  </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4648 - A Logon Attempt Was Made with Explicit Credentials&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when a user attempts to log in to a Windows account using explicit credentials. It's a  
    critical part of the Windows Security auditing system, essential for detecting potential security breaches. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4648 is generated when a user attempts to log in using credentials that are explicitly provided, such as 
     when using the &quot;Run as different user&quot; feature or programmatically providing credentials. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Yes, logon attempts with explicit credentials can be dangerous, especially if done without proper authorization.  
    It may indicate an attempt to bypass security controls or gain unauthorized access to sensitive resources. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Logon attempts with explicit credentials are particularly dangerous when performed by unauthorized users or in  
    situations where sensitive data or systems are involved. It may indicate a potential security threat or attempt at  
    privilege escalation. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may attempt to log in with explicit credentials to bypass security controls, escalate privileges, or  
    gain unauthorized access to sensitive information or systems. Detecting and investigating such logon attempts is  
    crucial for identifying and mitigating security risks. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with logon attempts using explicit credentials, enforce strict access control  
    policies, limit user privileges, regularly review security logs for unusual logon events, and use security software  
    to detect and prevent unauthorized access attempts. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4657 A registry value was changed&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4657 - A Registry Value Was Changed&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when a registry value is changed on a Windows system. The Windows Registry stores  
    configuration settings and options for the operating system and installed applications. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4657 is generated when a user or process modifies a registry value. This could occur through  
    administrative tasks, application installations, system updates, or malicious activities. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The modification of registry values can be dangerous if done without proper authorization or for malicious  
    purposes. It may impact system stability, security, and functionality, leading to system errors or compromise. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Unauthorized modifications to critical registry values or those related to system security settings are  
    particularly dangerous. They may indicate a security breach, attempt to gain unauthorized access, or compromise  
    system integrity. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may modify registry values to achieve various malicious goals, such as disabling security features,  
    installing malware, or altering system configurations. Detecting and investigating registry value changes is crucial 
     for identifying and responding to such attacks. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with unauthorized changes to registry values, enforce strict access controls,  
    limit administrative privileges, regularly review security logs for registry modification events, monitor system  
    configurations, and use security software to detect and prevent unauthorized modifications. &lt;/p&gt; 
               &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4672 Special privileges assigned to new logon&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4672 - Special Privileges Assigned to New Logon&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4672 is an audit event that occurs when a user account logs on with special privileges. On Windows  
    systems, special privileges are high-level rights that can be used to manage the configuration and operation of  
    the computer. &lt;/p&gt; 
     
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;This event is typically logged when an account assigned with administrative rights logs on or when a service  
    starts that has been configured with special privileges. This can be a routine occurrence if an authorized  
    administrative user or service is legitimately accessing the system. &lt;/p&gt; 
     
        &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The assignment of special privileges is not inherently dangerous and can be a regular part of system operations.  
    However, if such privileges are assigned to a user or service unexpectedly, it may indicate a security issue. &lt;/p&gt; 
     
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;It is dangerous when special privileges are assigned without authorization, or as part of an attack sequence.  
    Unauthorized privilege assignment can lead to escalation of privileges, system compromise, and unauthorized actions. 
    &lt;/p&gt; 
     
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker with sufficient credentials may log on with or assign special privileges to a user account to perform 
     actions that would otherwise be restricted. Such actions can include altering security settings, accessing  
     confidential data, and executing privileged commands. &lt;/p&gt; 
     
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To prevent unauthorized use of special privileges: 
    &lt;ul&gt; 
        &lt;li&gt;Enforce the principle of least privilege, ensuring users have only the access they need.&lt;/li&gt; 
        &lt;li&gt;Monitor security logs for event ID 4672, especially if it occurs at unexpected times or involves unusual  
        accounts.&lt;/li&gt; 
        &lt;li&gt;Implement robust authentication mechanisms and audit privileged accounts regularly.&lt;/li&gt; 
        &lt;li&gt;Use security information and event management (SIEM) solutions to detect abnormal behavior related to  
        privilege use.&lt;/li&gt; 
    &lt;/ul&gt; 
    &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4697 An attempt was made to install a service&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4697 - An Attempt Was Made to Install a Service&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when an attempt is made to install a service on a Windows system. Services are programs  
    that run in the background, providing core functionality or support for other applications. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4697 is generated when a user or process attempts to install a service on the system. This could occur  
    through administrative tasks, application installations, system updates, or malicious activities. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The installation of unauthorized or malicious services can be dangerous as it may introduce security  
    vulnerabilities, compromise system stability, or facilitate unauthorized access to the system. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Unauthorized attempts to install services, especially those with system-level privileges or access to sensitive  
    resources, are particularly dangerous. They may indicate a security breach, attempt to gain unauthorized access, or  
    install malware. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may attempt to install a malicious service to gain persistent access to the system, execute malicious 
     code, or maintain persistence after compromising the system. Detecting and investigating service installation  
     attempts is crucial for identifying and responding to such attacks. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with unauthorized service installation attempts, enforce strict access controls,  
    limit administrative privileges, use application whitelisting to control software installation, regularly review  
    security logs for service installation events, and use security software to detect and prevent unauthorized  
    installations. &lt;/p&gt; 
               &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4698 Events related to Windows scheduled tasks being created&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4698 - Events Related to Windows Scheduled Tasks Being Created&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when a new scheduled task is created on a Windows system. Scheduled tasks are automated  
    processes that run at predefined times or intervals. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4698 is generated when a user or process creates a new scheduled task using the Task Scheduler utility  
    or programmatically through scripting or programming interfaces. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The creation of scheduled tasks is not inherently dangerous, but it can be exploited by attackers to execute  
    malicious code, perform unauthorized activities, or maintain persistence on the system. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Creation of scheduled tasks by unauthorized users or processes, especially those with system-level privileges or  
    access to sensitive resources, is dangerous. It may indicate a security breach, attempt to gain unauthorized access, 
    or install malware. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may create scheduled tasks to execute malicious code, perform reconnaissance activities, maintain  
    persistence, or escalate privileges on the compromised system. Detecting and investigating scheduled task creation  
    events is crucial for identifying and responding to such attacks. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with unauthorized creation of scheduled tasks, enforce strict access controls,  
    limit administrative privileges, regularly review security logs for scheduled task creation events, monitor  
    scheduled tasks for suspicious activities, and use security software to detect and prevent unauthorized activities. 
    &lt;/p&gt; 
               &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4699 Events related to Windows scheduled tasks being modified&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4699 - Events Related to Windows Scheduled Tasks Being Modified&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when an existing scheduled task is modified on a Windows system. Scheduled tasks are  
    automated processes that run at predefined times or intervals. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4699 is generated when a user or process modifies the settings or properties of an existing scheduled  
    task using the Task Scheduler utility or programmatically through scripting or programming interfaces. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The modification of scheduled tasks can be dangerous if done without proper authorization or for malicious  
    purposes. It may lead to execution of unauthorized code, disruption of system operations, or compromise of system  
    security. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Unauthorized modifications to critical scheduled tasks, especially those with system-level privileges or access  
    to sensitive resources, are dangerous. They may indicate a security breach, attempt to gain unauthorized access, or  
    install malware. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may modify scheduled tasks to execute malicious code, perform reconnaissance activities, maintain  
    persistence, or escalate privileges on the compromised system. Detecting and investigating scheduled task  
    modification events is crucial for identifying and responding to such attacks. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with unauthorized modification of scheduled tasks, enforce strict access controls 
    , limit administrative privileges, regularly review security logs for scheduled task modification events, monitor  
    scheduled tasks for suspicious activities, and use security software to detect and prevent unauthorized  
    modifications. &lt;/p&gt; 
               &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4700 Events related to Windows scheduled tasks being deleted&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4700 - Events Related to Windows Scheduled Tasks Being Deleted&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when a scheduled task is deleted from a Windows system. Scheduled tasks are automated  
    processes that run at predefined times or intervals. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4700 is generated when a user or process deletes an existing scheduled task using the Task Scheduler  
    utility or programmatically through scripting or programming interfaces. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The deletion of scheduled tasks can be dangerous if done without proper authorization or for malicious purposes.  
    It may disrupt system operations, cause loss of critical functionality, or facilitate unauthorized access to the  
    system. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Unauthorized deletion of critical scheduled tasks, especially those with system-level privileges or access to  
    sensitive resources, is dangerous. It may indicate a security breach, attempt to gain unauthorized access, or remove 
    security controls. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may delete scheduled tasks to disrupt system operations, remove security controls, cover tracks, or  
    facilitate unauthorized access to the system. Detecting and investigating scheduled task deletion events is crucial  
    for identifying and responding to such attacks.&lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with unauthorized deletion of scheduled tasks, enforce strict access controls,  
    limit administrative privileges, regularly review security logs for scheduled task deletion events, monitor  
    scheduled tasks for suspicious activities, and use security software to detect and prevent unauthorized deletions. 
    &lt;/p&gt; 
               &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4701 Events related to Windows scheduled tasks being enabled&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4701 - Events Related to Windows Scheduled Tasks Being Enabled&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when a scheduled task is enabled on a Windows system. Scheduled tasks are automated  
    processes that run at predefined times or intervals. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4701 is generated when a user or process enables a previously disabled scheduled task using the  
    Task Scheduler utility or programmatically through scripting or programming interfaces. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The enabling of scheduled tasks is not inherently dangerous, but it can be exploited by attackers to execute  
    malicious code, perform unauthorized activities, or maintain persistence on the system. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Enabling of scheduled tasks by unauthorized users or processes, especially those with system-level privileges or  
    access to sensitive resources, is dangerous. It may indicate a security breach, attempt to gain unauthorized access, 
    or execute malicious activities. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may enable scheduled tasks to execute malicious code, perform reconnaissance activities, maintain  
    persistence, or escalate privileges on the compromised system. Detecting and investigating scheduled task enabling  
    events is crucial for identifying and responding to such attacks. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with unauthorized enabling of scheduled tasks, enforce strict access controls,  
    limit administrative privileges, regularly review security logs for scheduled task enabling events, monitor  
    scheduled tasks for suspicious activities, and use security software to detect and prevent unauthorized activities. 
    &lt;/p&gt; 
               &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4702 Events related to Windows scheduled tasks being disabled&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
&lt;h1&gt;Event ID 4702 - Events Related to Windows Scheduled Tasks Being Disabled&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when a scheduled task is disabled on a Windows system. Scheduled tasks are automated  
    processes that run at predefined times or intervals. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4702 is generated when a user or process disables a scheduled task using the Task Scheduler utility or  
    programmatically through scripting or programming interfaces. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The disabling of scheduled tasks is not inherently dangerous, but it can be exploited by attackers to disrupt  
    system operations, disable security controls, or cover tracks after compromising the system. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Disabling of critical scheduled tasks, especially those with system-level privileges or access to sensitive  
    resources, is dangerous. It may indicate a security breach, attempt to gain unauthorized access, or disrupt system  
    functionality. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may disable scheduled tasks to disrupt system operations, remove security controls, cover tracks, or  
    facilitate unauthorized access to the system. Detecting and investigating scheduled task disabling events is crucial 
     for identifying and responding to such attacks. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with unauthorized disabling of scheduled tasks, enforce strict access controls,  
    limit administrative privileges, regularly review security logs for scheduled task disabling events, monitor  
    scheduled tasks for suspicious activities, and use security software to detect and prevent unauthorized activities. 
    &lt;/p&gt; 
               &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4719 System audit policy was changed&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4719 - System Audit Policy Was Changed&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when the system audit policy settings are changed. It's a critical part of the Windows  
    Security auditing system, essential for maintaining the integrity of security controls and monitoring system  
    activity. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4719 is generated when changes are made to the system audit policy settings. This includes modifications 
     to auditing settings such as enabling or disabling audit categories, changing audit levels, or modifying audit  
     configurations. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Yes, changes to the system audit policy can be dangerous, especially if done without proper authorization.  
    Modifying audit settings can affect the ability to detect and respond to security incidents, potentially  
    compromising system security. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Changes to the system audit policy are particularly dangerous when performed by unauthorized users or in  
    situations where sensitive data or systems are involved. It may indicate an attempt to evade detection or cover up  
    unauthorized actions. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may attempt to modify the system audit policy to disable or weaken auditing controls, making it  
    easier to conduct malicious activities without detection. Detecting and investigating changes to audit policy  
    settings is crucial for maintaining system security. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with changes to the system audit policy, enforce strict access control policies,  
    limit user privileges, regularly review security logs for audit policy change events, and use security software to  
    detect and prevent unauthorized modifications. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4720 A user account was created&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4720 - A User Account Was Created&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when a new user account is created on a Windows system. It's an essential part of the  
    Windows Security auditing system, providing insights into user management activities and potential security  
    breaches. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4720 is generated when a new user account is created on the system. This could occur through various  
    means, such as using administrative tools, command-line utilities, or programmatically creating user accounts. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;While the creation of user accounts is a routine administrative task, it can be dangerous if done without proper  
    authorization or for malicious purposes. Unauthorized user account creation may indicate an attempt to gain  
    unauthorized access or compromise system security. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Unauthorized user account creation is particularly dangerous when performed by unauthorized users or in  
    situations where sensitive data or systems are involved. It may indicate a security breach or attempt to escalate  
    privileges. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may create a new user account to gain unauthorized access to the system, escalate privileges, or  
    conceal their activities. Detecting and investigating new user account creations is crucial for identifying and  
    responding to security threats. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with unauthorized user account creation, enforce strict access control policies, 
     limit user creation privileges to authorized personnel, regularly review security logs for new user account  
     creation events, and use security software to detect and prevent unauthorized activities. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4722 A user account was enabled&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4722 - A User Account Was Enabled&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when a previously disabled user account is enabled on a Windows system. It's an essential 
    part of the Windows Security auditing system, providing insights into user management activities and potential  
    security breaches. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4722 is generated when an administrator or privileged user enables a user account that was previously  
    disabled. This could occur through administrative tools, command-line utilities, or programmatically enabling user 
    accounts. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The enabling of user accounts is a routine administrative task, but it can be dangerous if done without proper  
    authorization or for malicious purposes. Unauthorized account enablement may indicate an attempt to gain  
    unauthorized access or compromise system security. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Unauthorized account enablement is particularly dangerous when performed by unauthorized users or in situations  
    where sensitive data or systems are involved. It may indicate a security breach or attempt to escalate privileges. 
    &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may enable a previously disabled user account to gain unauthorized access to the system, escalate  
    privileges, or conceal their activities. Detecting and investigating account enablement events is crucial for  
    identifying and responding to security threats.&lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with unauthorized account enablement, enforce strict access control policies,  
    limit account enablement privileges to authorized personnel, regularly review security logs for account enablement 
     events, and use security software to detect and prevent unauthorized activities.&lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4723 An attempt was made to change the password of an account&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4723 - An Attempt Was Made to Change the Password of an Account&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when an attempt is made to change the password of a user account on a Windows system.  
    It's an essential part of the Windows Security auditing system, providing insights into user management activities  
    and potential security breaches. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4723 is generated when an attempt is made to change the password of a user account. This could occur  
    through administrative tools, command-line utilities, or programmatically changing user account passwords. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The attempt to change a user account password can be dangerous if done without proper authorization or for  
    malicious purposes. Unauthorized password changes may indicate an attempt to gain unauthorized access or compromise  
    system security. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Unauthorized attempts to change user account passwords are particularly dangerous when performed by unauthorized  
    users or in situations where sensitive data or systems are involved. It may indicate a security breach or attempt at 
     privilege escalation. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may attempt to change the password of a user account to gain unauthorized access to the system,  
    escalate privileges, or conceal their activities. Detecting and investigating password change attempts is crucial  
    for identifying and responding to security threats. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with unauthorized attempts to change user account passwords, enforce strict  
    access control policies, limit password change privileges to authorized personnel, regularly review security logs  
    for password change events, and use security software to detect and prevent unauthorized activities. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4725 A user account was disabled&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4725 - A User Account Was Disabled&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when a user account is disabled on a Windows system. It's an essential part of the  
    Windows Security auditing system, providing insights into user management activities and potential security  
    breaches. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4725 is generated when an administrator or privileged user disables a user account. This could occur  
    through administrative tools, command-line utilities, or programmatically disabling user accounts. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The disabling of user accounts is a routine administrative task, but it can be dangerous if done without proper  
    authorization or for malicious purposes. Unauthorized account disablement may indicate an attempt to gain  
    unauthorized access or compromise system security. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Unauthorized account disablement is particularly dangerous when performed by unauthorized users or in situations  
    where sensitive data or systems are involved. It may indicate a security breach or attempt to disrupt system  
    functionality. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may disable user accounts to disrupt system operations, deny access to authorized users, or conceal  
    their activities. Detecting and investigating account disablement events is crucial for identifying and responding  
    to security threats. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with unauthorized account disablement, enforce strict access control policies,  
    limit account disablement privileges to authorized personnel, regularly review security logs for account disablement 
    events, and use security software to detect and prevent unauthorized activities. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4728 A user was added to a privileged global group&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4728 - A User Was Added to a Privileged Global Group&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when a user is added to a privileged global group on a Windows system. It's an essential  
    part of the Windows Security auditing system, providing insights into user management activities and potential  
    security breaches.&lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4728 is generated when an administrator or privileged user adds a user to a global group with elevated  
    privileges. This could occur through administrative tools, command-line utilities, or programmatically adding users 
    to global groups. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The addition of users to privileged global groups can be dangerous if done without proper authorization or for  
    malicious purposes. It may grant users elevated privileges and access to sensitive resources, increasing the risk of 
    unauthorized access or system compromise. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Unauthorized addition of users to privileged global groups is particularly dangerous when performed by  
    unauthorized users or in situations where sensitive data or systems are involved. It may indicate a security breach  
    or attempt at privilege escalation. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may add unauthorized users to privileged global groups to gain elevated privileges, access sensitive  
    information, or perform malicious actions. Detecting and investigating user additions to privileged global groups is 
     crucial for identifying and responding to security threats. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with unauthorized additions to privileged global groups, enforce strict access  
    control policies, limit group membership privileges to authorized personnel, regularly review security logs for  
    group membership change events, and use security software to detect and prevent unauthorized activities. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4732 A user was added to a privileged local group&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4732 - A User Was Added to a Privileged Local Group&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when a user is added to a privileged local group on a Windows system. It's an essential  
    part of the Windows Security auditing system, providing insights into user management activities and potential  
    security breaches. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4732 is generated when an administrator or privileged user adds a user to a local group with elevated  
    privileges. This could occur through administrative tools, command-line utilities, or programmatically adding users  
    to local groups. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The addition of users to privileged local groups can be dangerous if done without proper authorization or for  
    malicious purposes. It may grant users elevated privileges and access to sensitive resources, increasing the risk of 
    unauthorized access or system compromise. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Unauthorized addition of users to privileged local groups is particularly dangerous when performed by  
    unauthorized users or in situations where sensitive data or systems are involved. It may indicate a security breach  
    or attempt at privilege escalation. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may add unauthorized users to privileged local groups to gain elevated privileges, access sensitive  
    information, or perform malicious actions. Detecting and investigating user additions to privileged local groups is  
    crucial for identifying and responding to security threats. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with unauthorized additions to privileged local groups, enforce strict access  
    control policies, limit group membership privileges to authorized personnel, regularly review security logs for  
    group membership change events, and use security software to detect and prevent unauthorized activities. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4735 A privileged local group was modified&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4735 - A Privileged Local Group Was Modified&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when a privileged local group is modified on a Windows system. It's an essential part of  
    the Windows Security auditing system, providing insights into changes to group memberships and potential security  
    breaches. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4735 is generated when modifications are made to the membership or properties of a privileged local  
    group. This could include adding or removing users, changing group settings, or modifying group permissions. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The modification of privileged local groups can be dangerous if done without proper authorization or for  
    malicious purposes. It may grant users elevated privileges and access to sensitive resources, increasing the risk of 
    unauthorized access or system compromise. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Unauthorized modifications to privileged local groups are particularly dangerous when performed by unauthorized  
    users or in situations where sensitive data or systems are involved. It may indicate a security breach or attempt  
    at privilege escalation. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may modify privileged local groups to gain elevated privileges, access sensitive information, or  
    perform malicious actions. Detecting and investigating modifications to privileged local groups is crucial for  
    identifying and responding to security threats. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with unauthorized modifications to privileged local groups, enforce strict access 
     control policies, limit group modification privileges to authorized personnel, regularly review security logs for  
     group modification events, and use security software to detect and prevent unauthorized activities. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4737 A privileged global group was modified&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4737 - A Privileged Global Group Was Modified&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when a privileged global group is modified on a Windows system. It's an essential part of 
    the Windows Security auditing system, providing insights into changes to group memberships and potential security  
    breaches. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4737 is generated when modifications are made to the membership or properties of a privileged global  
    group. This could include adding or removing users, changing group settings, or modifying group permissions. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The modification of privileged global groups can be dangerous if done without proper authorization or for  
    malicious purposes. It may grant users elevated privileges and access to sensitive resources, increasing the risk of 
    unauthorized access or system compromise. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Unauthorized modifications to privileged global groups are particularly dangerous when performed by unauthorized  
    users or in situations where sensitive data or systems are involved. It may indicate a security breach or attempt at  
    privilege escalation. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may modify privileged global groups to gain elevated privileges, access sensitive information, or  
    perform malicious actions. Detecting and investigating modifications to privileged global groups is crucial for  
    identifying and responding to security threats. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with unauthorized modifications to privileged global groups, enforce strict  
    access control policies, limit group modification privileges to authorized personnel, regularly review security logs 
    for group modification events, and use security software to detect and prevent unauthorized activities. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4738 A user account was changed&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4738 - A User Account Was Changed&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when a user account is changed on a Windows system. It's an essential part of the Windows 
     Security auditing system, providing insights into user management activities and potential security breaches. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4738 is generated when changes are made to the properties of a user account. This could include  
    modifications to account settings, such as changing the account name, description, or group memberships. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The modification of user accounts can be dangerous if done without proper authorization or for malicious  
    purposes. It may grant users elevated privileges, access to sensitive resources, or compromise system security. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Unauthorized modifications to user accounts are particularly dangerous when performed by unauthorized users or in 
    situations where sensitive data or systems are involved. It may indicate a security breach or attempt at privilege  
    escalation. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may modify user accounts to gain elevated privileges, access sensitive information, or perform  
    malicious actions. Detecting and investigating account modification events is crucial for identifying and responding 
    to security threats. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with unauthorized modifications to user accounts, enforce strict access control  
    policies, limit account modification privileges to authorized personnel, regularly review security logs for account  
    modification events, and use security software to detect and prevent unauthorized activities. &lt;/p&gt; 
            &quot;&quot;&quot; </span><span class="s3">,</span>

    <span class="s5">&quot;4740 A user account was locked out&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4740 - A User Account Was Locked Out&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when a user account is locked out on a Windows system. It's an essential part of the  
    Windows Security auditing system, providing insights into potential security breaches or suspicious activity. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4740 is generated when a user account is locked out due to multiple failed login attempts. This security 
    measure helps protect against brute force attacks or unauthorized access attempts. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;User account lockouts are not inherently dangerous, but they can indicate potential security threats. Lockouts  
    may be caused by malicious actors attempting to gain unauthorized access to the system or by legitimate users  
    forgetting their passwords. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Repeated account lockouts, especially for privileged accounts or in rapid succession, may indicate a security  
    breach or an attempt to compromise system security. It's essential to investigate the cause of lockouts  
    promptly. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may deliberately attempt to lock out user accounts as part of a denial-of-service (DoS) attack or to  
    disrupt system operations. Detecting and investigating account lockout events is crucial for identifying and  
    responding to such attacks. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with user account lockouts, enforce strong password policies, educate users on  
    password security best practices, monitor security logs for lockout events, implement account lockout policies, and  
    use security software to detect and prevent unauthorized access attempts. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4755 A privileged universal group was modified&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4755 - A Privileged Universal Group Was Modified&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when a privileged universal group is modified on a Windows system. It's an essential part 
     of the Windows Security auditing system, providing insights into changes to group memberships and potential  
     security breaches. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4755 is generated when modifications are made to the membership or properties of a privileged universal  
    group. This could include adding or removing users, changing group settings, or modifying group permissions. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The modification of privileged universal groups can be dangerous if done without proper authorization or for  
    malicious purposes. It may grant users elevated privileges and access to sensitive resources, increasing the risk of 
     unauthorized access or system compromise. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Unauthorized modifications to privileged universal groups are particularly dangerous when performed by  
    unauthorized users or in situations where sensitive data or systems are involved. It may indicate a security breach  
    or attempt at privilege escalation. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may modify privileged universal groups to gain elevated privileges, access sensitive information, or  
    perform malicious actions. Detecting and investigating modifications to privileged universal groups is crucial for  
    identifying and responding to security threats. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with unauthorized modifications to privileged universal groups, enforce strict  
    access control policies, limit group modification privileges to authorized personnel, regularly review security logs 
     for group modification events, and use security software to detect and prevent unauthorized activities. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4756 A user was added to a privileged universal group&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4756 - A User Was Added to a Privileged Universal Group&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when a user is added to a privileged universal group on a Windows system. It's an  
    essential part of the Windows Security auditing system, providing insights into user management activities and  
    potential security breaches. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4756 is generated when an administrator or privileged user adds a user to a universal group with  
    elevated privileges. This could occur through administrative tools, command-line utilities, or programmatically  
    adding users to universal groups. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The addition of users to privileged universal groups can be dangerous if done without proper authorization or  
    for malicious purposes. It may grant users elevated privileges and access to sensitive resources, increasing the  
    risk of unauthorized access or system compromise. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Unauthorized additions of users to privileged universal groups are particularly dangerous when performed by  
    unauthorized users or in situations where sensitive data or systems are involved. It may indicate a security breach 
     or attempt at privilege escalation. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may add unauthorized users to privileged universal groups to gain elevated privileges, access  
    sensitive information, or perform malicious actions. Detecting and investigating user additions to privileged 
    universal groups is crucial for identifying and responding to security threats.n&lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with unauthorized additions to privileged universal groups, enforce strict access 
    control policies, limit group membership privileges to authorized personnel, regularly review security logs for  
    group membership change events, and use security software to detect and prevent unauthorized activities. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4767 A user account was unlocked&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4767 - A User Account Was Unlocked&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when a previously locked user account is unlocked on a Windows system. It's an essential  
    part of the Windows Security auditing system, providing insights into user management activities and potential  
    security breaches. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4767 is generated when an administrator or privileged user unlocks a user account that was previously  
    locked due to too many failed login attempts. This could occur through administrative tools or command-line  
    utilities. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;User account unlocks are not inherently dangerous, but they can indicate potential security threats or  
    unauthorized access attempts. It's essential to investigate the reason for the account lockout and ensure proper  
    security measures are in place. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Repeated account lockouts followed by an unlock event may indicate a security breach or an attempt to gain  
    unauthorized access to the system. It's crucial to monitor security logs for unusual patterns and investigate  
    suspicious activities promptly. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may attempt to unlock user accounts as part of a brute force attack or to gain unauthorized access  
    to the system. Detecting and investigating account unlock events is crucial for identifying and responding to such  
    attacks. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with unauthorized account unlocks, enforce strong password policies, implement  
    account lockout policies, regularly review security logs for account lockout and unlock events, and use security  
    software to detect and prevent unauthorized access attempts. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4772 A Kerberos authentication ticket request failed&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4772 - A Kerberos Authentication Ticket Request Failed&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when a Kerberos authentication ticket request fails on a Windows system. Kerberos is a  
    network authentication protocol used to authenticate users and services on a network. This event indicates a failure 
     in the authentication process. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4772 is generated when a client or service attempts to obtain a Kerberos authentication ticket, but the  
    request fails due to various reasons, such as incorrect credentials, expired tickets, or issues with the Kerberos  
    infrastructure. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;A failed Kerberos authentication ticket request is not inherently dangerous, but it can indicate potential  
    security threats or issues with the authentication infrastructure. It's essential to investigate the cause of the  
    failure to ensure the security and integrity of the network. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Repeated failed Kerberos authentication ticket requests may indicate an attempted authentication attack, such as  
    brute force attacks or credential stuffing. It's crucial to monitor security logs for patterns of failed  
    authentication attempts and investigate suspicious activities promptly. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may attempt to exploit vulnerabilities in the Kerberos authentication protocol to gain unauthorized  
    access to the network or sensitive resources. Detecting and investigating failed Kerberos authentication ticket  
    requests is crucial for identifying and responding to such attacks. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with failed Kerberos authentication ticket requests, ensure proper configuration  
    and maintenance of the Kerberos infrastructure, enforce strong authentication policies, regularly review security  
    logs for failed authentication events, and use security software to detect and prevent unauthorized access  
    attempts. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4777 The domain controller failed to validate the credentials of an account&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4777 - The Domain Controller Failed to Validate the Credentials of an Account&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when a domain controller fails to validate the credentials of an account during  
    authentication on a Windows domain. It indicates an authentication failure due to various reasons, such as incorrect 
    credentials or issues with the authentication infrastructure. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4777 is generated when a user or service attempts to authenticate against a domain controller, but the  
    authentication fails due to reasons such as incorrect passwords, disabled accounts, expired credentials, or issues  
    with the domain controller. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;A failed validation of account credentials is not inherently dangerous, but it can indicate potential security  
    threats or issues with the authentication infrastructure. It's essential to investigate the cause of the  
    authentication failure to ensure the security and integrity of the network. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Repeated failed attempts to validate account credentials may indicate an attempted authentication attack, such as 
     brute force attacks or credential stuffing. It's crucial to monitor security logs for patterns of failed  
     authentication attempts and investigate suspicious activities promptly. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may attempt to exploit vulnerabilities in the authentication process to gain unauthorized access to  
    the network or sensitive resources. Detecting and investigating failed authentication events is crucial for  
    identifying and responding to such attacks. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with failed validation of account credentials, ensure proper configuration and  
    maintenance of the authentication infrastructure, enforce strong password policies, regularly review security logs  
    for failed authentication events, and use security software to detect and prevent unauthorized access attempts. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4782 Password hash of an account was accessed&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4782 - Password Hash of an Account Was Accessed&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when the password hash of an account is accessed on a Windows system. Password hashes are 
    cryptographic representations of passwords used for authentication. Accessing password hashes can pose a  
    significant security risk. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4782 is generated when an entity, such as a user or process, accesses the password hash of an account  
    stored on the system. This could occur due to various reasons, including administrative tasks, malicious activities, 
    or security testing .&lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Accessing the password hash of an account is highly dangerous as it can lead to unauthorized access to user  
    accounts and compromise the security of the system. Password hashes can be used in password cracking attacks to  
    obtain plaintext passwords. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Any unauthorized access to password hashes is dangerous and should be treated as a potential security breach.  
    It's crucial to investigate the cause of the access and take immediate action to secure the affected accounts and  
    systems. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may access password hashes to launch password cracking attacks or attempt to gain unauthorized access 
     to user accounts. Detecting and investigating events where password hashes are accessed is crucial for identifying  
     and responding to such attacks. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with the unauthorized access of password hashes, enforce strict access controls,  
    limit access to sensitive information, regularly review security logs for suspicious activities, monitor user and  
    process activities, and use security software to detect and prevent unauthorized access attempts. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4946 A rule was added to the Windows Firewall exception list&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4946 - A Rule Was Added to the Windows Firewall Exception List&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when a new rule is added to the exception list of the Windows Firewall. The Windows  
    Firewall is a security feature that monitors and controls incoming and outgoing network traffic based on predefined  
    rules. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4946 is generated when a user or process adds a new rule to the exception list of the Windows Firewall  
    using the Windows Firewall with Advanced Security console, Group Policy, or programmatically through scripting or  
    programming interfaces.&lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The addition of rules to the Windows Firewall exception list can be dangerous if done without proper  
    authorization or for malicious purposes. It may open up security vulnerabilities, expose sensitive services, or  
    allow unauthorized access to the system. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Adding of rules that allow unrestricted access to critical services or resources, or rules that bypass security  
    controls, is dangerous. It may indicate a security breach, attempt to gain unauthorized access, or compromise system  
    security. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may add rules to the Windows Firewall exception list to allow inbound or outbound traffic for  
    malicious purposes, such as remote access, data exfiltration, or communication with command and control servers.  
    Detecting and investigating firewall rule addition events is crucial for identifying and responding to such  
    attacks. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with unauthorized addition of rules to the Windows Firewall exception list,  
    enforce strict access controls, limit administrative privileges, regularly review security logs for firewall rule  
    addition events, monitor firewall configurations for suspicious changes, and use security software to detect and  
    prevent unauthorized rule additions. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4947 A rule was modified in the Windows Firewall exception list&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4947 - A Rule Was Modified in the Windows Firewall Exception List&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when an existing rule is modified in the exception list of the Windows Firewall. The  
    Windows Firewall is a security feature that monitors and controls incoming and outgoing network traffic based on  
    predefined rules. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4947 is generated when a user or process modifies an existing rule in the exception list of the Windows  
    Firewall using the Windows Firewall with Advanced Security console, Group Policy, or programmatically through  
    scripting or programming interfaces. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The modification of rules in the Windows Firewall exception list can be dangerous if done without proper  
    authorization or for malicious purposes. It may change security settings, expose sensitive services, or allow  
    unauthorized access to the system. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Modifying rules to allow unrestricted access to critical services or resources, or rules that bypass security  
    controls, is dangerous. It may indicate a security breach, attempt to gain unauthorized access, or compromise system 
    security. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may modify rules in the Windows Firewall exception list to allow inbound or outbound traffic for  
    malicious purposes, such as remote access, data exfiltration, or communication with command and control servers.  
    Detecting and investigating firewall rule modification events is crucial for identifying and responding to such  
    attacks. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with unauthorized modification of rules in the Windows Firewall exception list,  
    enforce strict access controls, limit administrative privileges, regularly review security logs for firewall rule  
    modification events, monitor firewall configurations for suspicious changes, and use security software to detect  
    and prevent unauthorized rule modifications. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4950 A setting was changed in Windows Firewall&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4950 - A Setting Was Changed in Windows Firewall&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when a setting is changed in the configuration of the Windows Firewall. The Windows  
    Firewall is a security feature that monitors and controls incoming and outgoing network traffic based on predefined 
    rules and settings. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4950 is generated when a user or process modifies a setting in the configuration of the Windows Firewall 
    using the Windows Firewall with Advanced Security console, Group Policy, or programmatically through scripting or  
    programming interfaces. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The change of settings in the Windows Firewall configuration can be dangerous if done without proper  
    authorization or for malicious purposes. It may alter security policies, expose sensitive services, or allow  
    unauthorized access to the system. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Changing critical settings that affect firewall behavior, such as allowing all inbound or outbound traffic,  
    disabling logging, or turning off firewall protection altogether, is dangerous. It may indicate a security breach,  
    attempt to gain unauthorized access, or compromise system security. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may change settings in the Windows Firewall configuration to weaken security protections, allow  
    inbound or outbound traffic for malicious purposes, or facilitate unauthorized access to the system. Detecting and  
    investigating firewall setting change events is crucial for identifying and responding to such attacks. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with unauthorized changes to settings in the Windows Firewall configuration,  
    enforce strict access controls, limit administrative privileges, regularly review security logs for firewall setting  
    change events, monitor firewall configurations for suspicious changes, and use security software to detect and  
    prevent unauthorized modifications.n&lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4954 Group Policy settings for Windows Firewall has changed&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 4954 - Group Policy Settings for Windows Firewall Has Changed&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when the Group Policy settings for the Windows Firewall have changed. Group Policy is a  
    feature of Windows that allows administrators to manage and enforce settings across multiple computers in an  
    organization. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 4954 is generated when changes are made to the Group Policy settings that affect the configuration of  
    the Windows Firewall, such as adding or removing firewall rules, changing firewall profiles, or modifying other  
    firewall-related settings. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The change in Group Policy settings for the Windows Firewall can be dangerous if done without proper  
    authorization or for malicious purposes. It may alter security policies, expose sensitive services, or allow  
    unauthorized access to the system. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Changes to Group Policy settings that weaken firewall protections, allow inbound or outbound traffic for  
    malicious purposes, or compromise system security are dangerous. It may indicate a security breach, attempt to gain  
    unauthorized access, or compromise system integrity. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may modify Group Policy settings for the Windows Firewall to weaken security protections, allow  
    inbound or outbound traffic for malicious purposes, or facilitate unauthorized access to the system. Detecting and  
    investigating Group Policy setting change events is crucial for identifying and responding to such attacks. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with unauthorized changes to Group Policy settings for the Windows Firewall,  
    enforce strict access controls, limit administrative privileges, regularly review security logs for Group Policy  
    setting change events, monitor Group Policy configurations for suspicious changes, and use security software to  
    detect and prevent unauthorized modifications. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;4964 A special group has been assigned to a new log on&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot;  
    &lt;h1&gt;Event ID 5031 - Windows Firewall Blocked an Application from Accepting Incoming Traffic&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when the Windows Firewall blocks an application from accepting incoming network traffic.  
    The Windows Firewall is a security feature that monitors and controls incoming and outgoing network traffic based on 
    predefined rules and settings.&lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 5031 is generated when the Windows Firewall detects incoming network traffic directed at an application  
    or service and determines that the traffic should be blocked based on its rules and settings.&lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The blocking of incoming traffic by the Windows Firewall is not inherently dangerous, as it is a normal function  
    of the firewall to protect the system from unauthorized access and potential security threats. However, it may  
    indicate attempted unauthorized access or a misconfigured application.&lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Blocking of incoming traffic from legitimate sources or for critical applications or services may pose a danger,  
    as it may disrupt legitimate operations or indicate a misconfiguration or security incident.&lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may attempt to bypass the Windows Firewall by exploiting vulnerabilities in applications or services  
    to accept incoming network traffic. Detecting and investigating Windows Firewall blocking events is crucial for  
    identifying and responding to such attacks.&lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with Windows Firewall blocking legitimate incoming traffic, regularly review and  
    update firewall rules, configure firewall settings to allow necessary traffic, monitor firewall logs for suspicious  
    activity, and use security software to detect and prevent unauthorized access attempts.&lt;/p&gt; 
    &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;5025 The Windows Firewall service has been stopped&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 5025 - The Windows Firewall Service Has Been Stopped&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when the Windows Firewall service is stopped on a Windows system. The Windows Firewall  
    service is responsible for managing the Windows Firewall, which controls incoming and outgoing network traffic  
    based on predefined rules and settings. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 5025 is generated when the Windows Firewall service is stopped manually by a user or as a result of  
    system shutdown or restart. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The stopping of the Windows Firewall service can be dangerous as it leaves the system vulnerable to unauthorized  
    access, malware infections, and other security threats. Without the firewall protection, the system becomes more  
    susceptible to attacks. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Stopping the Windows Firewall service intentionally, especially without proper authorization or in an  
    uncontrolled manner, is dangerous. It may expose the system to network-based attacks, compromise sensitive data, or  
    disrupt system operations. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may stop the Windows Firewall service to bypass firewall protections, facilitate unauthorized access  
    to the system, or execute malicious activities without detection. Detecting and investigating Windows Firewall  
    service stop events is crucial for identifying and responding to such attacks. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with the stopping of the Windows Firewall service, enforce strict access  
    controls, limit administrative privileges, regularly monitor the status of the Windows Firewall service, configure  
    security policies to prevent unauthorized service stoppage, and use security software to detect and prevent  
    unauthorized actions. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;5031 Windows Firewall blocked an application from accepting incoming traffic&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 5031 - Windows Firewall Blocked an Application from Accepting Incoming Traffic&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when the Windows Firewall blocks an application from accepting incoming network traffic.  
    The Windows Firewall is a security feature that monitors and controls incoming and outgoing network traffic based on 
    predefined rules and settings .&lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 5031 is generated when the Windows Firewall detects incoming network traffic directed at an application  
    or service and determines that the traffic should be blocked based on its rules and settings. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The blocking of incoming traffic by the Windows Firewall is not inherently dangerous, as it is a normal function  
    of the firewall to protect the system from unauthorized access and potential security threats. However, it may  
    indicate attempted unauthorized access or a misconfigured application. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Blocking of incoming traffic from legitimate sources or for critical applications or services may pose a danger,  
    as it may disrupt legitimate operations or indicate a misconfiguration or security incident. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may attempt to bypass the Windows Firewall by exploiting vulnerabilities in applications or services  
    to accept incoming network traffic. Detecting and investigating Windows Firewall blocking events is crucial for  
    identifying and responding to such attacks. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with Windows Firewall blocking legitimate incoming traffic, regularly review and  
    update firewall rules, configure firewall settings to allow necessary traffic, monitor firewall logs for suspicious  
    activity, and use security software to detect and prevent unauthorized access attempts. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;5152 A network packet was blocked by Windows Filtering Platform&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 5152 - A Network Packet Was Blocked by Windows Filtering Platform&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when a network packet is blocked by the Windows Filtering Platform (WFP). The WFP is a  
    feature in Windows that provides filtering and inspection of network data based on predefined rules and  
    policies. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 5152 is generated when the WFP detects a network packet that matches a blocking rule in its  
    configuration and prevents it from being transmitted or received by the system. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The blocking of network packets by the WFP is not inherently dangerous, as it is a normal function of the  
    firewall to protect the system from potentially harmful or unauthorized network traffic. However, it may indicate  
    attempted unauthorized access or a misconfiguration. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Blocking of network packets from legitimate sources or for critical services may pose a danger, as it may disrupt 
     legitimate operations or indicate a misconfiguration or security incident. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may attempt to bypass the WFP by exploiting vulnerabilities in applications or services to send or  
    receive network traffic that is blocked by the firewall. Detecting and investigating WFP blocking events is crucial  
    for identifying and responding to such attacks. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with WFP blocking legitimate network packets, regularly review and update  
    firewall rules, configure firewall settings to allow necessary traffic, monitor firewall logs for suspicious  
    activity, and use security software to detect and prevent unauthorized access attempts. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;5153 A network packet was blocked by Windows Filtering Platform&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 5153 - A Network Packet Was Blocked by Windows Filtering Platform&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when a network packet is blocked by the Windows Filtering Platform (WFP). The WFP is a  
    feature in Windows that provides filtering and inspection of network data based on predefined rules and  
    policies. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 5153 is generated when the WFP detects a network packet that matches a blocking rule in its  
    configuration and prevents it from being transmitted or received by the system. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The blocking of network packets by the WFP is not inherently dangerous, as it is a normal function of the  
    firewall to protect the system from potentially harmful or unauthorized network traffic. However, it may indicate  
    attempted unauthorized access or a misconfiguration. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Blocking of network packets from legitimate sources or for critical services may pose a danger, as it may disrupt 
     legitimate operations or indicate a misconfiguration or security incident. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may attempt to bypass the WFP by exploiting vulnerabilities in applications or services to send or  
    receive network traffic that is blocked by the firewall. Detecting and investigating WFP blocking events is crucial  
    for identifying and responding to such attacks. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with WFP blocking legitimate network packets, regularly review and update  
    firewall rules, configure firewall settings to allow necessary traffic, monitor firewall logs for suspicious  
    activity, and use security software to detect and prevent unauthorized access attempts. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;5155 Windows Filtering Platform blocked an application or service from listening on a port&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 5155 - Windows Filtering Platform Blocked an Application or Service from Listening on a Port&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when the Windows Filtering Platform (WFP) blocks an application or service from listening 
    on a port. The WFP is a feature in Windows that provides filtering and inspection of network data based on  
    predefined rules and policies. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 5155 is generated when the WFP detects an attempt by an application or service to listen on a network  
    port and determines that the activity should be blocked based on its rules and settings. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The blocking of applications or services from listening on a port by the WFP is not inherently dangerous, as it  
    is a normal function of the firewall to protect the system from potentially harmful or unauthorized network  
    activity. However, it may indicate attempted unauthorized access or a misconfiguration. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Blocking of applications or services from listening on critical ports may pose a danger, as it may disrupt  
    legitimate operations or indicate a misconfiguration or security incident. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may attempt to bypass the WFP by exploiting vulnerabilities in applications or services to listen on  
    ports that are blocked by the firewall. Detecting and investigating WFP blocking events is crucial for identifying  
    and responding to such attacks. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with WFP blocking applications or services from listening on ports, regularly  
    review and update firewall rules, configure firewall settings to allow necessary network activity, monitor firewall  
    logs for suspicious activity, and use security software to detect and prevent unauthorized access attempts. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;5157 Windows Filtering Platform blocked a connection&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 5157 - Windows Filtering Platform Blocked a Connection&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when the Windows Filtering Platform (WFP) blocks a network connection. The WFP is a  
    feature in Windows that provides filtering and inspection of network data based on predefined rules and  
    policies. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 5157 is generated when the WFP detects an attempt to establish a network connection and determines that  
    the connection should be blocked based on its rules and settings. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The blocking of network connections by the WFP is not inherently dangerous, as it is a normal function of the  
    firewall to protect the system from potentially harmful or unauthorized network activity. However, it may indicate  
    attempted unauthorized access or a misconfiguration. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Blocking of network connections from legitimate sources or for critical services may pose a danger, as it may  
    disrupt legitimate operations or indicate a misconfiguration or security incident. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may attempt to bypass the WFP by exploiting vulnerabilities in applications or services to establish  
    network connections that are blocked by the firewall. Detecting and investigating WFP blocking events is crucial for 
     identifying and responding to such attacks. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with WFP blocking network connections, regularly review and update firewall  
    rules, configure firewall settings to allow necessary network activity, monitor firewall logs for suspicious  
    activity, and use security software to detect and prevent unauthorized access attempts. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;5447 A Windows Filtering Platform filter was changed&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 5447 - A Windows Filtering Platform Filter Was Changed&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when a filter in the Windows Filtering Platform (WFP) is changed. The WFP is a feature in 
    Windows that provides filtering and inspection of network data based on predefined rules and policies. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 5447 is generated when a user or process modifies a filter in the configuration of the WFP. This can  
    include adding, modifying, or removing filters that control network traffic on the system. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The change of a WFP filter can be dangerous if done without proper authorization or for malicious purposes. It  
    may alter security policies, expose sensitive services, or allow unauthorized access to the system. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;Changes to WFP filters that weaken network security protections, allow unauthorized access, or facilitate  
    malicious activities are dangerous. It may indicate a security breach, attempt to gain unauthorized access, or  
    compromise system integrity. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may modify WFP filters to bypass network security protections, allow unauthorized access, or  
    facilitate malicious activities. Detecting and investigating WFP filter change events is crucial for identifying and 
    responding to such attacks. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with unauthorized changes to WFP filters, enforce strict access controls, limit  
    administrative privileges, regularly review security logs for filter change events, monitor WFP configurations for  
    suspicious changes, and use security software to detect and prevent unauthorized modifications. &lt;/p&gt; 
            &quot;&quot;&quot;</span><span class="s3">,</span>

    <span class="s5">&quot;6416 A new external device was recognized by the system&quot;</span><span class="s3">: </span><span class="s5">&quot;&quot;&quot; 
    &lt;h1&gt;Event ID 6416 - A New External Device Was Recognized by the System&lt;/h1&gt; 
    &lt;h2&gt;What Is It?&lt;/h2&gt; 
    &lt;p&gt;This event ID is logged when a new external device is recognized by the system. External devices can include USB  
    drives, external hard drives, printers, cameras, and other peripherals connected to the system. &lt;/p&gt; 
 
    &lt;h2&gt;How It Happens?&lt;/h2&gt; 
    &lt;p&gt;Event ID 6416 is generated when the operating system detects the connection of a new external device and  
    initializes the device for use by the system and applications. &lt;/p&gt; 
 
    &lt;h2&gt;Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The recognition of a new external device by the system is not inherently dangerous, as it is a normal function of 
     the operating system to support the connection and use of external devices. However, it may pose a security risk if 
      the device is untrusted or potentially malicious. &lt;/p&gt; 
 
    &lt;h2&gt;When Is It Dangerous?&lt;/h2&gt; 
    &lt;p&gt;The connection of untrusted or potentially malicious external devices may pose a danger to system security and  
    data integrity. Such devices may contain malware, viruses, or unauthorized data that could compromise the  
    system. &lt;/p&gt; 
 
    &lt;h2&gt;How It Can Be Used in an Attack?&lt;/h2&gt; 
    &lt;p&gt;An attacker may attempt to introduce malware or other malicious software into the system by connecting a  
    compromised external device. Detecting and investigating new external device recognition events is crucial for  
    identifying and responding to such attacks. &lt;/p&gt; 
 
    &lt;h2&gt;How to Stop It?&lt;/h2&gt; 
    &lt;p&gt;To mitigate the risk associated with the connection of untrusted external devices, enforce strict access  
    controls, limit user privileges, use endpoint security solutions to scan and monitor connected devices for threats, 
     and educate users about the risks of connecting untrusted devices to the system.&lt;/p&gt; 
        &quot;&quot;&quot;</span>
<span class="s3">}</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/event_help'</span><span class="s3">, </span><span class="s1">methods</span><span class="s3">=[</span><span class="s5">'GET'</span><span class="s3">, </span><span class="s5">'POST'</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">event_help</span><span class="s3">():</span>
    <span class="s1">logo_url </span><span class="s3">= </span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'static'</span><span class="s3">, </span><span class="s1">filename</span><span class="s3">=</span><span class="s5">'ScanmyLog.png'</span><span class="s3">)</span>
    <span class="s1">selected_description </span><span class="s3">= </span><span class="s5">&quot;&quot;  </span><span class="s0"># Default message or empty string</span>
    <span class="s2">if </span><span class="s1">request</span><span class="s3">.</span><span class="s1">method </span><span class="s3">== </span><span class="s5">'POST'</span><span class="s3">:</span>
        <span class="s1">event_id </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">form</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'eventID'</span><span class="s3">, </span><span class="s5">''</span><span class="s3">)</span>
        <span class="s1">selected_description </span><span class="s3">= </span><span class="s1">event_descriptions</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s1">event_id</span><span class="s3">, </span><span class="s5">&quot;Event ID not found or not detailed here.&quot;</span><span class="s3">)</span>

    <span class="s2">return </span><span class="s1">render_template</span><span class="s3">(</span><span class="s5">'Event Help.html'</span><span class="s3">, </span><span class="s1">event_descriptions</span><span class="s3">=</span><span class="s1">event_descriptions</span><span class="s3">,</span>
                           <span class="s1">logo_url</span><span class="s3">=</span><span class="s1">logo_url</span><span class="s3">, </span><span class="s1">selected_description</span><span class="s3">=</span><span class="s1">selected_description</span><span class="s3">)</span>


<span class="s0"># MongoDB client and database initialization</span>
<span class="s1">client </span><span class="s3">= </span><span class="s1">MongoClient</span><span class="s3">(</span><span class="s5">'mongodb://localhost:27017/'</span><span class="s3">)</span>
<span class="s1">events_db </span><span class="s3">= </span><span class="s1">client</span><span class="s3">[</span><span class="s5">'Client'</span><span class="s3">]  </span><span class="s0"># Database for fetching events</span>
<span class="s1">cases_db </span><span class="s3">= </span><span class="s1">client</span><span class="s3">[</span><span class="s5">'Case'</span><span class="s3">]  </span><span class="s0"># Database for managing cases</span>

<span class="s1">app</span><span class="s3">.</span><span class="s1">config</span><span class="s3">[</span><span class="s5">'MAIL_SERVER'</span><span class="s3">] = </span><span class="s5">'smtp.gmail.com'</span>
<span class="s1">app</span><span class="s3">.</span><span class="s1">config</span><span class="s3">[</span><span class="s5">'MAIL_PORT'</span><span class="s3">] = </span><span class="s4">587</span>
<span class="s1">app</span><span class="s3">.</span><span class="s1">config</span><span class="s3">[</span><span class="s5">'MAIL_USE_TLS'</span><span class="s3">] = </span><span class="s2">True</span>
<span class="s1">app</span><span class="s3">.</span><span class="s1">config</span><span class="s3">[</span><span class="s5">'MAIL_USE_SSL'</span><span class="s3">] = </span><span class="s2">False</span>
<span class="s1">app</span><span class="s3">.</span><span class="s1">config</span><span class="s3">[</span><span class="s5">'MAIL_USERNAME'</span><span class="s3">] = </span><span class="s5">'your_mail'</span>
<span class="s1">app</span><span class="s3">.</span><span class="s1">config</span><span class="s3">[</span><span class="s5">'MAIL_PASSWORD'</span><span class="s3">] = </span><span class="s5">'your_password'</span>
<span class="s1">mail </span><span class="s3">= </span><span class="s1">Mail</span><span class="s3">(</span><span class="s1">app</span><span class="s3">)</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/filter'</span><span class="s3">, </span><span class="s1">methods</span><span class="s3">=[</span><span class="s5">'GET'</span><span class="s3">, </span><span class="s5">'POST'</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">filter</span><span class="s3">():</span>
    <span class="s1">logo_url </span><span class="s3">= </span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'static'</span><span class="s3">, </span><span class="s1">filename</span><span class="s3">=</span><span class="s5">'ScanmyLog.png'</span><span class="s3">)</span>

    <span class="s1">query </span><span class="s3">= {}</span>
    <span class="s2">for </span><span class="s1">key </span><span class="s2">in </span><span class="s1">request</span><span class="s3">.</span><span class="s1">args</span><span class="s3">:</span>
        <span class="s1">value </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">args</span><span class="s3">[</span><span class="s1">key</span><span class="s3">]</span>
        <span class="s2">if </span><span class="s1">value</span><span class="s3">:</span>
            <span class="s2">if </span><span class="s1">key </span><span class="s2">in </span><span class="s3">[</span><span class="s5">&quot;EventIDOccurrences&quot;</span><span class="s3">, </span><span class="s5">&quot;TotalEventsCount&quot;</span><span class="s3">, </span><span class="s5">&quot;EventID&quot;</span><span class="s3">, </span><span class="s5">&quot;IPAddress&quot;</span><span class="s3">]:</span>
                <span class="s2">try</span><span class="s3">:</span>
                    <span class="s1">query</span><span class="s3">[</span><span class="s1">key</span><span class="s3">] = </span><span class="s1">int</span><span class="s3">(</span><span class="s1">value</span><span class="s3">)</span>
                <span class="s2">except </span><span class="s1">ValueError</span><span class="s3">:</span>
                    <span class="s2">continue</span>
            <span class="s2">else</span><span class="s3">:</span>
                <span class="s1">query</span><span class="s3">[</span><span class="s1">key</span><span class="s3">] = {</span><span class="s5">'$regex'</span><span class="s3">: </span><span class="s1">value</span><span class="s3">, </span><span class="s5">'$options'</span><span class="s3">: </span><span class="s5">'i'</span><span class="s3">}</span>

    <span class="s1">events_collection </span><span class="s3">= </span><span class="s1">events_db</span><span class="s3">[</span><span class="s5">'logs'</span><span class="s3">]</span>
    <span class="s1">events </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span><span class="s1">events_collection</span><span class="s3">.</span><span class="s1">find</span><span class="s3">(</span><span class="s1">query</span><span class="s3">))</span>
    <span class="s1">today_date </span><span class="s3">= </span><span class="s1">datetime</span><span class="s3">.</span><span class="s1">now</span><span class="s3">().</span><span class="s1">strftime</span><span class="s3">(</span><span class="s5">'%Y-%m-%d'</span><span class="s3">)</span>
    <span class="s2">return </span><span class="s1">render_template</span><span class="s3">(</span><span class="s5">&quot;Filter.html&quot;</span><span class="s3">, </span><span class="s1">logo_url</span><span class="s3">=</span><span class="s1">logo_url</span><span class="s3">, </span><span class="s1">events</span><span class="s3">=</span><span class="s1">events</span><span class="s3">, </span><span class="s1">today</span><span class="s3">=</span><span class="s1">today_date</span><span class="s3">)</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/save_event'</span><span class="s3">, </span><span class="s1">methods</span><span class="s3">=[</span><span class="s5">'POST'</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">save_event</span><span class="s3">():</span>
    <span class="s2">if not </span><span class="s1">request</span><span class="s3">.</span><span class="s1">json</span><span class="s3">:</span>
        <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">({</span><span class="s5">&quot;error&quot;</span><span class="s3">: </span><span class="s5">&quot;Request must be JSON&quot;</span><span class="s3">}), </span><span class="s4">400</span>

    <span class="s0"># Extract data from the JSON request</span>
    <span class="s1">data </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">json</span>
    <span class="s1">print</span><span class="s3">(</span><span class="s5">&quot;Received data:&quot;</span><span class="s3">, </span><span class="s1">data</span><span class="s3">)  </span><span class="s0"># Debugging line</span>

    <span class="s1">event_name </span><span class="s3">= </span><span class="s1">data</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'eventName'</span><span class="s3">)  </span><span class="s0"># Use 'eventName' to determine the collection name</span>
    <span class="s1">print</span><span class="s3">(</span><span class="s5">&quot;Event Name (Collection Name):&quot;</span><span class="s3">, </span><span class="s1">event_name</span><span class="s3">)  </span><span class="s0"># Debugging line</span>

    <span class="s2">if not </span><span class="s1">event_name</span><span class="s3">:</span>
        <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">({</span><span class="s5">&quot;error&quot;</span><span class="s3">: </span><span class="s5">&quot;Event name is missing&quot;</span><span class="s3">}), </span><span class="s4">400</span>

    <span class="s0"># Convert event name to a valid MongoDB collection name, if necessary</span>
    <span class="s1">collection_name </span><span class="s3">= </span><span class="s5">''</span><span class="s3">.</span><span class="s1">join</span><span class="s3">(</span><span class="s1">e </span><span class="s2">for </span><span class="s1">e </span><span class="s2">in </span><span class="s1">event_name </span><span class="s2">if </span><span class="s1">e</span><span class="s3">.</span><span class="s1">isalnum</span><span class="s3">()).</span><span class="s1">lower</span><span class="s3">()</span>
    <span class="s1">print</span><span class="s3">(</span><span class="s5">&quot;Formatted Collection Name:&quot;</span><span class="s3">, </span><span class="s1">collection_name</span><span class="s3">)  </span><span class="s0"># Debugging line</span>

    <span class="s1">event_data </span><span class="s3">= {</span>
        <span class="s5">&quot;eventID&quot;</span><span class="s3">: </span><span class="s1">data</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'eventID'</span><span class="s3">),</span>
        <span class="s5">&quot;machineName&quot;</span><span class="s3">: </span><span class="s1">data</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'machineName'</span><span class="s3">),</span>
        <span class="s5">&quot;timeCreated&quot;</span><span class="s3">: </span><span class="s1">datetime</span><span class="s3">.</span><span class="s1">strptime</span><span class="s3">(</span><span class="s1">data</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'timeCreated'</span><span class="s3">), </span><span class="s5">&quot;%Y-%m-%d %H:%M:%S&quot;</span><span class="s3">),</span>
        <span class="s5">&quot;eventName&quot;</span><span class="s3">: </span><span class="s1">event_name</span><span class="s3">,</span>
        <span class="s5">&quot;description&quot;</span><span class="s3">: </span><span class="s1">data</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'description'</span><span class="s3">)</span>
    <span class="s3">}</span>

    <span class="s0"># Access the specified collection in the 'cases_db' database</span>
    <span class="s1">collection </span><span class="s3">= </span><span class="s1">cases_db</span><span class="s3">[</span><span class="s1">collection_name</span><span class="s3">]</span>
    <span class="s1">print</span><span class="s3">(</span><span class="s5">&quot;Using Collection:&quot;</span><span class="s3">, </span><span class="s1">collection</span><span class="s3">)  </span><span class="s0"># Debugging line</span>

    <span class="s0"># Insert the event data into the collection</span>
    <span class="s1">insert_result </span><span class="s3">= </span><span class="s1">collection</span><span class="s3">.</span><span class="s1">insert_one</span><span class="s3">(</span><span class="s1">event_data</span><span class="s3">)</span>
    <span class="s2">if </span><span class="s1">insert_result</span><span class="s3">.</span><span class="s1">inserted_id</span><span class="s3">:</span>
        <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">({</span><span class="s5">&quot;success&quot;</span><span class="s3">: </span><span class="s2">True</span><span class="s3">, </span><span class="s5">&quot;message&quot;</span><span class="s3">: </span><span class="s5">&quot;Event saved successfully&quot;</span><span class="s3">}), </span><span class="s4">200</span>
    <span class="s2">else</span><span class="s3">:</span>
        <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">({</span><span class="s5">&quot;error&quot;</span><span class="s3">: </span><span class="s5">&quot;Failed to save event&quot;</span><span class="s3">}), </span><span class="s4">500</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/send_csv'</span><span class="s3">, </span><span class="s1">methods</span><span class="s3">=[</span><span class="s5">'POST'</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">send_csv</span><span class="s3">():</span>
    <span class="s1">recipient_email </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">form</span><span class="s3">[</span><span class="s5">'email'</span><span class="s3">]</span>
    <span class="s1">output </span><span class="s3">= </span><span class="s1">io</span><span class="s3">.</span><span class="s1">StringIO</span><span class="s3">()</span>
    <span class="s1">writer </span><span class="s3">= </span><span class="s1">csv</span><span class="s3">.</span><span class="s1">writer</span><span class="s3">(</span><span class="s1">output</span><span class="s3">)</span>

    <span class="s0"># Define columns and fetch data from the database as before</span>
    <span class="s1">columns </span><span class="s3">= [</span><span class="s5">&quot;EventID&quot;</span><span class="s3">, </span><span class="s5">&quot;TimeCreated&quot;</span><span class="s3">, </span><span class="s5">&quot;Severity&quot;</span><span class="s3">, </span><span class="s5">&quot;Message&quot;</span><span class="s3">, </span><span class="s5">&quot;IPAddress&quot;</span><span class="s3">, </span><span class="s5">&quot;MachineName&quot;</span><span class="s3">, </span><span class="s5">&quot;LogName&quot;</span><span class="s3">,</span>
               <span class="s5">&quot;EventIDOccurrences&quot;</span><span class="s3">, </span><span class="s5">&quot;TotalEventsCount&quot;</span><span class="s3">, </span><span class="s5">&quot;Level&quot;</span><span class="s3">]</span>
    <span class="s1">writer</span><span class="s3">.</span><span class="s1">writerow</span><span class="s3">(</span><span class="s1">columns</span><span class="s3">)</span>

    <span class="s1">events_collection </span><span class="s3">= </span><span class="s1">events_db</span><span class="s3">[</span><span class="s5">'logs'</span><span class="s3">]</span>
    <span class="s1">events </span><span class="s3">= </span><span class="s1">events_collection</span><span class="s3">.</span><span class="s1">find</span><span class="s3">({})  </span><span class="s0"># Adapt this line to use any filtering if necessary</span>
    <span class="s2">for </span><span class="s1">event </span><span class="s2">in </span><span class="s1">events</span><span class="s3">:</span>
        <span class="s1">writer</span><span class="s3">.</span><span class="s1">writerow</span><span class="s3">([</span><span class="s1">event</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s1">column</span><span class="s3">, </span><span class="s5">&quot;&quot;</span><span class="s3">) </span><span class="s2">for </span><span class="s1">column </span><span class="s2">in </span><span class="s1">columns</span><span class="s3">])</span>

    <span class="s1">output</span><span class="s3">.</span><span class="s1">seek</span><span class="s3">(</span><span class="s4">0</span><span class="s3">)</span>
    <span class="s1">csv_data </span><span class="s3">= </span><span class="s1">output</span><span class="s3">.</span><span class="s1">getvalue</span><span class="s3">()</span>
    <span class="s1">output</span><span class="s3">.</span><span class="s1">close</span><span class="s3">()</span>

    <span class="s0"># Construct and send the email</span>
    <span class="s1">msg </span><span class="s3">= </span><span class="s1">Message</span><span class="s3">(</span><span class="s5">&quot;Events Table CSV&quot;</span><span class="s3">,</span>
                  <span class="s1">sender</span><span class="s3">=</span><span class="s5">&quot;norepleyscannerly@gmail.com&quot;</span><span class="s3">,  </span><span class="s0"># Use the same email as MAIL_USERNAME</span>
                  <span class="s1">recipients</span><span class="s3">=[</span><span class="s1">recipient_email</span><span class="s3">])</span>
    <span class="s1">msg</span><span class="s3">.</span><span class="s1">body </span><span class="s3">= </span><span class="s5">&quot;Please find attached the events table.&quot;</span>
    <span class="s1">msg</span><span class="s3">.</span><span class="s1">attach</span><span class="s3">(</span><span class="s5">&quot;events_table.csv&quot;</span><span class="s3">, </span><span class="s5">&quot;text/csv&quot;</span><span class="s3">, </span><span class="s1">csv_data</span><span class="s3">)</span>

    <span class="s2">try</span><span class="s3">:</span>
        <span class="s1">mail</span><span class="s3">.</span><span class="s1">send</span><span class="s3">(</span><span class="s1">msg</span><span class="s3">)</span>
        <span class="s1">flash</span><span class="s3">(</span><span class="s5">'Email sent successfully!'</span><span class="s3">, </span><span class="s5">'success'</span><span class="s3">)</span>
    <span class="s2">except </span><span class="s1">Exception </span><span class="s2">as </span><span class="s1">e</span><span class="s3">:</span>
        <span class="s1">flash</span><span class="s3">(</span><span class="s5">'Email sending failed. ' </span><span class="s3">+ </span><span class="s1">str</span><span class="s3">(</span><span class="s1">e</span><span class="s3">), </span><span class="s5">'error'</span><span class="s3">)</span>

    <span class="s2">return </span><span class="s1">redirect</span><span class="s3">(</span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'home'</span><span class="s3">))  </span><span class="s0"># Redirect to home or any other page</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/download_csv'</span><span class="s3">)</span>
<span class="s2">def </span><span class="s1">download_csv</span><span class="s3">():</span>
    <span class="s1">output </span><span class="s3">= </span><span class="s1">io</span><span class="s3">.</span><span class="s1">StringIO</span><span class="s3">()</span>
    <span class="s1">writer </span><span class="s3">= </span><span class="s1">csv</span><span class="s3">.</span><span class="s1">writer</span><span class="s3">(</span><span class="s1">output</span><span class="s3">)</span>

    <span class="s1">query </span><span class="s3">= {}</span>
    <span class="s2">for </span><span class="s1">key </span><span class="s2">in </span><span class="s1">request</span><span class="s3">.</span><span class="s1">args</span><span class="s3">:</span>
        <span class="s1">value </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">args</span><span class="s3">[</span><span class="s1">key</span><span class="s3">]</span>
        <span class="s2">if </span><span class="s1">value</span><span class="s3">:</span>
            <span class="s2">if </span><span class="s1">key </span><span class="s2">in </span><span class="s3">[</span><span class="s5">&quot;EventIDOccurrences&quot;</span><span class="s3">, </span><span class="s5">&quot;TotalEventsCount&quot;</span><span class="s3">]:</span>
                <span class="s2">try</span><span class="s3">:</span>
                    <span class="s1">query</span><span class="s3">[</span><span class="s1">key</span><span class="s3">] = </span><span class="s1">int</span><span class="s3">(</span><span class="s1">value</span><span class="s3">)</span>
                <span class="s2">except </span><span class="s1">ValueError</span><span class="s3">:</span>
                    <span class="s2">continue</span>
            <span class="s2">else</span><span class="s3">:</span>
                <span class="s1">query</span><span class="s3">[</span><span class="s1">key</span><span class="s3">] = {</span><span class="s5">'$regex'</span><span class="s3">: </span><span class="s1">value</span><span class="s3">, </span><span class="s5">'$options'</span><span class="s3">: </span><span class="s5">'i'</span><span class="s3">}</span>

    <span class="s0"># Define your columns</span>
    <span class="s1">columns </span><span class="s3">= [</span><span class="s5">&quot;EventID&quot;</span><span class="s3">, </span><span class="s5">&quot;TimeCreated&quot;</span><span class="s3">, </span><span class="s5">&quot;Severity&quot;</span><span class="s3">, </span><span class="s5">&quot;Message&quot;</span><span class="s3">, </span><span class="s5">&quot;IPAddress&quot;</span><span class="s3">, </span><span class="s5">&quot;MachineName&quot;</span><span class="s3">, </span><span class="s5">&quot;LogName&quot;</span><span class="s3">,</span>
               <span class="s5">&quot;EventIDOccurrences&quot;</span><span class="s3">, </span><span class="s5">&quot;TotalEventsCount&quot;</span><span class="s3">, </span><span class="s5">&quot;Level&quot;</span><span class="s3">]</span>
    <span class="s1">writer</span><span class="s3">.</span><span class="s1">writerow</span><span class="s3">(</span><span class="s1">columns</span><span class="s3">)</span>

    <span class="s1">events_collection </span><span class="s3">= </span><span class="s1">events_db</span><span class="s3">[</span><span class="s5">'logs'</span><span class="s3">]</span>
    <span class="s1">events </span><span class="s3">= </span><span class="s1">events_collection</span><span class="s3">.</span><span class="s1">find</span><span class="s3">(</span><span class="s1">query</span><span class="s3">)</span>
    <span class="s2">for </span><span class="s1">event </span><span class="s2">in </span><span class="s1">events</span><span class="s3">:</span>
        <span class="s1">writer</span><span class="s3">.</span><span class="s1">writerow</span><span class="s3">([</span><span class="s1">event</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s1">column</span><span class="s3">, </span><span class="s5">&quot;&quot;</span><span class="s3">) </span><span class="s2">for </span><span class="s1">column </span><span class="s2">in </span><span class="s1">columns</span><span class="s3">])</span>

    <span class="s1">output</span><span class="s3">.</span><span class="s1">seek</span><span class="s3">(</span><span class="s4">0</span><span class="s3">)</span>

    <span class="s2">return </span><span class="s1">Response</span><span class="s3">(</span>
        <span class="s1">output</span><span class="s3">,</span>
        <span class="s1">mimetype</span><span class="s3">=</span><span class="s5">&quot;text/csv&quot;</span><span class="s3">,</span>
        <span class="s1">headers</span><span class="s3">={</span><span class="s5">&quot;Content-Disposition&quot;</span><span class="s3">: </span><span class="s5">&quot;attachment;filename=events_table.csv&quot;</span><span class="s3">}</span>
    <span class="s3">)</span>


<span class="s0"># MongoDB connection details</span>
<span class="s1">mongo_connection_string </span><span class="s3">= </span><span class="s5">&quot;mongodb://localhost:27017&quot;</span>
<span class="s1">database_name </span><span class="s3">= </span><span class="s5">&quot;Client&quot;</span>
<span class="s1">collection_name </span><span class="s3">= </span><span class="s5">&quot;logs&quot;</span>
<span class="s1">anomalies_collection_name </span><span class="s3">= </span><span class="s5">&quot;anomalies&quot;  </span><span class="s0"># Name of the collection to store anomalies</span>

<span class="s1">client </span><span class="s3">= </span><span class="s1">MongoClient</span><span class="s3">(</span><span class="s1">mongo_connection_string</span><span class="s3">)</span>
<span class="s1">db </span><span class="s3">= </span><span class="s1">client</span><span class="s3">[</span><span class="s1">database_name</span><span class="s3">]</span>
<span class="s1">collection </span><span class="s3">= </span><span class="s1">db</span><span class="s3">[</span><span class="s1">collection_name</span><span class="s3">]</span>

<span class="s0"># Fetch events</span>
<span class="s1">events </span><span class="s3">= </span><span class="s1">collection</span><span class="s3">.</span><span class="s1">find</span><span class="s3">()</span>

<span class="s0"># Convert to DataFrame for easier manipulation</span>
<span class="s1">df </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">list</span><span class="s3">(</span><span class="s1">events</span><span class="s3">))</span>

<span class="s0"># Convert 'TimeCreated' from UNIX timestamp to datetime for numerical processing</span>
<span class="s1">df</span><span class="s3">[</span><span class="s5">'TimeCreated'</span><span class="s3">] = </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">to_datetime</span><span class="s3">(</span><span class="s1">df</span><span class="s3">[</span><span class="s5">'TimeCreated'</span><span class="s3">]).</span><span class="s1">astype</span><span class="s3">(</span><span class="s5">'int64'</span><span class="s3">) // </span><span class="s4">10</span><span class="s3">**</span><span class="s4">9</span>

<span class="s0"># Assuming 'EventIDOccurrences' and 'TotalEventsCount' are numerical</span>
<span class="s0"># Assuming 'Severity', if not already numerical, is mapped to numerical values</span>

<span class="s0"># Define the features for modeling</span>
<span class="s1">numerical_features </span><span class="s3">= [</span><span class="s5">'EventIDOccurrences'</span><span class="s3">]  </span><span class="s0"># Include only 'EventIDOccurrences' as a numerical feature</span>
<span class="s1">categorical_features </span><span class="s3">= [</span><span class="s5">'EventID'</span><span class="s3">]  </span><span class="s0"># 'EventID' is considered a categorical feature and needs encoding</span>

<span class="s0"># Prepare features with ColumnTransformer for scaling</span>
<span class="s1">ct </span><span class="s3">= </span><span class="s1">ColumnTransformer</span><span class="s3">([</span>
    <span class="s3">(</span><span class="s5">'scale'</span><span class="s3">, </span><span class="s1">StandardScaler</span><span class="s3">(), </span><span class="s1">numerical_features</span><span class="s3">),</span>
    <span class="s3">(</span><span class="s5">'encode'</span><span class="s3">, </span><span class="s1">OneHotEncoder</span><span class="s3">(), </span><span class="s1">categorical_features</span><span class="s3">)</span>
<span class="s3">])</span>

<span class="s0"># Apply ColumnTransformer to your features</span>
<span class="s1">prepared_features </span><span class="s3">= </span><span class="s1">numerical_features </span><span class="s3">+ </span><span class="s1">categorical_features  </span><span class="s0"># This is necessary for properly referencing features</span>
<span class="s1">X_transformed </span><span class="s3">= </span><span class="s1">ct</span><span class="s3">.</span><span class="s1">fit_transform</span><span class="s3">(</span><span class="s1">df</span><span class="s3">[</span><span class="s1">prepared_features</span><span class="s3">])</span>

<span class="s0"># Train an Isolation Forest model for anomaly detection</span>
<span class="s1">model </span><span class="s3">= </span><span class="s1">IsolationForest</span><span class="s3">(</span><span class="s1">n_estimators</span><span class="s3">=</span><span class="s4">100</span><span class="s3">, </span><span class="s1">contamination</span><span class="s3">=</span><span class="s5">'auto'</span><span class="s3">, </span><span class="s1">random_state</span><span class="s3">=</span><span class="s4">42</span><span class="s3">)</span>
<span class="s1">model</span><span class="s3">.</span><span class="s1">fit</span><span class="s3">(</span><span class="s1">X_transformed</span><span class="s3">)</span>

<span class="s0"># Predicting anomalies</span>
<span class="s1">df</span><span class="s3">[</span><span class="s5">'anomaly'</span><span class="s3">] = </span><span class="s1">model</span><span class="s3">.</span><span class="s1">predict</span><span class="s3">(</span><span class="s1">X_transformed</span><span class="s3">)</span>

<span class="s1">anomalous_data </span><span class="s3">= </span><span class="s1">df</span><span class="s3">[</span><span class="s1">df</span><span class="s3">[</span><span class="s5">'anomaly'</span><span class="s3">] == -</span><span class="s4">1</span><span class="s3">].</span><span class="s1">copy</span><span class="s3">()</span>
<span class="s1">anomalous_data</span><span class="s3">[</span><span class="s5">'TimeCreated'</span><span class="s3">] = </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">to_datetime</span><span class="s3">(</span><span class="s1">anomalous_data</span><span class="s3">[</span><span class="s5">'TimeCreated'</span><span class="s3">], </span><span class="s1">unit</span><span class="s3">=</span><span class="s5">'s'</span><span class="s3">)</span>

<span class="s0"># Prepare the anomalies data for MongoDB insertion</span>
<span class="s1">anomalies_list </span><span class="s3">= </span><span class="s1">anomalous_data</span><span class="s3">.</span><span class="s1">drop</span><span class="s3">(</span><span class="s1">columns</span><span class="s3">=[</span><span class="s5">'_id'</span><span class="s3">]).</span><span class="s1">to_dict</span><span class="s3">(</span><span class="s5">'records'</span><span class="s3">)  </span><span class="s0"># Remove '_id' if present</span>

<span class="s0"># Save detected anomalies to MongoDB</span>
<span class="s1">anomalies_collection </span><span class="s3">= </span><span class="s1">db</span><span class="s3">[</span><span class="s1">anomalies_collection_name</span><span class="s3">]</span>
<span class="s1">anomalies_collection</span><span class="s3">.</span><span class="s1">insert_many</span><span class="s3">(</span><span class="s1">anomalies_list</span><span class="s3">)</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/ueba'</span><span class="s3">)</span>
<span class="s2">def </span><span class="s1">ueba</span><span class="s3">():</span>
    <span class="s1">logo_url </span><span class="s3">= </span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'static'</span><span class="s3">, </span><span class="s1">filename</span><span class="s3">=</span><span class="s5">'ScanmyLog.png'</span><span class="s3">)</span>
    <span class="s0"># Fetch anomalies from the MongoDB collection</span>
    <span class="s1">anomalies_list </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span><span class="s1">anomalies_collection</span><span class="s3">.</span><span class="s1">find</span><span class="s3">({}, {</span><span class="s5">'_id'</span><span class="s3">: </span><span class="s4">0</span><span class="s3">}))</span>

    <span class="s0"># Format 'TimeCreated' as a string for display</span>
    <span class="s2">for </span><span class="s1">anomaly </span><span class="s2">in </span><span class="s1">anomalies_list</span><span class="s3">:</span>
        <span class="s0"># Check if 'TimeCreated' is a datetime object and format it</span>
        <span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">anomaly</span><span class="s3">[</span><span class="s5">'TimeCreated'</span><span class="s3">], </span><span class="s1">datetime</span><span class="s3">):</span>
            <span class="s1">anomaly</span><span class="s3">[</span><span class="s5">'TimeCreated'</span><span class="s3">] = </span><span class="s1">anomaly</span><span class="s3">[</span><span class="s5">'TimeCreated'</span><span class="s3">].</span><span class="s1">strftime</span><span class="s3">(</span><span class="s5">'%Y-%m-%d %H:%M:%S'</span><span class="s3">)</span>

    <span class="s2">return </span><span class="s1">render_template</span><span class="s3">(</span><span class="s5">'UEBA.html'</span><span class="s3">, </span><span class="s1">anomalies</span><span class="s3">=</span><span class="s1">anomalies_list</span><span class="s3">, </span><span class="s1">logo_url</span><span class="s3">=</span><span class="s1">logo_url</span><span class="s3">)</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/save_anomoly'</span><span class="s3">, </span><span class="s1">methods</span><span class="s3">=[</span><span class="s5">'POST'</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">save_anomoly</span><span class="s3">():</span>
    <span class="s2">if not </span><span class="s1">request</span><span class="s3">.</span><span class="s1">json</span><span class="s3">:</span>
        <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">({</span><span class="s5">&quot;error&quot;</span><span class="s3">: </span><span class="s5">&quot;Request must be JSON&quot;</span><span class="s3">}), </span><span class="s4">400</span>

    <span class="s0"># Extract data from the JSON request</span>
    <span class="s1">data </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">json</span>
    <span class="s1">print</span><span class="s3">(</span><span class="s5">&quot;Received data:&quot;</span><span class="s3">, </span><span class="s1">data</span><span class="s3">)  </span><span class="s0"># Debugging line</span>

    <span class="s1">event_name </span><span class="s3">= </span><span class="s1">data</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'eventName'</span><span class="s3">)  </span><span class="s0"># Use 'eventName' to determine the collection name</span>
    <span class="s1">print</span><span class="s3">(</span><span class="s5">&quot;Event Name (Collection Name):&quot;</span><span class="s3">, </span><span class="s1">event_name</span><span class="s3">)  </span><span class="s0"># Debugging line</span>

    <span class="s2">if not </span><span class="s1">event_name</span><span class="s3">:</span>
        <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">({</span><span class="s5">&quot;error&quot;</span><span class="s3">: </span><span class="s5">&quot;Event name is missing&quot;</span><span class="s3">}), </span><span class="s4">400</span>

    <span class="s0"># Convert event name to a valid MongoDB collection name, if necessary</span>
    <span class="s1">collection_name </span><span class="s3">= </span><span class="s5">''</span><span class="s3">.</span><span class="s1">join</span><span class="s3">(</span><span class="s1">e </span><span class="s2">for </span><span class="s1">e </span><span class="s2">in </span><span class="s1">event_name </span><span class="s2">if </span><span class="s1">e</span><span class="s3">.</span><span class="s1">isalnum</span><span class="s3">()).</span><span class="s1">lower</span><span class="s3">()</span>
    <span class="s1">print</span><span class="s3">(</span><span class="s5">&quot;Formatted Collection Name:&quot;</span><span class="s3">, </span><span class="s1">collection_name</span><span class="s3">)  </span><span class="s0"># Debugging line</span>

    <span class="s1">anamoly_data </span><span class="s3">= {</span>
        <span class="s5">&quot;eventID&quot;</span><span class="s3">: </span><span class="s1">data</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'eventID'</span><span class="s3">),</span>
        <span class="s5">&quot;machineName&quot;</span><span class="s3">: </span><span class="s1">data</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'machineName'</span><span class="s3">),</span>
        <span class="s5">&quot;timeCreated&quot;</span><span class="s3">: </span><span class="s1">datetime</span><span class="s3">.</span><span class="s1">strptime</span><span class="s3">(</span><span class="s1">data</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'timeCreated'</span><span class="s3">), </span><span class="s5">&quot;%Y-%m-%d %H:%M:%S&quot;</span><span class="s3">),</span>
        <span class="s5">&quot;eventName&quot;</span><span class="s3">: </span><span class="s1">event_name</span><span class="s3">,</span>
        <span class="s5">&quot;description&quot;</span><span class="s3">: </span><span class="s1">data</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'description'</span><span class="s3">)</span>
    <span class="s3">}</span>

    <span class="s0"># Access the specified collection in the 'cases_db' database</span>
    <span class="s1">collection </span><span class="s3">= </span><span class="s1">cases_db</span><span class="s3">[</span><span class="s1">collection_name</span><span class="s3">]</span>
    <span class="s1">print</span><span class="s3">(</span><span class="s5">&quot;Using Collection:&quot;</span><span class="s3">, </span><span class="s1">collection</span><span class="s3">)  </span><span class="s0"># Debugging line</span>

    <span class="s0"># Insert the event data into the collection</span>
    <span class="s1">insert_result </span><span class="s3">= </span><span class="s1">collection</span><span class="s3">.</span><span class="s1">insert_one</span><span class="s3">(</span><span class="s1">anamoly_data</span><span class="s3">)</span>
    <span class="s2">if </span><span class="s1">insert_result</span><span class="s3">.</span><span class="s1">inserted_id</span><span class="s3">:</span>
        <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">({</span><span class="s5">&quot;success&quot;</span><span class="s3">: </span><span class="s2">True</span><span class="s3">, </span><span class="s5">&quot;message&quot;</span><span class="s3">: </span><span class="s5">&quot;Event saved successfully&quot;</span><span class="s3">}), </span><span class="s4">200</span>
    <span class="s2">else</span><span class="s3">:</span>
        <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">({</span><span class="s5">&quot;error&quot;</span><span class="s3">: </span><span class="s5">&quot;Failed to save event&quot;</span><span class="s3">}), </span><span class="s4">500</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/send_csv_anomaly'</span><span class="s3">, </span><span class="s1">methods</span><span class="s3">=[</span><span class="s5">'POST'</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">send_csv_anomaly</span><span class="s3">():</span>
    <span class="s1">recipient_email </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">form</span><span class="s3">[</span><span class="s5">'email'</span><span class="s3">]</span>
    <span class="s1">output </span><span class="s3">= </span><span class="s1">io</span><span class="s3">.</span><span class="s1">StringIO</span><span class="s3">()</span>
    <span class="s1">writer </span><span class="s3">= </span><span class="s1">csv</span><span class="s3">.</span><span class="s1">writer</span><span class="s3">(</span><span class="s1">output</span><span class="s3">)</span>

    <span class="s0"># Define columns and fetch data from the database as before</span>
    <span class="s1">columns </span><span class="s3">= [</span><span class="s5">&quot;EventID&quot;</span><span class="s3">, </span><span class="s5">&quot;TimeCreated&quot;</span><span class="s3">, </span><span class="s5">&quot;Severity&quot;</span><span class="s3">, </span><span class="s5">&quot;Message&quot;</span><span class="s3">, </span><span class="s5">&quot;IPAddress&quot;</span><span class="s3">, </span><span class="s5">&quot;MachineName&quot;</span><span class="s3">, </span><span class="s5">&quot;LogName&quot;</span><span class="s3">,</span>
               <span class="s5">&quot;EventIDOccurrences&quot;</span><span class="s3">, </span><span class="s5">&quot;TotalEventsCount&quot;</span><span class="s3">, </span><span class="s5">&quot;Level&quot;</span><span class="s3">]</span>
    <span class="s1">writer</span><span class="s3">.</span><span class="s1">writerow</span><span class="s3">(</span><span class="s1">columns</span><span class="s3">)</span>

    <span class="s1">events_collection </span><span class="s3">= </span><span class="s1">events_db</span><span class="s3">[</span><span class="s5">'logs'</span><span class="s3">]</span>
    <span class="s1">events </span><span class="s3">= </span><span class="s1">events_collection</span><span class="s3">.</span><span class="s1">find</span><span class="s3">({})  </span><span class="s0"># Adapt this line to use any filtering if necessary</span>
    <span class="s2">for </span><span class="s1">event </span><span class="s2">in </span><span class="s1">events</span><span class="s3">:</span>
        <span class="s1">writer</span><span class="s3">.</span><span class="s1">writerow</span><span class="s3">([</span><span class="s1">event</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s1">column</span><span class="s3">, </span><span class="s5">&quot;&quot;</span><span class="s3">) </span><span class="s2">for </span><span class="s1">column </span><span class="s2">in </span><span class="s1">columns</span><span class="s3">])</span>

    <span class="s1">output</span><span class="s3">.</span><span class="s1">seek</span><span class="s3">(</span><span class="s4">0</span><span class="s3">)</span>
    <span class="s1">csv_data </span><span class="s3">= </span><span class="s1">output</span><span class="s3">.</span><span class="s1">getvalue</span><span class="s3">()</span>
    <span class="s1">output</span><span class="s3">.</span><span class="s1">close</span><span class="s3">()</span>

    <span class="s0"># Construct and send the email</span>
    <span class="s1">msg </span><span class="s3">= </span><span class="s1">Message</span><span class="s3">(</span><span class="s5">&quot;Events Table CSV&quot;</span><span class="s3">,</span>
                  <span class="s1">sender</span><span class="s3">=</span><span class="s5">&quot;norepleyscannerly@gmail.com&quot;</span><span class="s3">,  </span><span class="s0"># Use the same email as MAIL_USERNAME</span>
                  <span class="s1">recipients</span><span class="s3">=[</span><span class="s1">recipient_email</span><span class="s3">])</span>
    <span class="s1">msg</span><span class="s3">.</span><span class="s1">body </span><span class="s3">= </span><span class="s5">&quot;Please find attached the events table.&quot;</span>
    <span class="s1">msg</span><span class="s3">.</span><span class="s1">attach</span><span class="s3">(</span><span class="s5">&quot;events_table.csv&quot;</span><span class="s3">, </span><span class="s5">&quot;text/csv&quot;</span><span class="s3">, </span><span class="s1">csv_data</span><span class="s3">)</span>

    <span class="s2">try</span><span class="s3">:</span>
        <span class="s1">mail</span><span class="s3">.</span><span class="s1">send</span><span class="s3">(</span><span class="s1">msg</span><span class="s3">)</span>
        <span class="s1">flash</span><span class="s3">(</span><span class="s5">'Email sent successfully!'</span><span class="s3">, </span><span class="s5">'success'</span><span class="s3">)</span>
    <span class="s2">except </span><span class="s1">Exception </span><span class="s2">as </span><span class="s1">e</span><span class="s3">:</span>
        <span class="s1">flash</span><span class="s3">(</span><span class="s5">'Email sending failed. ' </span><span class="s3">+ </span><span class="s1">str</span><span class="s3">(</span><span class="s1">e</span><span class="s3">), </span><span class="s5">'error'</span><span class="s3">)</span>

    <span class="s2">return </span><span class="s1">redirect</span><span class="s3">(</span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'home'</span><span class="s3">))  </span><span class="s0"># Redirect to home or any other page</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/download_csv_anomaly'</span><span class="s3">)</span>
<span class="s2">def </span><span class="s1">download_csv_anomaly</span><span class="s3">():</span>
    <span class="s1">output </span><span class="s3">= </span><span class="s1">io</span><span class="s3">.</span><span class="s1">StringIO</span><span class="s3">()</span>
    <span class="s1">writer </span><span class="s3">= </span><span class="s1">csv</span><span class="s3">.</span><span class="s1">writer</span><span class="s3">(</span><span class="s1">output</span><span class="s3">)</span>

    <span class="s1">query </span><span class="s3">= {}</span>
    <span class="s2">for </span><span class="s1">key </span><span class="s2">in </span><span class="s1">request</span><span class="s3">.</span><span class="s1">args</span><span class="s3">:</span>
        <span class="s1">value </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">args</span><span class="s3">[</span><span class="s1">key</span><span class="s3">]</span>
        <span class="s2">if </span><span class="s1">value</span><span class="s3">:</span>
            <span class="s2">if </span><span class="s1">key </span><span class="s2">in </span><span class="s3">[</span><span class="s5">&quot;EventIDOccurrences&quot;</span><span class="s3">, </span><span class="s5">&quot;TotalEventsCount&quot;</span><span class="s3">]:</span>
                <span class="s2">try</span><span class="s3">:</span>
                    <span class="s1">query</span><span class="s3">[</span><span class="s1">key</span><span class="s3">] = </span><span class="s1">int</span><span class="s3">(</span><span class="s1">value</span><span class="s3">)</span>
                <span class="s2">except </span><span class="s1">ValueError</span><span class="s3">:</span>
                    <span class="s2">continue</span>
            <span class="s2">else</span><span class="s3">:</span>
                <span class="s1">query</span><span class="s3">[</span><span class="s1">key</span><span class="s3">] = {</span><span class="s5">'$regex'</span><span class="s3">: </span><span class="s1">value</span><span class="s3">, </span><span class="s5">'$options'</span><span class="s3">: </span><span class="s5">'i'</span><span class="s3">}</span>

    <span class="s0"># Define your columns</span>
    <span class="s1">columns </span><span class="s3">= [</span><span class="s5">&quot;EventID&quot;</span><span class="s3">, </span><span class="s5">&quot;TimeCreated&quot;</span><span class="s3">, </span><span class="s5">&quot;Severity&quot;</span><span class="s3">, </span><span class="s5">&quot;Message&quot;</span><span class="s3">, </span><span class="s5">&quot;IPAddress&quot;</span><span class="s3">, </span><span class="s5">&quot;MachineName&quot;</span><span class="s3">, </span><span class="s5">&quot;LogName&quot;</span><span class="s3">,</span>
               <span class="s5">&quot;EventIDOccurrences&quot;</span><span class="s3">, </span><span class="s5">&quot;TotalEventsCount&quot;</span><span class="s3">, </span><span class="s5">&quot;Level&quot;</span><span class="s3">]</span>
    <span class="s1">writer</span><span class="s3">.</span><span class="s1">writerow</span><span class="s3">(</span><span class="s1">columns</span><span class="s3">)</span>

    <span class="s1">events_collection </span><span class="s3">= </span><span class="s1">events_db</span><span class="s3">[</span><span class="s5">'logs'</span><span class="s3">]</span>
    <span class="s1">events </span><span class="s3">= </span><span class="s1">events_collection</span><span class="s3">.</span><span class="s1">find</span><span class="s3">(</span><span class="s1">query</span><span class="s3">)</span>
    <span class="s2">for </span><span class="s1">event </span><span class="s2">in </span><span class="s1">events</span><span class="s3">:</span>
        <span class="s1">writer</span><span class="s3">.</span><span class="s1">writerow</span><span class="s3">([</span><span class="s1">event</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s1">column</span><span class="s3">, </span><span class="s5">&quot;&quot;</span><span class="s3">) </span><span class="s2">for </span><span class="s1">column </span><span class="s2">in </span><span class="s1">columns</span><span class="s3">])</span>

    <span class="s1">output</span><span class="s3">.</span><span class="s1">seek</span><span class="s3">(</span><span class="s4">0</span><span class="s3">)</span>

    <span class="s2">return </span><span class="s1">Response</span><span class="s3">(</span>
        <span class="s1">output</span><span class="s3">,</span>
        <span class="s1">mimetype</span><span class="s3">=</span><span class="s5">&quot;text/csv&quot;</span><span class="s3">,</span>
        <span class="s1">headers</span><span class="s3">={</span><span class="s5">&quot;Content-Disposition&quot;</span><span class="s3">: </span><span class="s5">&quot;attachment;filename=events_table.csv&quot;</span><span class="s3">}</span>
    <span class="s3">)</span>


<span class="s1">client </span><span class="s3">= </span><span class="s1">MongoClient</span><span class="s3">(</span><span class="s5">'mongodb://localhost:27017/'</span><span class="s3">)</span>
<span class="s1">cases_db </span><span class="s3">= </span><span class="s1">client</span><span class="s3">[</span><span class="s5">'Case'</span><span class="s3">]  </span><span class="s0"># Database for managing cases</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/case'</span><span class="s3">, </span><span class="s1">methods</span><span class="s3">=[</span><span class="s5">'GET'</span><span class="s3">, </span><span class="s5">'POST'</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">case</span><span class="s3">():</span>
    <span class="s1">logo_url </span><span class="s3">= </span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'static'</span><span class="s3">, </span><span class="s1">filename</span><span class="s3">=</span><span class="s5">'ScanmyLog.png'</span><span class="s3">)</span>
    <span class="s2">if </span><span class="s1">request</span><span class="s3">.</span><span class="s1">method </span><span class="s3">== </span><span class="s5">'POST'</span><span class="s3">:</span>
        <span class="s1">eventName </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">form</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'eventName'</span><span class="s3">)  </span><span class="s0"># Extract the event name from the form data</span>

        <span class="s2">if not </span><span class="s1">eventName</span><span class="s3">:</span>
            <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">({</span><span class="s5">'message'</span><span class="s3">: </span><span class="s5">'Event name is required.'</span><span class="s3">}), </span><span class="s4">400</span>

        <span class="s1">case_collection_name </span><span class="s3">= </span><span class="s1">eventName</span><span class="s3">.</span><span class="s1">replace</span><span class="s3">(</span><span class="s5">&quot; &quot;</span><span class="s3">, </span><span class="s5">&quot;_&quot;</span><span class="s3">).</span><span class="s1">lower</span><span class="s3">()</span>
        <span class="s1">case_collection </span><span class="s3">= </span><span class="s1">cases_db</span><span class="s3">[</span><span class="s1">case_collection_name</span><span class="s3">]  </span><span class="s0"># Access the specified collection</span>

        <span class="s0"># Here, you would include additional data you want to save to this collection</span>
        <span class="s1">case_data </span><span class="s3">= {</span>
            <span class="s5">&quot;eventName&quot;</span><span class="s3">: </span><span class="s1">eventName</span><span class="s3">,</span>
            <span class="s0"># Add more fields here as necessary</span>
        <span class="s3">}</span>

        <span class="s1">insert_result </span><span class="s3">= </span><span class="s1">case_collection</span><span class="s3">.</span><span class="s1">insert_one</span><span class="s3">(</span><span class="s1">case_data</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">insert_result</span><span class="s3">.</span><span class="s1">inserted_id</span><span class="s3">:</span>
            <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">({</span><span class="s5">'message'</span><span class="s3">: </span><span class="s5">'New case created successfully'</span><span class="s3">, </span><span class="s5">'id'</span><span class="s3">: </span><span class="s1">str</span><span class="s3">(</span><span class="s1">insert_result</span><span class="s3">.</span><span class="s1">inserted_id</span><span class="s3">)}), </span><span class="s4">200</span>
        <span class="s2">else</span><span class="s3">:</span>
            <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">({</span><span class="s5">'message'</span><span class="s3">: </span><span class="s5">'Failed to create new case'</span><span class="s3">}), </span><span class="s4">500</span>

    <span class="s2">else</span><span class="s3">:  </span><span class="s0"># If it's a GET request</span>
        <span class="s1">collection_names </span><span class="s3">= </span><span class="s1">cases_db</span><span class="s3">.</span><span class="s1">list_collection_names</span><span class="s3">()  </span><span class="s0"># Fetch all collection names from the 'Case' database</span>
        <span class="s0"># Render the template with collection names</span>
        <span class="s2">return </span><span class="s1">render_template</span><span class="s3">(</span><span class="s5">&quot;Case.html&quot;</span><span class="s3">, </span><span class="s1">logo_url</span><span class="s3">=</span><span class="s1">logo_url</span><span class="s3">, </span><span class="s1">collection_names</span><span class="s3">=</span><span class="s1">collection_names</span><span class="s3">)</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/view_collection'</span><span class="s3">, </span><span class="s1">methods</span><span class="s3">=[</span><span class="s5">'POST'</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">view_collection</span><span class="s3">():</span>
    <span class="s0"># [Your existing view_collection logic, but return JSON]</span>
    <span class="s1">collection_name </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">json</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'collectionName'</span><span class="s3">)</span>
    <span class="s1">collection </span><span class="s3">= </span><span class="s1">cases_db</span><span class="s3">[</span><span class="s1">collection_name</span><span class="s3">]</span>
    <span class="s1">documents </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span><span class="s1">collection</span><span class="s3">.</span><span class="s1">find</span><span class="s3">().</span><span class="s1">skip</span><span class="s3">(</span><span class="s4">1</span><span class="s3">))  </span><span class="s0"># Skip the first document</span>
    <span class="s1">headers </span><span class="s3">= [</span><span class="s1">key </span><span class="s2">for </span><span class="s1">key </span><span class="s2">in </span><span class="s1">documents</span><span class="s3">[</span><span class="s4">0</span><span class="s3">].</span><span class="s1">keys</span><span class="s3">() </span><span class="s2">if </span><span class="s1">key </span><span class="s3">!= </span><span class="s5">'_id'</span><span class="s3">] </span><span class="s2">if </span><span class="s1">documents </span><span class="s2">else </span><span class="s3">[]</span>

    <span class="s0"># Prepare data for JSON response</span>
    <span class="s1">json_data </span><span class="s3">= {</span>
        <span class="s5">'headers'</span><span class="s3">: </span><span class="s1">headers</span><span class="s3">,</span>
        <span class="s5">'documents'</span><span class="s3">: [{</span><span class="s1">header</span><span class="s3">: </span><span class="s1">doc</span><span class="s3">[</span><span class="s1">header</span><span class="s3">] </span><span class="s2">for </span><span class="s1">header </span><span class="s2">in </span><span class="s1">headers</span><span class="s3">} </span><span class="s2">for </span><span class="s1">doc </span><span class="s2">in </span><span class="s1">documents</span><span class="s3">]</span>
    <span class="s3">}</span>
    <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">(</span><span class="s1">json_data</span><span class="s3">)</span>


<span class="s2">def </span><span class="s1">create_case</span><span class="s3">():</span>
    <span class="s0"># Extract form data for the new case</span>
    <span class="s1">case_name </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">form</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'eventName'</span><span class="s3">, </span><span class="s5">''</span><span class="s3">).</span><span class="s1">strip</span><span class="s3">()</span>
    <span class="s1">machine_name </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">form</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'machineName'</span><span class="s3">, </span><span class="s5">''</span><span class="s3">).</span><span class="s1">strip</span><span class="s3">()</span>
    <span class="s1">event_id </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">form</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'eventID'</span><span class="s3">, </span><span class="s5">''</span><span class="s3">).</span><span class="s1">strip</span><span class="s3">()</span>
    <span class="s1">description </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">form</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'description'</span><span class="s3">, </span><span class="s5">''</span><span class="s3">).</span><span class="s1">strip</span><span class="s3">()</span>
    <span class="s1">tag </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">form</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'tag'</span><span class="s3">, </span><span class="s5">''</span><span class="s3">).</span><span class="s1">strip</span><span class="s3">()</span>
    <span class="s1">time_created </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">form</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'timeCreated'</span><span class="s3">, </span><span class="s5">''</span><span class="s3">).</span><span class="s1">strip</span><span class="s3">()</span>

    <span class="s0"># Convert case name into a valid collection name</span>
    <span class="s1">collection_name </span><span class="s3">= </span><span class="s5">''</span><span class="s3">.</span><span class="s1">join</span><span class="s3">(</span><span class="s1">e </span><span class="s2">for </span><span class="s1">e </span><span class="s2">in </span><span class="s1">case_name </span><span class="s2">if </span><span class="s1">e</span><span class="s3">.</span><span class="s1">isalnum</span><span class="s3">())</span>

    <span class="s0"># Create a new collection or access it if it already exists based on the case name</span>
    <span class="s1">case_collection </span><span class="s3">= </span><span class="s1">cases_db</span><span class="s3">[</span><span class="s1">collection_name</span><span class="s3">]</span>

    <span class="s0"># Document to be inserted</span>
    <span class="s1">event_data </span><span class="s3">= {</span>
        <span class="s5">'eventID'</span><span class="s3">: </span><span class="s1">event_id</span><span class="s3">,</span>
        <span class="s5">'machineName'</span><span class="s3">: </span><span class="s1">machine_name</span><span class="s3">,</span>
        <span class="s5">'timeCreated'</span><span class="s3">: </span><span class="s1">time_created</span><span class="s3">,</span>
        <span class="s5">'description'</span><span class="s3">: </span><span class="s1">description</span><span class="s3">,</span>
    <span class="s3">}</span>

    <span class="s0"># Attempt to insert the document into the collection</span>
    <span class="s2">try</span><span class="s3">:</span>
        <span class="s1">insert_result </span><span class="s3">= </span><span class="s1">case_collection</span><span class="s3">.</span><span class="s1">insert_one</span><span class="s3">(</span><span class="s1">event_data</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">insert_result</span><span class="s3">.</span><span class="s1">inserted_id</span><span class="s3">:</span>
            <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">({</span><span class="s5">'message'</span><span class="s3">: </span><span class="s5">'Event saved successfully'</span><span class="s3">, </span><span class="s5">'id'</span><span class="s3">: </span><span class="s1">str</span><span class="s3">(</span><span class="s1">insert_result</span><span class="s3">.</span><span class="s1">inserted_id</span><span class="s3">)}), </span><span class="s4">201</span>
        <span class="s2">else</span><span class="s3">:</span>
            <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">({</span><span class="s5">'message'</span><span class="s3">: </span><span class="s5">'Failed to save event'</span><span class="s3">}), </span><span class="s4">500</span>
    <span class="s2">except </span><span class="s1">Exception </span><span class="s2">as </span><span class="s1">e</span><span class="s3">:</span>
        <span class="s0"># It's a good practice to log the exception message to understand what went wrong</span>
        <span class="s1">print</span><span class="s3">(</span><span class="s5">f&quot;An error occurred: </span><span class="s2">{</span><span class="s1">e</span><span class="s2">}</span><span class="s5">&quot;</span><span class="s3">)</span>
        <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">({</span><span class="s5">'message'</span><span class="s3">: </span><span class="s5">'An error occurred while saving the event'</span><span class="s3">}), </span><span class="s4">500</span>


<span class="s1">client </span><span class="s3">= </span><span class="s1">MongoClient</span><span class="s3">(</span><span class="s5">'mongodb://localhost:27017/'</span><span class="s3">)</span>
<span class="s1">db </span><span class="s3">= </span><span class="s1">client</span><span class="s3">[</span><span class="s5">'Client'</span><span class="s3">]</span>
<span class="s1">collection </span><span class="s3">= </span><span class="s1">db</span><span class="s3">[</span><span class="s5">'logs'</span><span class="s3">]</span>


<span class="s0"># Home route to display the form</span>
<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/alert'</span><span class="s3">, </span><span class="s1">methods</span><span class="s3">=[</span><span class="s5">'GET'</span><span class="s3">, </span><span class="s5">'POST'</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">alert</span><span class="s3">():</span>
    <span class="s1">logo_url </span><span class="s3">= </span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'static'</span><span class="s3">, </span><span class="s1">filename</span><span class="s3">=</span><span class="s5">'ScanmyLog.png'</span><span class="s3">)</span>

    <span class="s2">if </span><span class="s1">request</span><span class="s3">.</span><span class="s1">method </span><span class="s3">== </span><span class="s5">'POST'</span><span class="s3">:</span>
        <span class="s1">event_id </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">form</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'event_id'</span><span class="s3">)</span>
        <span class="s1">machine_name </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">form</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'machine_name'</span><span class="s3">, </span><span class="s2">None</span><span class="s3">)</span>
        <span class="s1">severity </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">form</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'severity'</span><span class="s3">, </span><span class="s2">None</span><span class="s3">)</span>
        <span class="s1">email </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">form</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'email'</span><span class="s3">)  </span><span class="s0"># Get email address from form</span>
        <span class="s1">anomalies </span><span class="s3">= </span><span class="s1">get_anomalies</span><span class="s3">(</span><span class="s1">event_id</span><span class="s3">, </span><span class="s1">machine_name</span><span class="s3">, </span><span class="s1">severity</span><span class="s3">)</span>

        <span class="s1">save_alert</span><span class="s3">(</span><span class="s1">anomalies</span><span class="s3">)</span>

        <span class="s0"># If anomalies found and email provided, send email</span>
        <span class="s2">if </span><span class="s1">anomalies </span><span class="s2">and </span><span class="s1">email</span><span class="s3">:</span>
            <span class="s1">send_email</span><span class="s3">(</span><span class="s1">email</span><span class="s3">, </span><span class="s1">anomalies</span><span class="s3">)</span>

        <span class="s2">return </span><span class="s1">render_template</span><span class="s3">(</span><span class="s5">'alert.html'</span><span class="s3">, </span><span class="s1">anomalies</span><span class="s3">=</span><span class="s1">anomalies</span><span class="s3">, </span><span class="s1">event_id</span><span class="s3">=</span><span class="s1">event_id</span><span class="s3">, </span><span class="s1">machine_name</span><span class="s3">=</span><span class="s1">machine_name</span><span class="s3">,</span>
                               <span class="s1">severity</span><span class="s3">=</span><span class="s1">severity</span><span class="s3">)</span>
    <span class="s2">return </span><span class="s1">render_template</span><span class="s3">(</span><span class="s5">'alert.html'</span><span class="s3">, </span><span class="s1">logo_url</span><span class="s3">=</span><span class="s1">logo_url</span><span class="s3">)</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/download_csv_alert'</span><span class="s3">)</span>
<span class="s2">def </span><span class="s1">download_csv_alert</span><span class="s3">():</span>
    <span class="s1">output </span><span class="s3">= </span><span class="s1">io</span><span class="s3">.</span><span class="s1">StringIO</span><span class="s3">()</span>
    <span class="s1">writer </span><span class="s3">= </span><span class="s1">csv</span><span class="s3">.</span><span class="s1">writer</span><span class="s3">(</span><span class="s1">output</span><span class="s3">)</span>

    <span class="s1">query </span><span class="s3">= {}</span>
    <span class="s2">for </span><span class="s1">key </span><span class="s2">in </span><span class="s1">request</span><span class="s3">.</span><span class="s1">args</span><span class="s3">:</span>
        <span class="s1">value </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">args</span><span class="s3">[</span><span class="s1">key</span><span class="s3">]</span>
        <span class="s2">if </span><span class="s1">value</span><span class="s3">:</span>
            <span class="s2">if </span><span class="s1">key </span><span class="s2">in </span><span class="s3">[</span><span class="s5">&quot;EventIDOccurrences&quot;</span><span class="s3">, </span><span class="s5">&quot;TotalEventsCount&quot;</span><span class="s3">]:</span>
                <span class="s2">try</span><span class="s3">:</span>
                    <span class="s1">query</span><span class="s3">[</span><span class="s1">key</span><span class="s3">] = </span><span class="s1">int</span><span class="s3">(</span><span class="s1">value</span><span class="s3">)</span>
                <span class="s2">except </span><span class="s1">ValueError</span><span class="s3">:</span>
                    <span class="s2">continue</span>
            <span class="s2">else</span><span class="s3">:</span>
                <span class="s1">query</span><span class="s3">[</span><span class="s1">key</span><span class="s3">] = {</span><span class="s5">'$regex'</span><span class="s3">: </span><span class="s1">value</span><span class="s3">, </span><span class="s5">'$options'</span><span class="s3">: </span><span class="s5">'i'</span><span class="s3">}</span>

    <span class="s0"># Define your columns</span>
    <span class="s1">columns </span><span class="s3">= [</span><span class="s5">&quot;EventID&quot;</span><span class="s3">, </span><span class="s5">&quot;TimeCreated&quot;</span><span class="s3">, </span><span class="s5">&quot;Severity&quot;</span><span class="s3">, </span><span class="s5">&quot;Message&quot;</span><span class="s3">, </span><span class="s5">&quot;IPAddress&quot;</span><span class="s3">, </span><span class="s5">&quot;MachineName&quot;</span><span class="s3">, </span><span class="s5">&quot;LogName&quot;</span><span class="s3">,</span>
               <span class="s5">&quot;EventIDOccurrences&quot;</span><span class="s3">, </span><span class="s5">&quot;TotalEventsCount&quot;</span><span class="s3">, </span><span class="s5">&quot;Level&quot;</span><span class="s3">]</span>
    <span class="s1">writer</span><span class="s3">.</span><span class="s1">writerow</span><span class="s3">(</span><span class="s1">columns</span><span class="s3">)</span>

    <span class="s1">events_collection </span><span class="s3">= </span><span class="s1">events_db</span><span class="s3">[</span><span class="s5">'logs'</span><span class="s3">]</span>
    <span class="s1">events </span><span class="s3">= </span><span class="s1">events_collection</span><span class="s3">.</span><span class="s1">find</span><span class="s3">(</span><span class="s1">query</span><span class="s3">)</span>
    <span class="s2">for </span><span class="s1">event </span><span class="s2">in </span><span class="s1">events</span><span class="s3">:</span>
        <span class="s1">writer</span><span class="s3">.</span><span class="s1">writerow</span><span class="s3">([</span><span class="s1">event</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s1">column</span><span class="s3">, </span><span class="s5">&quot;&quot;</span><span class="s3">) </span><span class="s2">for </span><span class="s1">column </span><span class="s2">in </span><span class="s1">columns</span><span class="s3">])</span>

    <span class="s1">output</span><span class="s3">.</span><span class="s1">seek</span><span class="s3">(</span><span class="s4">0</span><span class="s3">)</span>

    <span class="s2">return </span><span class="s1">Response</span><span class="s3">(</span>
        <span class="s1">output</span><span class="s3">,</span>
        <span class="s1">mimetype</span><span class="s3">=</span><span class="s5">&quot;text/csv&quot;</span><span class="s3">,</span>
        <span class="s1">headers</span><span class="s3">={</span><span class="s5">&quot;Content-Disposition&quot;</span><span class="s3">: </span><span class="s5">&quot;attachment;filename=events_table.csv&quot;</span><span class="s3">}</span>
    <span class="s3">)</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/alert_case'</span><span class="s3">, </span><span class="s1">methods</span><span class="s3">=[</span><span class="s5">'POST'</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">alert_case</span><span class="s3">():</span>
    <span class="s2">if not </span><span class="s1">request</span><span class="s3">.</span><span class="s1">json</span><span class="s3">:</span>
        <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">({</span><span class="s5">&quot;error&quot;</span><span class="s3">: </span><span class="s5">&quot;Request must be JSON&quot;</span><span class="s3">}), </span><span class="s4">400</span>

    <span class="s0"># Extract data from the JSON request</span>
    <span class="s1">data </span><span class="s3">= </span><span class="s1">request</span><span class="s3">.</span><span class="s1">json</span>
    <span class="s1">print</span><span class="s3">(</span><span class="s5">&quot;Received data:&quot;</span><span class="s3">, </span><span class="s1">data</span><span class="s3">)  </span><span class="s0"># Debugging line</span>

    <span class="s1">event_name </span><span class="s3">= </span><span class="s1">data</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'eventName'</span><span class="s3">)  </span><span class="s0"># Use 'eventName' to determine the collection name</span>
    <span class="s1">print</span><span class="s3">(</span><span class="s5">&quot;Event Name (Collection Name):&quot;</span><span class="s3">, </span><span class="s1">event_name</span><span class="s3">)  </span><span class="s0"># Debugging line</span>

    <span class="s2">if not </span><span class="s1">event_name</span><span class="s3">:</span>
        <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">({</span><span class="s5">&quot;error&quot;</span><span class="s3">: </span><span class="s5">&quot;Event name is missing&quot;</span><span class="s3">}), </span><span class="s4">400</span>

    <span class="s0"># Convert event name to a valid MongoDB collection name, if necessary</span>
    <span class="s1">collection_name </span><span class="s3">= </span><span class="s5">''</span><span class="s3">.</span><span class="s1">join</span><span class="s3">(</span><span class="s1">e </span><span class="s2">for </span><span class="s1">e </span><span class="s2">in </span><span class="s1">event_name </span><span class="s2">if </span><span class="s1">e</span><span class="s3">.</span><span class="s1">isalnum</span><span class="s3">()).</span><span class="s1">lower</span><span class="s3">()</span>
    <span class="s1">print</span><span class="s3">(</span><span class="s5">&quot;Formatted Collection Name:&quot;</span><span class="s3">, </span><span class="s1">collection_name</span><span class="s3">)  </span><span class="s0"># Debugging line</span>

    <span class="s1">event_data </span><span class="s3">= {</span>
        <span class="s5">&quot;eventID&quot;</span><span class="s3">: </span><span class="s1">data</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'eventID'</span><span class="s3">),</span>
        <span class="s5">&quot;machineName&quot;</span><span class="s3">: </span><span class="s1">data</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'machineName'</span><span class="s3">),</span>
        <span class="s5">&quot;timeCreated&quot;</span><span class="s3">: </span><span class="s1">datetime</span><span class="s3">.</span><span class="s1">strptime</span><span class="s3">(</span><span class="s1">data</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'timeCreated'</span><span class="s3">), </span><span class="s5">&quot;%Y-%m-%d %H:%M:%S&quot;</span><span class="s3">),</span>
        <span class="s5">&quot;eventName&quot;</span><span class="s3">: </span><span class="s1">event_name</span><span class="s3">,</span>
        <span class="s5">&quot;description&quot;</span><span class="s3">: </span><span class="s1">data</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'description'</span><span class="s3">)</span>
    <span class="s3">}</span>

    <span class="s0"># Access the specified collection in the 'cases_db' database</span>
    <span class="s1">collection </span><span class="s3">= </span><span class="s1">cases_db</span><span class="s3">[</span><span class="s1">collection_name</span><span class="s3">]</span>
    <span class="s1">print</span><span class="s3">(</span><span class="s5">&quot;Using Collection:&quot;</span><span class="s3">, </span><span class="s1">collection</span><span class="s3">)  </span><span class="s0"># Debugging line</span>

    <span class="s0"># Insert the event data into the collection</span>
    <span class="s1">insert_result </span><span class="s3">= </span><span class="s1">collection</span><span class="s3">.</span><span class="s1">insert_one</span><span class="s3">(</span><span class="s1">event_data</span><span class="s3">)</span>
    <span class="s2">if </span><span class="s1">insert_result</span><span class="s3">.</span><span class="s1">inserted_id</span><span class="s3">:</span>
        <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">({</span><span class="s5">&quot;success&quot;</span><span class="s3">: </span><span class="s2">True</span><span class="s3">, </span><span class="s5">&quot;message&quot;</span><span class="s3">: </span><span class="s5">&quot;Event saved successfully&quot;</span><span class="s3">}), </span><span class="s4">200</span>
    <span class="s2">else</span><span class="s3">:</span>
        <span class="s2">return </span><span class="s1">jsonify</span><span class="s3">({</span><span class="s5">&quot;error&quot;</span><span class="s3">: </span><span class="s5">&quot;Failed to save event&quot;</span><span class="s3">}), </span><span class="s4">500</span>


<span class="s2">def </span><span class="s1">save_alert</span><span class="s3">(</span><span class="s1">anomalies</span><span class="s3">):</span>
    <span class="s2">if </span><span class="s1">anomalies</span><span class="s3">:</span>
        <span class="s0"># Assume you have a collection named 'anomalies' for storing the detected anomalies</span>
        <span class="s1">anomalies_collection </span><span class="s3">= </span><span class="s1">db</span><span class="s3">[</span><span class="s5">'anomalies'</span><span class="s3">]</span>
        <span class="s2">for </span><span class="s1">anomaly </span><span class="s2">in </span><span class="s1">anomalies</span><span class="s3">:</span>
            <span class="s0"># Add a check or modify as needed to prevent duplicate entries if necessary</span>
            <span class="s1">anomalies_collection</span><span class="s3">.</span><span class="s1">insert_one</span><span class="s3">(</span><span class="s1">anomaly</span><span class="s3">)</span>


<span class="s2">def </span><span class="s1">send_email</span><span class="s3">(</span><span class="s1">recipient_email</span><span class="s3">, </span><span class="s1">anomalies</span><span class="s3">):</span>
    <span class="s1">sender_email </span><span class="s3">= </span><span class="s5">&quot;norepleyscannerly@gmail.com&quot;</span>
    <span class="s1">sender_password </span><span class="s3">= </span><span class="s5">&quot;jtsi oyvo uapb huyu&quot;</span>

    <span class="s0"># Construct email content</span>
    <span class="s1">subject </span><span class="s3">= </span><span class="s5">&quot;Anomaly Detection Report&quot;</span>
    <span class="s1">body </span><span class="s3">= </span><span class="s5">f&quot;Anomalies detected: </span><span class="s2">{</span><span class="s1">len</span><span class="s3">(</span><span class="s1">anomalies</span><span class="s3">)</span><span class="s2">}\n\n</span><span class="s5">Details:</span><span class="s2">\n</span><span class="s5">&quot;</span>
    <span class="s2">for </span><span class="s1">anomaly </span><span class="s2">in </span><span class="s1">anomalies</span><span class="s3">:</span>
        <span class="s1">body </span><span class="s3">+= </span><span class="s5">f&quot;Event ID: </span><span class="s2">{</span><span class="s1">anomaly</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'EventID'</span><span class="s3">)</span><span class="s2">}</span><span class="s5">, Time Created: </span><span class="s2">{</span><span class="s1">anomaly</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">'TimeCreated'</span><span class="s3">)</span><span class="s2">}\n</span><span class="s5">&quot;</span>

    <span class="s0"># Setup the email server (Gmail example)</span>
    <span class="s1">server </span><span class="s3">= </span><span class="s1">smtplib</span><span class="s3">.</span><span class="s1">SMTP</span><span class="s3">(</span><span class="s5">'smtp.gmail.com'</span><span class="s3">, </span><span class="s4">587</span><span class="s3">)</span>
    <span class="s1">server</span><span class="s3">.</span><span class="s1">starttls</span><span class="s3">()</span>
    <span class="s1">server</span><span class="s3">.</span><span class="s1">login</span><span class="s3">(</span><span class="s1">sender_email</span><span class="s3">, </span><span class="s1">sender_password</span><span class="s3">)</span>

    <span class="s0"># Create and send email</span>
    <span class="s1">msg </span><span class="s3">= </span><span class="s1">MIMEText</span><span class="s3">(</span><span class="s1">body</span><span class="s3">)</span>
    <span class="s1">msg</span><span class="s3">[</span><span class="s5">'Subject'</span><span class="s3">] = </span><span class="s1">subject</span>
    <span class="s1">msg</span><span class="s3">[</span><span class="s5">'From'</span><span class="s3">] = </span><span class="s1">sender_email</span>
    <span class="s1">msg</span><span class="s3">[</span><span class="s5">'To'</span><span class="s3">] = </span><span class="s1">recipient_email</span>
    <span class="s1">server</span><span class="s3">.</span><span class="s1">send_message</span><span class="s3">(</span><span class="s1">msg</span><span class="s3">)</span>
    <span class="s1">server</span><span class="s3">.</span><span class="s1">quit</span><span class="s3">()</span>


<span class="s2">def </span><span class="s1">get_anomalies</span><span class="s3">(</span><span class="s1">event_id</span><span class="s3">, </span><span class="s1">machine_name</span><span class="s3">, </span><span class="s1">severity</span><span class="s3">):</span>
    <span class="s0"># Ensure all_logs are fetched here to avoid scope issues</span>
    <span class="s1">all_logs </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span><span class="s1">collection</span><span class="s3">.</span><span class="s1">find</span><span class="s3">({}))</span>
    <span class="s1">print</span><span class="s3">(</span><span class="s5">&quot;All logs count:&quot;</span><span class="s3">, </span><span class="s1">len</span><span class="s3">(</span><span class="s1">all_logs</span><span class="s3">))  </span><span class="s0"># Debugging</span>
    <span class="s1">ai_model </span><span class="s3">= </span><span class="s1">train_ai_model</span><span class="s3">(</span><span class="s1">all_logs</span><span class="s3">)</span>
    <span class="s1">related_logs </span><span class="s3">= </span><span class="s1">read_logs_by_filters</span><span class="s3">(</span><span class="s1">event_id</span><span class="s3">, </span><span class="s1">machine_name</span><span class="s3">, </span><span class="s1">severity</span><span class="s3">)</span>
    <span class="s1">print</span><span class="s3">(</span><span class="s5">&quot;Related logs count:&quot;</span><span class="s3">, </span><span class="s1">len</span><span class="s3">(</span><span class="s1">related_logs</span><span class="s3">))  </span><span class="s0"># Debugging</span>
    <span class="s1">anomalies </span><span class="s3">= [</span><span class="s1">log </span><span class="s2">for </span><span class="s1">log </span><span class="s2">in </span><span class="s1">related_logs </span><span class="s2">if </span><span class="s1">evaluate_event</span><span class="s3">(</span><span class="s1">log</span><span class="s3">, </span><span class="s1">ai_model</span><span class="s3">) == -</span><span class="s4">1</span><span class="s3">]</span>
    <span class="s1">print</span><span class="s3">(</span><span class="s5">&quot;Anomalies count:&quot;</span><span class="s3">, </span><span class="s1">len</span><span class="s3">(</span><span class="s1">anomalies</span><span class="s3">))  </span><span class="s0"># Debugging</span>
    <span class="s2">return </span><span class="s1">anomalies</span>


<span class="s0"># Function to read logs by filters</span>
<span class="s2">def </span><span class="s1">read_logs_by_filters</span><span class="s3">(</span><span class="s1">event_id</span><span class="s3">, </span><span class="s1">machine_name</span><span class="s3">, </span><span class="s1">severity</span><span class="s3">):</span>
    <span class="s2">try</span><span class="s3">:</span>
        <span class="s0"># Attempt to convert event_id to an integer if it's stored as such in MongoDB</span>
        <span class="s1">event_id_int </span><span class="s3">= </span><span class="s1">int</span><span class="s3">(</span><span class="s1">event_id</span><span class="s3">)</span>
    <span class="s2">except </span><span class="s1">ValueError</span><span class="s3">:</span>
        <span class="s0"># If conversion fails, keep it as string</span>
        <span class="s1">event_id_int </span><span class="s3">= </span><span class="s1">event_id</span>

    <span class="s0"># Build the query dynamically based on inputs</span>
    <span class="s1">query </span><span class="s3">= {</span><span class="s5">'EventID'</span><span class="s3">: {</span><span class="s5">'$in'</span><span class="s3">: [</span><span class="s1">event_id</span><span class="s3">, </span><span class="s1">event_id_int</span><span class="s3">]}}  </span><span class="s0"># This handles both string and integer types</span>
    <span class="s2">if </span><span class="s1">machine_name</span><span class="s3">:</span>
        <span class="s1">query</span><span class="s3">[</span><span class="s5">'MachineName'</span><span class="s3">] = </span><span class="s1">machine_name</span>
    <span class="s2">if </span><span class="s1">severity</span><span class="s3">:</span>
        <span class="s1">query</span><span class="s3">[</span><span class="s5">'Severity'</span><span class="s3">] = </span><span class="s1">severity</span>

    <span class="s1">logs </span><span class="s3">= </span><span class="s1">collection</span><span class="s3">.</span><span class="s1">find</span><span class="s3">(</span><span class="s1">query</span><span class="s3">)</span>
    <span class="s2">return </span><span class="s1">list</span><span class="s3">(</span><span class="s1">logs</span><span class="s3">)</span>


<span class="s0"># Function to train the AI model</span>
<span class="s2">def </span><span class="s1">train_ai_model</span><span class="s3">(</span><span class="s1">data</span><span class="s3">):</span>
    <span class="s1">features </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([[</span><span class="s1">log</span><span class="s3">[</span><span class="s5">'Score'</span><span class="s3">], </span><span class="s1">log</span><span class="s3">[</span><span class="s5">'EventIDOccurrences'</span><span class="s3">], </span><span class="s1">log</span><span class="s3">[</span><span class="s5">'TotalEventsCount'</span><span class="s3">]] </span><span class="s2">for </span><span class="s1">log </span><span class="s2">in </span><span class="s1">data </span><span class="s2">if </span><span class="s5">'Score'</span>
                         <span class="s2">in </span><span class="s1">log</span><span class="s3">])</span>
    <span class="s1">model </span><span class="s3">= </span><span class="s1">IsolationForest</span><span class="s3">(</span><span class="s1">n_estimators</span><span class="s3">=</span><span class="s4">100</span><span class="s3">, </span><span class="s1">contamination</span><span class="s3">=</span><span class="s5">'auto'</span><span class="s3">)</span>
    <span class="s1">model</span><span class="s3">.</span><span class="s1">fit</span><span class="s3">(</span><span class="s1">features</span><span class="s3">)</span>
    <span class="s2">return </span><span class="s1">model</span>


<span class="s0"># Function to evaluate the event for anomalies</span>
<span class="s2">def </span><span class="s1">evaluate_event</span><span class="s3">(</span><span class="s1">event</span><span class="s3">, </span><span class="s1">model</span><span class="s3">):</span>
    <span class="s1">feature </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([[</span><span class="s1">event</span><span class="s3">[</span><span class="s5">'Score'</span><span class="s3">], </span><span class="s1">event</span><span class="s3">[</span><span class="s5">'EventIDOccurrences'</span><span class="s3">], </span><span class="s1">event</span><span class="s3">[</span><span class="s5">'TotalEventsCount'</span><span class="s3">]]])</span>
    <span class="s1">prediction </span><span class="s3">= </span><span class="s1">model</span><span class="s3">.</span><span class="s1">predict</span><span class="s3">(</span><span class="s1">feature</span><span class="s3">)</span>
    <span class="s2">return </span><span class="s1">prediction</span>


<span class="s0"># MongoDB setup (Ensure this matches your actual MongoDB setup)</span>
<span class="s1">client </span><span class="s3">= </span><span class="s1">MongoClient</span><span class="s3">(</span><span class="s5">'mongodb://localhost:27017/'</span><span class="s3">)</span>
<span class="s1">db </span><span class="s3">= </span><span class="s1">client</span><span class="s3">[</span><span class="s5">'user_credentials'</span><span class="s3">]</span>
<span class="s1">users_collection </span><span class="s3">= </span><span class="s1">db</span><span class="s3">[</span><span class="s5">'users'</span><span class="s3">]</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/settings'</span><span class="s3">, </span><span class="s1">methods</span><span class="s3">=[</span><span class="s5">'GET'</span><span class="s3">, </span><span class="s5">'POST'</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">settings</span><span class="s3">():</span>
    <span class="s1">logo_url </span><span class="s3">= </span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'static'</span><span class="s3">, </span><span class="s1">filename</span><span class="s3">=</span><span class="s5">'ScanmyLog.png'</span><span class="s3">)</span>
    <span class="s2">if </span><span class="s5">'user_id' </span><span class="s2">not in </span><span class="s1">session</span><span class="s3">:</span>
        <span class="s2">return </span><span class="s1">redirect</span><span class="s3">(</span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'login'</span><span class="s3">))</span>

    <span class="s1">user_id </span><span class="s3">= </span><span class="s1">session</span><span class="s3">[</span><span class="s5">'user_id'</span><span class="s3">]</span>
    <span class="s1">user </span><span class="s3">= </span><span class="s1">users_collection</span><span class="s3">.</span><span class="s1">find_one</span><span class="s3">({</span><span class="s5">'_id'</span><span class="s3">: </span><span class="s1">ObjectId</span><span class="s3">(</span><span class="s1">user_id</span><span class="s3">)})</span>

    <span class="s2">if </span><span class="s1">request</span><span class="s3">.</span><span class="s1">method </span><span class="s3">== </span><span class="s5">'POST'</span><span class="s3">:</span>
        <span class="s1">users_collection</span><span class="s3">.</span><span class="s1">update_one</span><span class="s3">({</span><span class="s5">'_id'</span><span class="s3">: </span><span class="s1">ObjectId</span><span class="s3">(</span><span class="s1">user_id</span><span class="s3">)}, {</span><span class="s5">&quot;$set&quot;</span><span class="s3">: </span><span class="s1">request</span><span class="s3">.</span><span class="s1">form</span><span class="s3">.</span><span class="s1">to_dict</span><span class="s3">()})</span>
        <span class="s1">flash</span><span class="s3">(</span><span class="s5">'Data updated successfully'</span><span class="s3">, </span><span class="s5">'success'</span><span class="s3">)</span>

    <span class="s2">return </span><span class="s1">render_template</span><span class="s3">(</span><span class="s5">'Settings.html'</span><span class="s3">, </span><span class="s1">logo_url</span><span class="s3">=</span><span class="s1">logo_url</span><span class="s3">, </span><span class="s1">username</span><span class="s3">=</span><span class="s1">user</span><span class="s3">[</span><span class="s5">'username'</span><span class="s3">])</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/update_settings'</span><span class="s3">, </span><span class="s1">methods</span><span class="s3">=[</span><span class="s5">'GET'</span><span class="s3">, </span><span class="s5">'POST'</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">update_settings</span><span class="s3">():</span>
    <span class="s2">if </span><span class="s5">'user_id' </span><span class="s2">not in </span><span class="s1">session</span><span class="s3">:</span>
        <span class="s2">return </span><span class="s1">redirect</span><span class="s3">(</span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'login'</span><span class="s3">))</span>

    <span class="s2">if </span><span class="s1">request</span><span class="s3">.</span><span class="s1">method </span><span class="s3">== </span><span class="s5">'POST'</span><span class="s3">:</span>
        <span class="s1">user_id </span><span class="s3">= </span><span class="s1">session</span><span class="s3">[</span><span class="s5">'user_id'</span><span class="s3">]</span>
        <span class="s1">update_data </span><span class="s3">= {</span><span class="s1">key</span><span class="s3">: </span><span class="s1">request</span><span class="s3">.</span><span class="s1">form</span><span class="s3">[</span><span class="s1">key</span><span class="s3">] </span><span class="s2">for </span><span class="s1">key </span><span class="s2">in </span><span class="s1">request</span><span class="s3">.</span><span class="s1">form</span><span class="s3">.</span><span class="s1">keys</span><span class="s3">()}</span>

        <span class="s0"># Check if a password is part of the update, hash it if present</span>
        <span class="s2">if </span><span class="s5">'password' </span><span class="s2">in </span><span class="s1">update_data</span><span class="s3">:</span>
            <span class="s1">hashed_password </span><span class="s3">= </span><span class="s1">generate_password_hash</span><span class="s3">(</span><span class="s1">update_data</span><span class="s3">[</span><span class="s5">'password'</span><span class="s3">], </span><span class="s1">method</span><span class="s3">=</span><span class="s5">'pbkdf2:sha256'</span><span class="s3">)</span>
            <span class="s1">update_data</span><span class="s3">[</span><span class="s5">'password'</span><span class="s3">] = </span><span class="s1">hashed_password</span>

        <span class="s1">users_collection</span><span class="s3">.</span><span class="s1">update_one</span><span class="s3">({</span><span class="s5">'_id'</span><span class="s3">: </span><span class="s1">ObjectId</span><span class="s3">(</span><span class="s1">user_id</span><span class="s3">)}, {</span><span class="s5">&quot;$set&quot;</span><span class="s3">: </span><span class="s1">update_data</span><span class="s3">})</span>
        <span class="s1">flash</span><span class="s3">(</span><span class="s5">'Settings updated successfully.'</span><span class="s3">, </span><span class="s5">'success'</span><span class="s3">)</span>
        <span class="s2">return </span><span class="s1">redirect</span><span class="s3">(</span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'settings'</span><span class="s3">))</span>

    <span class="s2">return </span><span class="s1">redirect</span><span class="s3">(</span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'settings'</span><span class="s3">))</span>


<span class="s3">@</span><span class="s1">app</span><span class="s3">.</span><span class="s1">route</span><span class="s3">(</span><span class="s5">'/logout'</span><span class="s3">, </span><span class="s1">methods</span><span class="s3">=[</span><span class="s5">'POST'</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">logout</span><span class="s3">():</span>
    <span class="s0"># Clear the user's session</span>
    <span class="s1">session</span><span class="s3">.</span><span class="s1">pop</span><span class="s3">(</span><span class="s5">'username'</span><span class="s3">, </span><span class="s2">None</span><span class="s3">)</span>
    <span class="s1">session</span><span class="s3">.</span><span class="s1">pop</span><span class="s3">(</span><span class="s5">'user_id'</span><span class="s3">, </span><span class="s2">None</span><span class="s3">)</span>
    <span class="s1">flash</span><span class="s3">(</span><span class="s5">'You have been successfully logged out.'</span><span class="s3">, </span><span class="s5">'info'</span><span class="s3">)</span>
    <span class="s2">return </span><span class="s1">redirect</span><span class="s3">(</span><span class="s1">url_for</span><span class="s3">(</span><span class="s5">'login'</span><span class="s3">))</span>


<span class="s2">if </span><span class="s1">__name__ </span><span class="s3">== </span><span class="s5">'__main__'</span><span class="s3">:</span>
    <span class="s1">app</span><span class="s3">.</span><span class="s1">run</span><span class="s3">(</span><span class="s1">debug</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">host</span><span class="s3">=</span><span class="s5">'0.0.0.0'</span><span class="s3">)</span>
</pre>
</body>
</html>